dojo._hasResource["dijit._editor.selection"]||(dojo._hasResource["dijit._editor.selection"]=!0,dojo.provide("dijit._editor.selection"),dojo.mixin(dijit._editor.selection,{getType:function(){if(dojo.doc.selection)return dojo.doc.selection.type.toLowerCase();var e,t="text";try{e=dojo.global.getSelection()}catch(o){}if(e&&1==e.rangeCount){var n=e.getRangeAt(0);n.startContainer==n.endContainer&&n.endOffset-n.startOffset==1&&3!=n.startContainer.nodeType&&(t="control")}return t},getSelectedText:function(){if(dojo.doc.selection)return"control"==dijit._editor.selection.getType()?null:dojo.doc.selection.createRange().text;var e=dojo.global.getSelection();return e?e.toString():void 0},getSelectedHtml:function(){if(dojo.doc.selection)return"control"==dijit._editor.selection.getType()?null:dojo.doc.selection.createRange().htmlText;var e=dojo.global.getSelection();if(e&&e.rangeCount){var t=e.getRangeAt(0).cloneContents(),o=document.createElement("div");return o.appendChild(t),o.innerHTML}return null},getSelectedElement:function(){if("control"==this.getType()){if(!dojo.doc.selection){var e=dojo.global.getSelection();return e.anchorNode.childNodes[e.anchorOffset]}var t=dojo.doc.selection.createRange();if(t&&t.item)return dojo.doc.selection.createRange().item(0)}},getParentElement:function(){if("control"==this.getType()){var e=this.getSelectedElement();if(e)return e.parentNode}else{if(dojo.doc.selection)return dojo.doc.selection.createRange().parentElement();var t=dojo.global.getSelection();if(t){for(var o=t.anchorNode;o&&1!=o.nodeType;)o=o.parentNode;return o}}},hasAncestorElement:function(){return null!=this.getAncestorElement.apply(this,arguments)},getAncestorElement:function(){var e=this.getSelectedElement()||this.getParentElement();return this.getParentOfType(e,arguments)},isTag:function(e,t){if(e&&e.tagName)for(var o=e.tagName.toLowerCase(),n=0;n<t.length;n++){var r=String(t[n]).toLowerCase();if(o==r)return r}return""},getParentOfType:function(e,t){for(;e;){if(this.isTag(e,t).length)return e;e=e.parentNode}return null},remove:function(){var e=dojo.doc.selection;return e?("none"!=e.type.toLowerCase()&&e.clear(),e):(e=dojo.global.getSelection(),e.deleteFromDocument(),e)},selectElementChildren:function(e,t){var o=dojo.global,n=dojo.doc;if(e=dojo.byId(e),n.selection&&dojo.body().createTextRange){var r=e.ownerDocument.body.createTextRange();r.moveToElementText(e),t||r.select()}else if(o.getSelection){var l=o.getSelection();l.setBaseAndExtent?l.setBaseAndExtent(e,0,e,e.innerText.length-1):l.selectAllChildren&&l.selectAllChildren(e)}},selectElement:function(e,t){var o=dojo.doc;if(e=dojo.byId(e),o.selection&&dojo.body().createTextRange)try{var n=dojo.body().createControlRange();n.addElement(e),t||n.select()}catch(r){this.selectElementChildren(e,t)}else if(dojo.global.getSelection){var l=dojo.global.getSelection();if(l.removeAllRanges){var n=o.createRange();n.selectNode(e),l.removeAllRanges(),l.addRange(n)}}}}));