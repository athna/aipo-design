dojo._hasResource["dijit.form.ComboBox"]||(dojo._hasResource["dijit.form.ComboBox"]=!0,dojo.provide("dijit.form.ComboBox"),dojo.require("dojo.data.ItemFileReadStore"),dojo.require("dijit.form.ValidationTextBox"),dojo.requireLocalization("dijit.form","ComboBox",null,"ROOT,cs,de,es,fr,hu,it,ja,ko,pl,pt,ru,zh,zh-tw"),dojo.declare("dijit.form.ComboBoxMixin",null,{item:null,pageSize:1/0,store:null,query:{},autoComplete:!0,searchDelay:100,searchAttr:"name",ignoreCase:!0,hasDownArrow:!0,_hasFocus:!1,templateString:'<table class="dijit dijitReset dijitInlineTable dijitLeft" cellspacing="0" cellpadding="0"\r\n	id="widget_${id}" name="${name}" dojoAttachEvent="onmouseenter:_onMouse,onmouseleave:_onMouse" waiRole="presentation"\r\n	><tr class="dijitReset"\r\n		><td class=\'dijitReset dijitStretch dijitInputField\' width="100%"\r\n			><input type="text" autocomplete="off" name="${name}"\r\n			dojoAttachEvent="onkeypress, onkeyup, onfocus, compositionend"\r\n			dojoAttachPoint="textbox,focusNode" waiRole="combobox"\r\n		/></td\r\n		><td class="dijitReset dijitValidationIconField" width="0%"\r\n			><div dojoAttachPoint=\'iconNode\' class=\'dijitValidationIcon\'></div\r\n			><div class=\'dijitValidationIconText\'>&Chi;</div\r\n		></td\r\n		><td class=\'dijitReset dijitRight dijitButtonNode dijitDownArrowButton\' width="0%"\r\n			dojoAttachPoint="downArrowNode"\r\n			dojoAttachEvent="onmousedown:_onArrowMouseDown,onmouseup:_onMouse,onmouseenter:_onMouse,onmouseleave:_onMouse"\r\n			><div class="dijitDownArrowButtonInner" waiRole="presentation"\r\n				><div class="dijitDownArrowButtonChar">&#9660;</div\r\n			></div\r\n		></td	\r\n	></tr\r\n></table>\r\n',baseClass:"dijitComboBox",_lastDisplayedValue:"",getValue:function(){return dijit.form.TextBox.superclass.getValue.apply(this,arguments)},setDisplayedValue:function(t){this._lastDisplayedValue=t,this.setValue(t,!0)},_getCaretPos:function(t){if("number"==typeof t.selectionStart)return t.selectionStart;if(dojo.isIE){var e=document.selection.createRange().duplicate(),i=t.createTextRange();e.move("character",0),i.move("character",0);try{return i.setEndPoint("EndToEnd",e),String(i.text).replace(/\r/g,"").length}catch(o){return 0}}},_setCaretPos:function(t,e){e=parseInt(e),this._setSelectedRange(t,e,e)},_setSelectedRange:function(element,start,end){if(end||(end=element.value.length),element.setSelectionRange)dijit.focus(element),element.setSelectionRange(start,end);else if(element.createTextRange){var range=element.createTextRange();with(range)collapse(!0),moveEnd("character",end),moveStart("character",start),select()}else{element.value=element.value,element.blur(),dijit.focus(element);for(var dist=parseInt(element.value.length)-end,tchar=String.fromCharCode(37),tcc=tchar.charCodeAt(0),x=0;dist>x;x++){var te=document.createEvent("KeyEvents");te.initKeyEvent("keypress",!0,!0,null,!1,!1,!1,!1,tcc,tcc),element.dispatchEvent(te)}}},onkeypress:function(t){if(!(t.altKey||t.ctrlKey&&118!=t.charCode)){var e=!1;switch(this.item=null,this._isShowingNow&&this._popupWidget.handleKey(t),t.keyCode){case dojo.keys.PAGE_DOWN:case dojo.keys.DOWN_ARROW:!this._isShowingNow||this._prev_key_esc?(this._arrowPressed(),e=!0):this._announceOption(this._popupWidget.getHighlightedOption()),dojo.stopEvent(t),this._prev_key_backspace=!1,this._prev_key_esc=!1;break;case dojo.keys.PAGE_UP:case dojo.keys.UP_ARROW:this._isShowingNow&&this._announceOption(this._popupWidget.getHighlightedOption()),dojo.stopEvent(t),this._prev_key_backspace=!1,this._prev_key_esc=!1;break;case dojo.keys.ENTER:var i;if(this._isShowingNow&&(i=this._popupWidget.getHighlightedOption())){if(i==this._popupWidget.nextButton){this._nextSearch(1),dojo.stopEvent(t);break}if(i==this._popupWidget.previousButton){this._nextSearch(-1),dojo.stopEvent(t);break}}else this.setDisplayedValue(this.getDisplayedValue());t.preventDefault();case dojo.keys.TAB:var o=this.getDisplayedValue();if(this._popupWidget&&(o==this._popupWidget._messages.previousMessage||o==this._popupWidget._messages.nextMessage))break;this._isShowingNow&&(this._prev_key_backspace=!1,this._prev_key_esc=!1,this._popupWidget.getHighlightedOption()&&this._popupWidget.setValue({target:this._popupWidget.getHighlightedOption()},!0),this._hideResultList());break;case dojo.keys.SPACE:this._prev_key_backspace=!1,this._prev_key_esc=!1,this._isShowingNow&&this._popupWidget.getHighlightedOption()?(dojo.stopEvent(t),this._selectOption(),this._hideResultList()):e=!0;break;case dojo.keys.ESCAPE:this._prev_key_backspace=!1,this._prev_key_esc=!0,this._hideResultList(),this._lastDisplayedValue!=this.getDisplayedValue()?(this.setDisplayedValue(this._lastDisplayedValue),dojo.stopEvent(t)):this.setValue(this.getValue(),!1);break;case dojo.keys.DELETE:case dojo.keys.BACKSPACE:this._prev_key_esc=!1,this._prev_key_backspace=!0,e=!0;break;case dojo.keys.RIGHT_ARROW:case dojo.keys.LEFT_ARROW:this._prev_key_backspace=!1,this._prev_key_esc=!1;break;default:this._prev_key_backspace=!1,this._prev_key_esc=!1,(dojo.isIE||0!=t.charCode)&&(e=!0)}this.searchTimer&&clearTimeout(this.searchTimer),e&&(this.searchTimer=setTimeout(dojo.hitch(this,this._startSearchFromInput),this.searchDelay))}},_autoCompleteText:function(t){if(this._setSelectedRange(this.focusNode,this.focusNode.value.length,this.focusNode.value.length),new RegExp("^"+escape(this.focusNode.value),this.ignoreCase?"i":"").test(escape(t))){var e=this._getCaretPos(this.focusNode);e+1>this.focusNode.value.length&&(this.focusNode.value=t,this._setSelectedRange(this.focusNode,e,this.focusNode.value.length),dijit.setWaiState(this.focusNode,"valuenow",t))}else this.focusNode.value=t,this._setSelectedRange(this.focusNode,0,this.focusNode.value.length),dijit.setWaiState(this.focusNode,"valuenow",t)},_openResultList:function(t,e){if(!this.disabled&&e.query[this.searchAttr]==this._lastQuery){if(this._popupWidget.clearResultList(),!t.length)return this._hideResultList(),void 0;var i=new String(this.store.getValue(t[0],this.searchAttr));i&&this.autoComplete&&!this._prev_key_backspace&&"*"!=e.query[this.searchAttr]&&(this._autoCompleteText(i),dijit.setWaiState(this.focusNode||this.domNode,"valuenow",i)),this._popupWidget.createOptions(t,e,dojo.hitch(this,this._getMenuLabelFromItem)),this._showResultList(),e.direction&&(1==e.direction?this._popupWidget.highlightFirstOption():-1==e.direction&&this._popupWidget.highlightLastOption(),this._announceOption(this._popupWidget.getHighlightedOption()))}},_showResultList:function(){this._hideResultList();{var items=this._popupWidget.getItems();Math.min(items.length,this.maxListLength)}with(this._arrowPressed(),this._displayMessage(""),this._popupWidget.domNode.style)width="",height="";var best=this.open(),popupbox=dojo.marginBox(this._popupWidget.domNode);this._popupWidget.domNode.style.overflow=best.h==popupbox.h&&best.w==popupbox.w?"hidden":"auto";var newwidth=best.w;best.h<this._popupWidget.domNode.scrollHeight&&(newwidth+=16),dojo.marginBox(this._popupWidget.domNode,{h:best.h,w:Math.max(newwidth,this.domNode.offsetWidth)})},_hideResultList:function(){this._isShowingNow&&(dijit.popup.close(this._popupWidget),this._arrowIdle(),this._isShowingNow=!1)},_onBlur:function(){this._hasFocus=!1,this._hasBeenBlurred=!0,this._hideResultList(),this._arrowIdle();var t=this.getDisplayedValue();!this._popupWidget||t!=this._popupWidget._messages.previousMessage&&t!=this._popupWidget._messages.nextMessage?this.setDisplayedValue(t):this.setValue(this._lastValueReported,!0)},onfocus:function(t){this._hasFocus=!0,this._onMouse(t)},_announceOption:function(t){if(null!=t){var e;e=t==this._popupWidget.nextButton||t==this._popupWidget.previousButton?t.innerHTML:this.store.getValue(t.item,this.searchAttr),this.focusNode.value=this.focusNode.value.substring(0,this._getCaretPos(this.focusNode)),this._autoCompleteText(e)}},_selectOption:function(t){var e=null;return t||(t={target:this._popupWidget.getHighlightedOption()}),t.target?(e=t.target,t.noHide||(this._hideResultList(),this._setCaretPos(this.focusNode,this.store.getValue(e.item,this.searchAttr).length)),this._doSelect(e),void 0):(this.setDisplayedValue(this.getDisplayedValue()),void 0)},_doSelect:function(t){this.item=t.item,this.setValue(this.store.getValue(t.item,this.searchAttr),!0)},_onArrowMouseDown:function(t){this.disabled||(dojo.stopEvent(t),this.focus(),this._isShowingNow?this._hideResultList():this._startSearch(""))},_startSearchFromInput:function(){this._startSearch(this.focusNode.value)},_startSearch:function(t){function e(t,e){t.start+=t.count*e,t.direction=e,t.store.fetch(t)}this._popupWidget||(this._popupWidget=new dijit.form._ComboBoxMenu({onChange:dojo.hitch(this,this._selectOption)}));var i=this.query;this._lastQuery=i[this.searchAttr]=t+"*";var o=this.store.fetch({queryOptions:{ignoreCase:this.ignoreCase,deep:!0},query:i,onComplete:dojo.hitch(this,"_openResultList"),start:0,count:this.pageSize});this._nextSearch=this._popupWidget.onPage=dojo.hitch(this,e,o)},_getValueField:function(){return this.searchAttr},_arrowPressed:function(){!this.disabled&&this.hasDownArrow&&dojo.addClass(this.downArrowNode,"dijitArrowButtonActive")},_arrowIdle:function(){!this.disabled&&this.hasDownArrow&&dojo.removeClass(this.downArrowNode,"dojoArrowButtonPushed")},compositionend:function(){this.onkeypress({charCode:-1})},constructor:function(){this.query={}},postMixInProperties:function(){if(this.hasDownArrow||(this.baseClass="dijitTextBox"),!this.store){var t=this.srcNodeRef?dojo.query("> option",this.srcNodeRef).map(function(t){return t.style.display="none",{value:t.getAttribute("value"),name:String(t.innerHTML)}}):{};this.store=new dojo.data.ItemFileReadStore({data:{identifier:this._getValueField(),items:t}}),t&&t.length&&!this.value&&(this.value=t[-1!=this.srcNodeRef.selectedIndex?this.srcNodeRef.selectedIndex:0][this._getValueField()])}},uninitialize:function(){this._popupWidget&&(this._hideResultList(),this._popupWidget.destroy())},_getMenuLabelFromItem:function(t){return{html:!1,label:this.store.getValue(t,this.searchAttr)}},open:function(){return this._isShowingNow=!0,dijit.popup.open({popup:this._popupWidget,around:this.domNode,parent:this})}}),dojo.declare("dijit.form._ComboBoxMenu",[dijit._Widget,dijit._Templated],{templateString:"<div class='dijitMenu' dojoAttachEvent='onmousedown,onmouseup,onmouseover,onmouseout' tabIndex='-1' style='overflow:\"auto\";'><div class='dijitMenuItem dijitMenuPreviousButton' dojoAttachPoint='previousButton'></div><div class='dijitMenuItem dijitMenuNextButton' dojoAttachPoint='nextButton'></div></div>",_messages:null,postMixInProperties:function(){this._messages=dojo.i18n.getLocalization("dijit.form","ComboBox",this.lang),this.inherited("postMixInProperties",arguments)},setValue:function(t){this.value=t,this.onChange(t)},onChange:function(){},onPage:function(){},postCreate:function(){this.previousButton.innerHTML=this._messages.previousMessage,this.nextButton.innerHTML=this._messages.nextMessage,this.inherited("postCreate",arguments)},onClose:function(){this._blurOptionNode()},_createOption:function(t,e){var i=e(t),o=document.createElement("div");return i.html?o.innerHTML=i.label:o.appendChild(document.createTextNode(i.label)),""==o.innerHTML&&(o.innerHTML="&nbsp;"),o.item=t,o},createOptions:function(t,e,i){this.previousButton.style.display=0==e.start?"none":"";var o=this;dojo.forEach(t,function(t){var e=o._createOption(t,i);e.className="dijitMenuItem",o.domNode.insertBefore(e,o.nextButton)}),this.nextButton.style.display=e.count==t.length?"":"none"},clearResultList:function(){for(;this.domNode.childNodes.length>2;)this.domNode.removeChild(this.domNode.childNodes[this.domNode.childNodes.length-2])},getItems:function(){return this.domNode.childNodes},getListLength:function(){return this.domNode.childNodes.length-2},onmousedown:function(t){dojo.stopEvent(t)},onmouseup:function(t){if(t.target!==this.domNode)if(t.target==this.previousButton)this.onPage(-1);else if(t.target==this.nextButton)this.onPage(1);else{for(var e=t.target;!e.item;)e=e.parentNode;this.setValue({target:e},!0)}},onmouseover:function(t){if(t.target!==this.domNode){var e=t.target;if(e!=this.previousButton&&e!=this.nextButton)for(;!e.item;)e=e.parentNode;this._focusOptionNode(e)}},onmouseout:function(t){t.target!==this.domNode&&this._blurOptionNode()},_focusOptionNode:function(t){this._highlighted_option!=t&&(this._blurOptionNode(),this._highlighted_option=t,dojo.addClass(this._highlighted_option,"dijitMenuItemHover"))},_blurOptionNode:function(){this._highlighted_option&&(dojo.removeClass(this._highlighted_option,"dijitMenuItemHover"),this._highlighted_option=null)},_highlightNextOption:function(){this.getHighlightedOption()?this._highlighted_option.nextSibling&&"none"!=this._highlighted_option.nextSibling.style.display&&this._focusOptionNode(this._highlighted_option.nextSibling):this._focusOptionNode("none"==this.domNode.firstChild.style.display?this.domNode.firstChild.nextSibling:this.domNode.firstChild),dijit.scrollIntoView(this._highlighted_option)},highlightFirstOption:function(){this._focusOptionNode(this.domNode.firstChild.nextSibling),dijit.scrollIntoView(this._highlighted_option)},highlightLastOption:function(){this._focusOptionNode(this.domNode.lastChild.previousSibling),dijit.scrollIntoView(this._highlighted_option)},_highlightPrevOption:function(){this.getHighlightedOption()?this._highlighted_option.previousSibling&&"none"!=this._highlighted_option.previousSibling.style.display&&this._focusOptionNode(this._highlighted_option.previousSibling):this._focusOptionNode("none"==this.domNode.lastChild.style.display?this.domNode.lastChild.previousSibling:this.domNode.lastChild),dijit.scrollIntoView(this._highlighted_option)},_page:function(t){var e=0,i=this.domNode.scrollTop,o=parseInt(dojo.getComputedStyle(this.domNode).height);for(this.getHighlightedOption()||this._highlightNextOption();o>e;){if(t){if(!this.getHighlightedOption().previousSibling||"none"==this._highlighted_option.previousSibling.style.display)break;this._highlightPrevOption()}else{if(!this.getHighlightedOption().nextSibling||"none"==this._highlighted_option.nextSibling.style.display)break;this._highlightNextOption()}var s=this.domNode.scrollTop;e+=(s-i)*(t?-1:1),i=s}},pageUp:function(){this._page(!0)},pageDown:function(){this._page(!1)},getHighlightedOption:function(){return this._highlighted_option&&this._highlighted_option.parentNode?this._highlighted_option:null},handleKey:function(t){switch(t.keyCode){case dojo.keys.DOWN_ARROW:this._highlightNextOption();break;case dojo.keys.PAGE_DOWN:this.pageDown();break;case dojo.keys.UP_ARROW:this._highlightPrevOption();break;case dojo.keys.PAGE_UP:this.pageUp()}}}),dojo.declare("dijit.form.ComboBox",[dijit.form.ValidationTextBox,dijit.form.ComboBoxMixin],{postMixInProperties:function(){dijit.form.ComboBoxMixin.prototype.postMixInProperties.apply(this,arguments),dijit.form.ValidationTextBox.prototype.postMixInProperties.apply(this,arguments)}}));