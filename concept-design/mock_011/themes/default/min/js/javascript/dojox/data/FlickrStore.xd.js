dojo._xdResourceLoaded({depends:[["provide","dojox.data.FlickrStore"],["require","dojo.data.util.simpleFetch"],["require","dojo.io.script"],["require","dojo.date.stamp"]],defineResource:function(e){if(!e._hasResource["dojox.data.FlickrStore"]&&(e._hasResource["dojox.data.FlickrStore"]=!0,e.provide("dojox.data.FlickrStore"),e.require("dojo.data.util.simpleFetch"),e.require("dojo.io.script"),e.require("dojo.date.stamp"),e.declare("dojox.data.FlickrStore",null,{constructor:function(e){e&&e.label&&(this.label=e.label)},_flickrUrl:"http://api.flickr.com/services/feeds/photos_public.gne",_storeRef:"_S",label:"title",_assertIsItem:function(e){if(!this.isItem(e))throw new Error("dojox.data.FlickrStore: a function was passed an item argument that was not an item")},_assertIsAttribute:function(e){if("string"!=typeof e)throw new Error("dojox.data.FlickrStore: a function was passed an attribute argument that was not an attribute name string")},getFeatures:function(){return{"dojo.data.api.Read":!0}},getValue:function(e,t){var r=this.getValues(e,t);return r?r[0]:void 0},getAttributes:function(){return["title","description","author","datePublished","dateTaken","imageUrl","imageUrlSmall","imageUrlMedium","tags","link"]},hasAttribute:function(e,t){return this.getValue(e,t)?!0:!1},isItemLoaded:function(e){return this.isItem(e)},loadItem:function(){},getLabel:function(e){return this.getValue(e,this.label)},getLabelAttributes:function(){return[this.label]},containsValue:function(e,t,r){for(var i=this.getValues(e,t),a=0;a<i.length;a++)if(i[a]===r)return!0;return!1},getValues:function(t,r){return this._assertIsItem(t),this._assertIsAttribute(r),"title"===r?[this._unescapeHtml(t.title)]:"author"===r?[this._unescapeHtml(t.author)]:"datePublished"===r?[e.date.stamp.fromISOString(t.published)]:"dateTaken"===r?[e.date.stamp.fromISOString(t.date_taken)]:"imageUrlSmall"===r?[t.media.m.replace(/_m\./,"_s.")]:"imageUrl"===r?[t.media.m.replace(/_m\./,".")]:"imageUrlMedium"===r?[t.media.m]:"link"===r?[t.link]:"tags"===r?t.tags.split(" "):"description"===r?[this._unescapeHtml(t.description)]:void 0},isItem:function(e){return e&&e[this._storeRef]===this?!0:!1},close:function(){},_fetchItems:function(t,r,i){t.query||(t.query={});var a={format:"json",tagmode:"any"};t.query.tags&&(a.tags=t.query.tags),t.query.tagmode&&(a.tagmode=t.query.tagmode),t.query.userid&&(a.id=t.query.userid),t.query.userids&&(a.ids=t.query.userids),t.query.lang&&(a.lang=t.query.lang);var o=this,s=null,n={url:this._flickrUrl,preventCache:!0,content:a},u=function(i){null!==s&&e.disconnect(s),r(o._processFlickrData(i),t)};s=e.connect("jsonFlickrFeed",u);var l=e.io.script.get(n);l.addErrback(function(r){e.disconnect(s),i(r,t)})},_processFlickrData:function(e){var t=[];if(e.items){t=e.items;for(var r=0;r<e.items.length;r++){var i=e.items[r];i[this._storeRef]=this}}return t},_unescapeHtml:function(e){return e=e.replace(/&amp;/gm,"&").replace(/&lt;/gm,"<").replace(/&gt;/gm,">").replace(/&quot;/gm,'"'),e=e.replace(/&#39;/gm,"'")}}),e.extend(dojox.data.FlickrStore,e.data.util.simpleFetch),!t))var t=function(){}}});