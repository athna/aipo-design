dojo._hasResource["dojox.dtl.filter.strings"]||(dojo._hasResource["dojox.dtl.filter.strings"]=!0,dojo.provide("dojox.dtl.filter.strings"),dojo.require("dojox.dtl.filter.htmlstrings"),dojo.require("dojox.string.sprintf"),dojo.require("dojox.string.tokenize"),dojo.mixin(dojox.dtl.filter.strings,{addslashes:function(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/'/g,"\\'")},capfirst:function(t){return t=""+t,t.charAt(0).toUpperCase()+t.substring(1)},center:function(t,r){r=r||t.length,t+="";var e=r-t.length;e%2&&(t+=" ",e-=1);for(var n=0;e>n;n+=2)t=" "+t+" ";return t},cut:function(t,r){return r=r+""||"",t+="",t.replace(new RegExp(r,"g"),"")},_fix_ampersands:/&(?!(\w+|#\d+);)/g,fix_ampersands:function(t){return t.replace(dojox.dtl.filter.strings._fix_ampersands,"&amp;")},floatformat:function(t,r){r=parseInt(r||-1),t=parseFloat(t);var e=t-t.toFixed(0);return!e&&0>r?t.toFixed():(t=t.toFixed(Math.abs(r)),0>r?parseFloat(t)+"":t)},iriencode:function(t){return dojox.dtl.text.urlquote(t,"/#%[]=:;$&()+,!")},linenumbers:function(t){for(var r,e=dojox.dtl.filter,n=t.split("\n"),o=[],i=(n.length+"").length,s=0;s<n.length;s++)r=n[s],o.push(e.strings.ljust(s+1,i)+". "+e.htmlstrings.escape(r));return o.join("\n")},ljust:function(t,r){for(t+="",r=parseInt(r);t.length<r;)t+=" ";return t},lower:function(t){return(t+"").toLowerCase()},make_list:function(t){var r=[];if("number"==typeof t&&(t+=""),t.charAt){for(var e=0;e<t.length;e++)r.push(t.charAt(e));return r}if("object"==typeof t){for(var n in t)r.push(t[n]);return r}return[]},rjust:function(t,r){for(t+="",r=parseInt(r);t.length<r;)t=" "+t;return t},slugify:function(t){return t=t.replace(/[^\w\s-]/g,"").toLowerCase(),t.replace(/[\-\s]+/g,"-")},_strings:{},stringformat:function(t,r){r=""+r;var e=dojox.dtl.filter.strings._strings;return e[r]||(e[r]=new dojox.string.sprintf.Formatter("%"+r)),e[r].format(t)},title:function(t){for(var r,e,n="",o=0;o<t.length;o++)e=t.charAt(o),n+=" "!=r&&"\n"!=r&&"	"!=r&&r?e.toLowerCase():e.toUpperCase(),r=e;return n},_truncatewords:/[ \n\r\t]/,truncatewords:function(t,r){if(r=parseInt(r),!r)return t;for(var e,n,o=0,i=t.length,s=0;o<t.length;o++){if(e=t.charAt(o),dojox.dtl.filter.strings._truncatewords.test(n)){if(!dojox.dtl.filter.strings._truncatewords.test(e)&&(++s,s==r))return t.substring(0,i+1)}else dojox.dtl.filter.strings._truncatewords.test(e)||(i=o);n=e}return t},_truncate_words:/(&.*?;|<.*?>|(\w[\w-]*))/g,_truncate_tag:/<(\/)?([^ ]+?)(?: (\/)| .*?)?>/,_truncate_singlets:{br:!0,col:!0,link:!0,base:!0,img:!0,param:!0,area:!0,hr:!0,input:!0},truncatewords_html:function(t,r){if(r=parseInt(r),0>=r)return"";var e=dojox.dtl.filter.strings,n=0,o=[],i=dojox.string.tokenize(t,e._truncate_words,function(t,i){if(i){if(++n,r>n)return i;if(n==r)return i+" ..."}var s=t.match(e._truncate_tag);if(s&&!(n>=r)){{var u=s[1],l=s[2].toLowerCase();s[3]}if(u||e._truncate_singlets[l]);else if(u){var a=dojo.indexOf(o,l);-1!=a&&(o=o.slice(a+1))}else o.unshift(l);return t}}).join("");i=i.replace(/\s+$/g,"");for(var s,u=0;s=o[u];u++)i+="</"+s+">";return i},upper:function(t){return t.toUpperCase()},urlencode:function(t){return dojox.dtl.text.urlquote(t)},_urlize:/^((?:[(>]|&lt;)*)(.*?)((?:[.,)>\n]|&gt;)*)$/,_urlize2:/^\S+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+$/,urlize:function(t){return dojox.dtl.filter.strings.urlizetrunc(t)},urlizetrunc:function(t,r){return r=parseInt(r),dojox.string.tokenize(t,/(\S+)/g,function(t){var e=dojox.dtl.filter.strings._urlize.exec(t);if(!e)return t;var n=(e[1],e[2]),o=(e[3],0==n.indexOf("www.")),i=-1!=n.indexOf("@"),s=-1!=n.indexOf(":"),u=0==n.indexOf("http://"),l=0==n.indexOf("https://"),a=/[a-zA-Z0-9]/.test(n.charAt(0)),f=n.substring(n.length-4),d=n;return r>3&&(d=d.substring(0,r-3)+"..."),o||!i&&!u&&n.length&&a&&(".org"==f||".net"==f||".com"==f)?'<a href="http://'+n+'" rel="nofollow">'+d+"</a>":u||l?'<a href="'+n+'" rel="nofollow">'+d+"</a>":i&&!o&&!s&&dojox.dtl.filter.strings._urlize2.test(n)?'<a href="mailto:'+n+'">'+n+"</a>":t}).join("")},wordcount:function(t){return dojox.dtl.text.pySplit(t).length},wordwrap:function(t,r){r=parseInt(r);var e=[],n=t.split(/ /g);if(n.length){var o=n.shift();e.push(o);for(var i=o.length-o.lastIndexOf("\n")-1,s=0;s<n.length;s++){if(o=n[s],-1!=o.indexOf("\n"))var u=o.split(/\n/g);else var u=[o];i+=u[0].length+1,r&&i>r?(e.push("\n"),i=u[u.length-1].length):(e.push(" "),u.length>1&&(i=u[u.length-1].length)),e.push(o)}}return e.join("")}}));