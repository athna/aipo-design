dojo._hasResource["dojox.gfx.silverlight"]||(dojo._hasResource["dojox.gfx.silverlight"]=!0,dojo.provide("dojox.gfx.silverlight"),dojo.require("dojox.gfx._base"),dojo.require("dojox.gfx.shape"),dojo.require("dojox.gfx.path"),dojo.experimental("dojox.gfx.silverlight"),dojox.gfx.silverlight.dasharray={solid:"none",shortdash:[4,1],shortdot:[1,1],shortdashdot:[4,1,1,1],shortdashdotdot:[4,1,1,1,1,1],dot:[1,3],dash:[4,3],longdash:[8,3],dashdot:[4,3,1,3],longdashdot:[8,3,1,3],longdashdotdot:[8,3,1,3,1,3]},dojox.gfx.silverlight.fontweight={normal:400,bold:700},dojox.gfx.silverlight.caps={butt:"Flat",round:"Round",square:"Square"},dojox.gfx.silverlight.joins={bevel:"Bevel",round:"Round"},dojox.gfx.silverlight.fonts={serif:"Times New Roman",times:"Times New Roman","sans-serif":"Arial",helvetica:"Arial",monotone:"Courier New",courier:"Courier New"},dojox.gfx.silverlight.hexColor=function(e){var o=dojox.gfx.normalizeColor(e),t=o.toHex(),r=Math.round(255*o.a);return r=(0>r?0:r>255?255:r).toString(16),"#"+(r.length<2?"0"+r:r)+t.slice(1)},dojo.extend(dojox.gfx.Shape,{setFill:function(e){var o,t=this.rawNode.getHost().content,r=this.rawNode;if(!e)return this.fillStyle=null,this._setFillAttr(null),this;if("object"==typeof e&&"type"in e){switch(e.type){case"linear":this.fillStyle=o=dojox.gfx.makeParameters(dojox.gfx.defaultLinearGradient,e);var a=t.createFromXaml("<LinearGradientBrush/>");a.mappingMode="Absolute",a.startPoint=o.x1+","+o.y1,a.endPoint=o.x2+","+o.y2,dojo.forEach(o.colors,function(e){var o=t.createFromXaml("<GradientStop/>");o.offset=e.offset,o.color=dojox.gfx.silverlight.hexColor(e.color),a.gradientStops.add(o)}),this._setFillAttr(a);break;case"radial":this.fillStyle=o=dojox.gfx.makeParameters(dojox.gfx.defaultRadialGradient,e);var i=t.createFromXaml("<RadialGradientBrush/>"),n=r.width,s=r.height,d=this.rawNode["Canvas.Left"],h=this.rawNode["Canvas.Top"];i.center=(o.cx-d)/n+","+(o.cy-h)/s,i.radiusX=o.r/n,i.radiusY=o.r/s,dojo.forEach(o.colors,function(e){var o=t.createFromXaml("<GradientStop/>");o.offset=e.offset,o.color=dojox.gfx.silverlight.hexColor(e.color),i.gradientStops.add(o)}),this._setFillAttr(i);break;case"pattern":this.fillStyle=null,this._setFillAttr(null)}return this}this.fillStyle=o=dojox.gfx.normalizeColor(e);var l=t.createFromXaml("<SolidColorBrush/>");return l.color=o.toHex(),l.opacity=o.a,this._setFillAttr(l),this},_setFillAttr:function(e){this.rawNode.fill=e},setStroke:function(e){var o=this.rawNode.getHost().content,t=this.rawNode;if(!e)return this.strokeStyle=null,t.stroke=null,this;"string"==typeof e&&(e={color:e});var r=this.strokeStyle=dojox.gfx.makeParameters(dojox.gfx.defaultStroke,e);if(r.color=dojox.gfx.normalizeColor(r.color),r){var a=o.createFromXaml("<SolidColorBrush/>");a.color=r.color.toHex(),a.opacity=r.color.a,t.stroke=a,t.strokeThickness=r.width,t.strokeStartLineCap=t.strokeEndLineCap=t.strokeDashCap=dojox.gfx.silverlight.caps[r.cap],"number"==typeof r.join?(t.strokeLineJoin="Miter",t.strokeMiterLimit=r.join):t.strokeLineJoin=dojox.gfx.silverlight.joins[r.join];var i=r.style.toLowerCase();if(i in dojox.gfx.silverlight.dasharray&&(i=dojox.gfx.silverlight.dasharray[i]),i instanceof Array){if(i=dojo.clone(i),"butt"!=r.cap){for(var n=0;n<i.length;n+=2)--i[n],i[n]<1&&(i[n]=1);for(var n=1;n<i.length;n+=2)++i[n]}t.strokeDashArray=i.join(",")}else t.strokeDashArray=null}return this},_getParentSurface:function(){for(var e=this.parent;e&&!(e instanceof dojox.gfx.Surface);e=e.parent);return e},_applyTransform:function(){var e=this.matrix,o=this.rawNode;if(e){var t=this.rawNode.getHost().content,r=t.createFromXaml("<MatrixTransform/>"),a=t.createFromXaml("<Matrix/>");a.m11=e.xx,a.m21=e.xy,a.m12=e.yx,a.m22=e.yy,a.offsetX=e.dx,a.offsetY=e.dy,r.matrix=a,o.renderTransform=r}else o.renderTransform=null;return this},setRawNode:function(e){e.fill=null,e.stroke=null,this.rawNode=e},_moveToFront:function(){var e=this.parent.rawNode.children,o=this.rawNode;return e.remove(o),e.add(o),this},_moveToBack:function(){var e=this.parent.rawNode.children,o=this.rawNode;return e.remove(o),e.insert(0,o),this}}),dojo.declare("dojox.gfx.Group",dojox.gfx.Shape,{constructor:function(){dojox.gfx.silverlight.Container._init.call(this)},setRawNode:function(e){this.rawNode=e}}),dojox.gfx.Group.nodeType="Canvas",dojo.declare("dojox.gfx.Rect",dojox.gfx.shape.Rect,{setShape:function(e){this.shape=dojox.gfx.makeParameters(this.shape,e),this.bbox=null;var o=this.rawNode,t=this.shape;return o["Canvas.Left"]=t.x,o["Canvas.Top"]=t.y,o.width=t.width,o.height=t.height,o.radiusX=o.radiusY=t.r,this}}),dojox.gfx.Rect.nodeType="Rectangle",dojo.declare("dojox.gfx.Ellipse",dojox.gfx.shape.Ellipse,{setShape:function(e){this.shape=dojox.gfx.makeParameters(this.shape,e),this.bbox=null;var o=this.rawNode,t=this.shape;return o["Canvas.Left"]=t.cx-t.rx,o["Canvas.Top"]=t.cy-t.ry,o.width=2*t.rx,o.height=2*t.ry,this}}),dojox.gfx.Ellipse.nodeType="Ellipse",dojo.declare("dojox.gfx.Circle",dojox.gfx.shape.Circle,{setShape:function(e){this.shape=dojox.gfx.makeParameters(this.shape,e),this.bbox=null;var o=this.rawNode,t=this.shape;return o["Canvas.Left"]=t.cx-t.r,o["Canvas.Top"]=t.cy-t.r,o.width=o.height=2*t.r,this}}),dojox.gfx.Circle.nodeType="Ellipse",dojo.declare("dojox.gfx.Line",dojox.gfx.shape.Line,{setShape:function(e){this.shape=dojox.gfx.makeParameters(this.shape,e),this.bbox=null;var o=this.rawNode,t=this.shape;return o.x1=t.x1,o.y1=t.y1,o.x2=t.x2,o.y2=t.y2,this}}),dojox.gfx.Line.nodeType="Line",dojo.declare("dojox.gfx.Polyline",dojox.gfx.shape.Polyline,{setShape:function(e,o){e&&e instanceof Array?(this.shape=dojox.gfx.makeParameters(this.shape,{points:e}),o&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=dojox.gfx.makeParameters(this.shape,e),this.box=null;for(var t=this.shape.points,r=[],a=0;a<t.length;++a)"number"==typeof t[a]?r.push(t[a],t[++a]):r.push(t[a].x,t[a].y);return this.rawNode.points=r.join(","),this}}),dojox.gfx.Polyline.nodeType="Polyline",dojo.declare("dojox.gfx.Image",dojox.gfx.shape.Image,{setShape:function(e){this.shape=dojox.gfx.makeParameters(this.shape,e),this.bbox=null;var o=this.rawNode,t=this.shape;return o["Canvas.Left"]=t.x,o["Canvas.Top"]=t.y,o.width=t.width,o.height=t.height,o.source=t.src,this},setRawNode:function(e){this.rawNode=e}}),dojox.gfx.Image.nodeType="Image",dojo.declare("dojox.gfx.Text",dojox.gfx.shape.Text,{setShape:function(e){this.shape=dojox.gfx.makeParameters(this.shape,e),this.bbox=null;var o=this.rawNode,t=this.shape;return o.text=t.text,o.textDecorations="underline"==t.decoration?"Underline":"None",o["Canvas.Left"]=-1e4,o["Canvas.Top"]=-1e4,window.setTimeout(dojo.hitch(this,"_delayAlignment"),0),this},_delayAlignment:function(){var e=this.rawNode,o=this.shape,t=e.actualWidth,r=e.actualHeight,a=o.x,i=o.y-.75*r;switch(o.align){case"middle":a-=t/2;break;case"end":a-=t}var n=this.matrix?dojox.gfx.matrix.multiplyPoint(this.matrix,a,i):{x:a,y:i};e["Canvas.Left"]=n.x,e["Canvas.Top"]=n.y},setStroke:function(){return this},_setFillAttr:function(e){this.rawNode.foreground=e},setRawNode:function(e){this.rawNode=e},_applyTransform:function(){var e=this.matrix,o=this.rawNode;if(e){e=dojox.gfx.matrix.normalize([.01,e,100]);var t=this.rawNode.getHost().content,r=t.createFromXaml("<MatrixTransform/>"),a=t.createFromXaml("<Matrix/>");a.m11=e.xx,a.m21=e.xy,a.m12=e.yx,a.m22=e.yy,a.offsetX=e.dx,a.offsetY=e.dy,r.matrix=a,o.renderTransform=r}else o.renderTransform=null;return this},getTextWidth:function(){return this.rawNode.actualWidth}}),dojox.gfx.Text.nodeType="TextBlock",dojo.declare("dojox.gfx.Path",dojox.gfx.path.Path,{_updateWithSegment:function(){dojox.gfx.Path.superclass._updateWithSegment.apply(this,arguments);var e=this.shape.path;"string"==typeof e&&(this.rawNode.data=e?e:null)},setShape:function(){dojox.gfx.Path.superclass.setShape.apply(this,arguments);var e=this.shape.path;return this.rawNode.data=e?e:null,this}}),dojox.gfx.Path.nodeType="Path",dojo.declare("dojox.gfx.TextPath",dojox.gfx.path.TextPath,{_updateWithSegment:function(){},setShape:function(){},_setText:function(){}}),dojox.gfx.TextPath.nodeType="text",dojo.declare("dojox.gfx.Surface",dojox.gfx.shape.Surface,{constructor:function(){dojox.gfx.silverlight.Container._init.call(this)},setDimensions:function(e,o){this.width=dojox.gfx.normalizedLength(e),this.height=dojox.gfx.normalizedLength(o);var t=this.rawNode&&this.rawNode.getHost();return t&&(t.width=e,t.height=o),this},getDimensions:function(){var e=this.rawNode&&this.rawNode.getHost(),o=e?{width:e.content.actualWidth,height:e.content.actualHeight}:null;return o.width<=0&&(o.width=this.width),o.height<=0&&(o.height=this.height),o}}),dojox.gfx.silverlight.surfaces={},dojox.gfx.createSurface=function(e,o,t){var r=new dojox.gfx.Surface;e=dojo.byId(e);var a=e.ownerDocument.createElement("script");a.type="text/xaml",a.id=dojox.gfx._base._getUniqueId(),a.text="<Canvas xmlns='http://schemas.microsoft.com/client/2007' Name='"+dojox.gfx._base._getUniqueId()+"'/>",document.body.appendChild(a);var i=dojox.gfx._base._getUniqueId();return Silverlight.createObject("#"+a.id,e,i,{width:String(o),height:String(t),inplaceInstallPrompt:"false",background:"transparent",isWindowless:"true",framerate:"24",version:"1.0"},{},null,null),r.rawNode=dojo.byId(i).content.root,dojox.gfx.silverlight.surfaces[r.rawNode.name]=e,r.width=dojox.gfx.normalizedLength(o),r.height=dojox.gfx.normalizedLength(t),r},dojox.gfx.silverlight.Font={_setFont:function(){var e=this.fontStyle,o=this.rawNode,t=dojox.gfx.silverlight.fontweight,r=dojox.gfx.silverlight.fonts,a=e.family.toLowerCase();o.fontStyle="italic"==e.style?"Italic":"Normal",o.fontWeight=e.weight in t?t[e.weight]:e.weight,o.fontSize=dojox.gfx.normalizedLength(e.size),o.fontFamily=a in r?r[a]:e.family}},dojox.gfx.silverlight.Container={_init:function(){dojox.gfx.shape.Container._init.call(this)},add:function(e){return this!=e.getParent()&&(dojox.gfx.shape.Container.add.apply(this,arguments),this.rawNode.children.add(e.rawNode)),this},remove:function(e){if(this==e.getParent()){var o=e.rawNode.getParent();o&&o.children.remove(e.rawNode),dojox.gfx.shape.Container.remove.apply(this,arguments)}return this},clear:function(){return this.rawNode.children.clear(),dojox.gfx.shape.Container.clear.apply(this,arguments)},_moveChildToFront:dojox.gfx.shape.Container._moveChildToFront,_moveChildToBack:dojox.gfx.shape.Container._moveChildToBack},dojo.mixin(dojox.gfx.shape.Creator,{createObject:function(e,o){if(!this.rawNode)return null;var t=new e,r=this.rawNode.getHost().content.createFromXaml("<"+e.nodeType+"/>");return t.setRawNode(r),t.setShape(o),this.add(t),t}}),dojo.extend(dojox.gfx.Text,dojox.gfx.silverlight.Font),dojo.extend(dojox.gfx.Group,dojox.gfx.silverlight.Container),dojo.extend(dojox.gfx.Group,dojox.gfx.shape.Creator),dojo.extend(dojox.gfx.Surface,dojox.gfx.silverlight.Container),dojo.extend(dojox.gfx.Surface,dojox.gfx.shape.Creator),function(){var e=dojox.gfx.silverlight.surfaces,o=function(o,t){var r={target:o,currentTarget:o,preventDefault:function(){},stopPropagation:function(){}};if(t){r.ctrlKey=t.ctrl,r.shiftKey=t.shift;var a=t.getPosition(null);r.x=r.offsetX=r.layerX=a.x,r.y=r.offsetY=r.layerY=a.y;var i=e[o.getHost().content.root.name],n=dojo._abs(i);r.clientX=n.x+a.x,r.clientY=n.y+a.y}return r},t=function(e,o){var t={keyCode:o.platformKeyCode,ctrlKey:o.ctrl,shiftKey:o.shift};return t},r={onclick:{name:"MouseLeftButtonUp",fix:o},onmouseenter:{name:"MouseEnter",fix:o},onmouseleave:{name:"MouseLeave",fix:o},onmousedown:{name:"MouseLeftButtonDown",fix:o},onmouseup:{name:"MouseLeftButtonUp",fix:o},onmousemove:{name:"MouseMove",fix:o},onkeydown:{name:"KeyDown",fix:t},onkeyup:{name:"KeyUp",fix:t}},a={connect:function(e,o,t){var a,i=e in r?r[e]:{name:e,fix:function(){return{}}};return a=arguments.length>2?this.getEventSource().addEventListener(i.name,function(e,r){dojo.hitch(o,t)(i.fix(e,r))}):this.getEventSource().addEventListener(i.name,function(e,t){o(i.fix(e,t))}),{name:i.name,token:a}},disconnect:function(e){this.getEventSource().removeEventListener(e.name,e.token)}};dojo.extend(dojox.gfx.Shape,a),dojo.extend(dojox.gfx.Surface,a),dojox.gfx.equalSources=function(e,o){return e&&o&&e.equals(o)}}());