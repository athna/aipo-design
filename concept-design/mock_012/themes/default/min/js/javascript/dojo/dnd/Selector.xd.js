dojo._xdResourceLoaded({depends:[["provide","dojo.dnd.Selector"],["require","dojo.dnd.common"],["require","dojo.dnd.Container"]],defineResource:function(e){e._hasResource["dojo.dnd.Selector"]||(e._hasResource["dojo.dnd.Selector"]=!0,e.provide("dojo.dnd.Selector"),e.require("dojo.dnd.common"),e.require("dojo.dnd.Container"),e.declare("dojo.dnd.Selector",e.dnd.Container,{constructor:function(t,s){s||(s={}),this.singular=s.singular,this.selection={},this.anchor=null,this.simpleSelection=!1,this.events.push(e.connect(this.node,"onmousedown",this,"onMouseDown"),e.connect(this.node,"onmouseup",this,"onMouseUp"))},singular:!1,getSelectedNodes:function(){var t=new e.NodeList,s=e.dnd._empty;for(var n in this.selection)n in s||t.push(e.byId(n));return t},selectNone:function(){return this._removeSelection()._removeAnchor()},selectAll:function(){return this.forInItems(function(t,s){this._addItemClass(e.byId(s),"Selected"),this.selection[s]=1},this),this._removeAnchor()},deleteSelectedNodes:function(){var t=e.dnd._empty;for(var s in this.selection)if(!(s in t)){var n=e.byId(s);this.delItem(s),e._destroyElement(n)}return this.anchor=null,this.selection={},this},insertNodes:function(t,s,n,i){var o=this._normalizedCreator;return this._normalizedCreator=function(e,s){var n=o.call(this,e,s);return t?(this.anchor?this.anchor!=n.node&&(this._removeItemClass(n.node,"Anchor"),this._addItemClass(n.node,"Selected")):(this.anchor=n.node,this._removeItemClass(n.node,"Selected"),this._addItemClass(this.anchor,"Anchor")),this.selection[n.node.id]=1):(this._removeItemClass(n.node,"Selected"),this._removeItemClass(n.node,"Anchor")),n},e.dnd.Selector.superclass.insertNodes.call(this,s,n,i),this._normalizedCreator=o,this},destroy:function(){e.dnd.Selector.superclass.destroy.call(this),this.selection=this.anchor=null},markupFactory:function(t,s){return t._skipStartup=!0,new e.dnd.Selector(s,t)},onMouseDown:function(t){if(this.current){if(!this.singular&&!e.dnd.getCopyKeyState(t)&&!t.shiftKey&&this.current.id in this.selection)return this.simpleSelection=!0,e.stopEvent(t),void 0;if(!this.singular&&t.shiftKey){e.dnd.getCopyKeyState(t)||this._removeSelection();var s=e.query("> .dojoDndItem",this.parent);if(s.length&&(this.anchor||(this.anchor=s[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var n=0;n<s.length;++n){var i=s[n];if(i==this.anchor||i==this.current)break}for(++n;n<s.length;++n){var i=s[n];if(i==this.anchor||i==this.current)break;this._addItemClass(i,"Selected"),this.selection[i.id]=1}this._addItemClass(this.current,"Selected"),this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?e.dnd.getCopyKeyState(t)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):e.dnd.getCopyKeyState(t)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);e.stopEvent(t)}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=e.connect(this.node,"onmousemove",this,"onMouseMove")},onOutEvent:function(){e.disconnect(this.onmousemoveEvent),delete this.onmousemoveEvent},_removeSelection:function(){var t=e.dnd._empty;for(var s in this.selection)if(!(s in t)){var n=e.byId(s);n&&this._removeItemClass(n,"Selected")}return this.selection={},this},_removeAnchor:function(){return this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null),this}}))}});