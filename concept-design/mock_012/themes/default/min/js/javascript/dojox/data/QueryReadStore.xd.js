dojo._xdResourceLoaded({depends:[["provide","dojox.data.QueryReadStore"],["provide","dojox.data.QueryReadStore.InvalidItemError"],["provide","dojox.data.QueryReadStore.InvalidAttributeError"],["require","dojo.string"],["require","dojo.data.util.simpleFetch"]],defineResource:function(t){t._hasResource["dojox.data.QueryReadStore"]||(t._hasResource["dojox.data.QueryReadStore"]=!0,t.provide("dojox.data.QueryReadStore"),t.provide("dojox.data.QueryReadStore.InvalidItemError"),t.provide("dojox.data.QueryReadStore.InvalidAttributeError"),t.require("dojo.string"),t.require("dojo.data.util.simpleFetch"),t.declare("dojox.data.QueryReadStore",null,{url:"",requestMethod:"get",_className:"dojox.data.QueryReadStore",_items:[],_lastServerQuery:null,lastRequestHash:null,doClientPaging:!0,_itemsByIdentity:null,_identifier:null,_features:{"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0},constructor:function(e){t.mixin(this,e)},getValue:function(e,r,i){if(this._assertIsItem(e),!t.isString(r))throw new Error(this._className+".getValue(): Invalid attribute, string expected!");if(!this.hasAttribute(e,r)){if(i)return i;console.log(this._className+".getValue(): Item does not have the attribute '"+r+"'.")}return e.i[r]},getValues:function(t,e){var r=[];return this.hasAttribute(t,e)&&r.push(t.i[e]),r},getAttributes:function(t){this._assertIsItem(t);var e=[];for(var r in t.i)e.push(r);return e},hasAttribute:function(t,e){return this.isItem(t)&&"undefined"!=typeof t.i[e]},containsValue:function(t,e,r){for(var i=this.getValues(t,e),o=i.length,n=0;o>n;n++)if(i[n]==r)return!0;return!1},isItem:function(t){return t?"undefined"!=typeof t.r&&t.r==this:!1},isItemLoaded:function(t){return this.isItem(t)},loadItem:function(t){this.isItemLoaded(t.item)},fetch:function(e){e=e||{},e.store||(e.store=this);var r=this,i=function(e,r){if(r.onError){var i=r.scope||t.global;r.onError.call(i,e,r)}},o=function(e,i){var o=i.abort||null,n=!1,a=i.start?i.start:0;0==r.doClientPaging&&(a=0);var s=i.count?a+i.count:e.length;i.abort=function(){n=!0,o&&o.call(i)};var u=i.scope||t.global;if(i.store||(i.store=r),i.onBegin&&i.onBegin.call(u,e.length,i),i.sort&&e.sort(t.data.util.sorter.createSortFunction(i.sort,r)),i.onItem)for(var d=a;d<e.length&&s>d;++d){var l=e[d];n||i.onItem.call(u,l,i)}if(i.onComplete&&!n){var h=null;i.onItem||(h=e.slice(a,s)),i.onComplete.call(u,h,i)}};return this._fetchItems(e,o,i),e},getFeatures:function(){return this._features},close:function(){},getLabel:function(){return void 0},getLabelAttributes:function(){return null},_fetchItems:function(e,r,o){var n=e.serverQuery||e.query||{};if(this.doClientPaging||(n.start=e.start||0,e.count&&(n.count=e.count)),this.doClientPaging&&null!==this._lastServerQuery&&t.toJson(n)==t.toJson(this._lastServerQuery))r(this._items,e);else{var a="post"==this.requestMethod.toLowerCase()?t.xhrPost:t.xhrGet,s=a({url:this.url,handleAs:"json-comment-optional",content:n});s.addCallback(t.hitch(this,function(o){o=this._filterResponse(o),this._items=[],t.forEach(o.items,function(t){this._items.push({i:t,r:this})},this);var n=o.identifier;if(this._itemsByIdentity={},n)for(this._identifier=n,i=0;i<this._items.length;++i){var a=this._items[i].i,s=a[n];if(this._itemsByIdentity[s])throw new Error("dojo.data.QueryReadStore:  The json data as specified by: ["+this.url+"] is malformed.  Items within the list have identifier: ["+n+"].  Value collided: ["+s+"]");this._itemsByIdentity[s]=a}else for(this._identifier=Number,i=0;i<this._items.length;++i)this._items[i].n=i;r(this._items,e)})),s.addErrback(function(t){o(t,e)}),this.lastRequestHash=(new Date).getTime()+"-"+String(Math.random()).substring(2),this._lastServerQuery=t.mixin({},n)}},_filterResponse:function(t){return t},_assertIsItem:function(t){if(!this.isItem(t))throw new dojox.data.QueryReadStore.InvalidItemError(this._className+": a function was passed an item argument that was not an item")},_assertIsAttribute:function(t){if("string"!=typeof t)throw new dojox.data.QueryReadStore.InvalidAttributeError(this._className+": '"+t+"' is not a valid attribute identifier.")},fetchItemByIdentity:function(e){if(this._itemsByIdentity){var r=this._itemsByIdentity[e.identity];if(void 0!==r){if(e.onItem){var i=e.scope?e.scope:t.global;e.onItem.call(i,{i:r,r:this})}return}}var o=function(){var r=e.scope?e.scope:t.global;e.onError&&e.onError.call(r,error)},n=function(r){var i=e.scope?e.scope:t.global;try{var o=null;r&&1==r.length&&(o=r[0]),e.onItem&&e.onItem.call(i,o)}catch(n){e.onError&&e.onError.call(i,n)}},a={serverQuery:{id:e.identity}};this._fetchItems(a,n,o)},getIdentity:function(t){var e=null;return e=this._identifier===Number?t.n:t.i[this._identifier]},getIdentityAttributes:function(){return[this._identifier]}}),t.declare("dojox.data.QueryReadStore.InvalidItemError",Error,{}),t.declare("dojox.data.QueryReadStore.InvalidAttributeError",Error,{}))}});