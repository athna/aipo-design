dojo._xdResourceLoaded({depends:[["provide","dijit._base.focus"]],defineResource:function(e){e._hasResource["dijit._base.focus"]||(e._hasResource["dijit._base.focus"]=!0,e.provide("dijit._base.focus"),e.mixin(dijit,{_curFocus:null,_prevFocus:null,isCollapsed:function(){var t=e.global,o=e.doc;if(o.selection)return!o.selection.createRange().text;if(t.getSelection){var i=t.getSelection();return e.isString(i)?!i:i.isCollapsed||!i.toString()}},getBookmark:function(){var t,o=e.doc.selection;if(o){var i=o.createRange();t="CONTROL"==o.type.toUpperCase()?i.length?e._toArray(i):null:i.getBookmark()}else if(e.global.getSelection){if(o=e.global.getSelection()){var i=o.getRangeAt(0);t=i.cloneRange()}}else console.debug("No idea how to store the current selection for this browser!");return t},moveToBookmark:function(t){var o=e.doc;if(o.selection){var i;e.isArray(t)?(i=o.body.createControlRange(),e.forEach(t,i.addElement)):(i=o.selection.createRange(),i.moveToBookmark(t)),i.select()}else{var n=e.global.getSelection&&e.global.getSelection();n&&n.removeAllRanges?(n.removeAllRanges(),n.addRange(t)):console.debug("No idea how to restore selection for this browser!")}},getFocus:function(t,o){return{node:t&&e.isDescendant(dijit._curFocus,t.domNode)?dijit._prevFocus:dijit._curFocus,bookmark:e.withGlobal(o||e.global,dijit.isCollapsed)?null:e.withGlobal(o||e.global,dijit.getBookmark),openedForWindow:o}},focus:function(t){if(t){var o="node"in t?t.node:t,i=t.bookmark,n=t.openedForWindow;if(o){var a="iframe"==o.tagName.toLowerCase()?o.contentWindow:o;if(a&&a.focus)try{a.focus()}catch(c){}dijit._onFocusNode(o)}if(i&&e.withGlobal(n||e.global,dijit.isCollapsed)){n&&n.focus();try{e.withGlobal(n||e.global,moveToBookmark,null,[i])}catch(c){}}}},_activeStack:[],registerWin:function(t){t||(t=window),e.connect(t.document,"onmousedown",null,function(e){dijit._justMouseDowned=!0,setTimeout(function(){dijit._justMouseDowned=!1},0),dijit._onTouchNode(e.target||e.srcElement)});var o=t.document.body||t.document.getElementsByTagName("body")[0];o&&(e.isIE&&e.isIE<11?(o.attachEvent("onactivate",function(e){"body"!=e.srcElement.tagName.toLowerCase()&&dijit._onFocusNode(e.srcElement)}),o.attachEvent("ondeactivate",function(e){dijit._onBlurNode(e.srcElement)})):(o.addEventListener("focus",function(e){dijit._onFocusNode(e.target)},!0),o.addEventListener("blur",function(e){dijit._onBlurNode(e.target)},!0))),o=null},_onBlurNode:function(e){dijit._prevFocus=dijit._curFocus,dijit._curFocus=null;var t=dijit.getEnclosingWidget(e);t&&t._setStateClass&&(t._focused=!1,t._setStateClass()),dijit._justMouseDowned||(dijit._clearActiveWidgetsTimer&&clearTimeout(dijit._clearActiveWidgetsTimer),dijit._clearActiveWidgetsTimer=setTimeout(function(){delete dijit._clearActiveWidgetsTimer,dijit._setStack([])},100))},_onTouchNode:function(t){dijit._clearActiveWidgetsTimer&&(clearTimeout(dijit._clearActiveWidgetsTimer),delete dijit._clearActiveWidgetsTimer);var o=[];try{for(;t;)if(t.dijitPopupParent)t=dijit.byId(t.dijitPopupParent).domNode;else if(t.tagName&&"body"==t.tagName.toLowerCase()){if(t===e.body())break;t=e.query("iframe").filter(function(e){return e.contentDocument.body===t})[0]}else{var i=t.getAttribute&&t.getAttribute("widgetId");i&&o.unshift(i),t=t.parentNode}}catch(n){}dijit._setStack(o)},_onFocusNode:function(t){if(!(t&&t.tagName&&"body"==t.tagName.toLowerCase()||(dijit._onTouchNode(t),t==dijit._curFocus))){dijit._prevFocus=dijit._curFocus,dijit._curFocus=t,e.publish("focusNode",[t]);var o=dijit.getEnclosingWidget(t);o&&o._setStateClass&&(o._focused=!0,o._setStateClass())}},_setStack:function(t){var o=dijit._activeStack;dijit._activeStack=t;for(var i=0;i<Math.min(o.length,t.length)&&o[i]==t[i];i++);for(var n=o.length-1;n>=i;n--){var a=dijit.byId(o[n]);a&&(e.publish("widgetBlur",[a]),a._onBlur&&a._onBlur())}for(var n=i;n<t.length;n++){var a=dijit.byId(t[n]);a&&(e.publish("widgetFocus",[a]),a._onFocus&&a._onFocus())}}}),e.addOnLoad(dijit.registerWin))}});