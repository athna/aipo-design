dojo._xdResourceLoaded({depends:[["provide","dojox.data.HtmlTableStore"],["require","dojox.data.dom"],["require","dojo.data.util.simpleFetch"],["require","dojo.data.util.filter"]],defineResource:function(t){t._hasResource["dojox.data.HtmlTableStore"]||(t._hasResource["dojox.data.HtmlTableStore"]=!0,t.provide("dojox.data.HtmlTableStore"),t.require("dojox.data.dom"),t.require("dojo.data.util.simpleFetch"),t.require("dojo.data.util.filter"),t.declare("dojox.data.HtmlTableStore",null,{constructor:function(e){if(e.url){if(!e.tableId)throw new Error("dojo.data.HtmlTableStore: Cannot instantiate using url without an id!");this.url=e.url,this.tableId=e.tableId}else{e.tableId?(this._rootNode=t.byId(e.tableId),this.tableId=this._rootNode.id):this._rootNode=t.byId(this.tableId),this._getHeadings();for(var o=0;o<this._rootNode.rows.length;o++)this._rootNode.rows[o].store=this}},url:"",tableId:"",_getHeadings:function(){this._headings=[],t.forEach(this._rootNode.tHead.rows[0].cells,t.hitch(this,function(t){this._headings.push(dojox.data.dom.textContent(t))}))},_getAllItems:function(){for(var t=[],e=1;e<this._rootNode.rows.length;e++)t.push(this._rootNode.rows[e]);return t},_assertIsItem:function(t){if(!this.isItem(t))throw new Error("dojo.data.HtmlTableStore: a function was passed an item argument that was not an item")},_assertIsAttribute:function(e){if("string"!=typeof e)throw new Error("dojo.data.HtmlTableStore: a function was passed an attribute argument that was not an attribute name string");return t.indexOf(this._headings,e)},getValue:function(t,e,o){var r=this.getValues(t,e);return r.length>0?r[0]:o},getValues:function(t,e){this._assertIsItem(t);var o=this._assertIsAttribute(e);return o>-1?[dojox.data.dom.textContent(t.cells[o])]:[]},getAttributes:function(t){this._assertIsItem(t);for(var e=[],o=0;o<this._headings.length;o++)this.hasAttribute(t,this._headings[o])&&e.push(this._headings[o]);return e},hasAttribute:function(t,e){return this.getValues(t,e).length>0},containsValue:function(e,o,r){var i=void 0;return"string"==typeof r&&(i=t.data.util.filter.patternToRegExp(r,!1)),this._containsValue(e,o,r,i)},_containsValue:function(t,e,o,r){for(var i=this.getValues(t,e),s=0;s<i.length;++s){var n=i[s];if("string"==typeof n&&r)return null!==n.match(r);if(o===n)return!0}return!1},isItem:function(t){return t&&t.store&&t.store===this?!0:!1},isItemLoaded:function(t){return this.isItem(t)},loadItem:function(t){this._assertIsItem(t.item)},_fetchItems:function(e,o,r){if(this._rootNode)this._finishFetchItems(e,o,r);else if(this.url){var i={url:this.url,handleAs:"text"},s=this,n=t.xhrGet(i);n.addCallback(function(t){var i=function(t,e){if(t.id==e)return t;if(t.childNodes)for(var o=0;o<t.childNodes.length;o++){var r=i(t.childNodes[o],e);if(r)return r}return null},n=document.createElement("div");n.innerHTML=t,s._rootNode=i(n,s.tableId),s._getHeadings.call(s);for(var a=0;a<s._rootNode.rows.length;a++)s._rootNode.rows[a].store=s;s._finishFetchItems(e,o,r)}),n.addErrback(function(t){r(t,e)})}else{this._rootNode=t.byId(this.tableId),this._getHeadings();for(var a=0;a<this._rootNode.rows.length;a++)this._rootNode.rows[a].store=this}},_finishFetchItems:function(e,o){var r=null,i=this._getAllItems();if(e.query){var s=e.queryOptions?e.queryOptions.ignoreCase:!1;r=[];var n={};for(var a in e.query){var d=e.query[a]+"";"string"==typeof d&&(n[a]=t.data.util.filter.patternToRegExp(d,s))}for(var l=0;l<i.length;++l){var u=!0,h=i[l];for(var a in e.query){var d=e.query[a]+"";this._containsValue(h,a,d,n[a])||(u=!1)}u&&r.push(h)}o(r,e)}else i.length>0&&(r=i.slice(0,i.length)),o(r,e)},getFeatures:function(){return{"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0}},close:function(){},getLabel:function(t){return this.isItem(t)?"Table Row #"+this.getIdentity(t):void 0},getLabelAttributes:function(){return null},getIdentity:function(e){return this._assertIsItem(e),t.isOpera?t.indexOf(this._rootNode.rows,e)-1:e.sectionRowIndex},getIdentityAttributes:function(){return null},fetchItemByIdentity:function(e){var o=e.identity,r=this,i=null;if(this._rootNode){if(this._rootNode.rows[o+1]&&(i=this._rootNode.rows[o+1],e.onItem)){var s=e.scope?e.scope:t.global;e.onItem.call(s,i)}}else if(this.url){var n={url:this.url,handleAs:"text"},r=this,a=t.xhrGet(n);a.addCallback(function(s){var n=function(t,e){if(t.id==e)return t;if(t.childNodes)for(var o=0;o<t.childNodes.length;o++){var r=n(t.childNodes[o],e);if(r)return r}return null},a=document.createElement("div");a.innerHTML=s,r._rootNode=n(a,r.tableId),r._getHeadings.call(r);for(var d=0;d<r._rootNode.rows.length;d++)r._rootNode.rows[d].store=r;if(i=r._rootNode.rows[o+1],e.onItem){var l=e.scope?e.scope:t.global;e.onItem.call(l,i)}}),a.addErrback(function(o){if(e.onError){var r=e.scope?e.scope:t.global;e.onError.call(r,o)}})}else{this._rootNode=t.byId(this.tableId),this._getHeadings();for(var d=0;d<this._rootNode.rows.length;d++)this._rootNode.rows[d].store=this;if(i=this._rootNode.rows[o+1],e.onItem){var s=e.scope?e.scope:t.global;e.onItem.call(s,i)}}}}),t.extend(dojox.data.HtmlTableStore,t.data.util.simpleFetch))}});