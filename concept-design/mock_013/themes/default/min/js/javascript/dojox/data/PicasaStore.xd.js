dojo._xdResourceLoaded({depends:[["provide","dojox.data.PicasaStore"],["require","dojo.data.util.simpleFetch"],["require","dojo.io.script"],["require","dojo.date.stamp"]],defineResource:function(t){t._hasResource["dojox.data.PicasaStore"]||(t._hasResource["dojox.data.PicasaStore"]=!0,t.provide("dojox.data.PicasaStore"),t.require("dojo.data.util.simpleFetch"),t.require("dojo.io.script"),t.require("dojo.date.stamp"),t.declare("dojox.data.PicasaStore",null,{constructor:function(t){t&&t.label&&(this.label=t.label)},_picasaUrl:"http://picasaweb.google.com/data/feed/api/all",_storeRef:"_S",label:"title",_assertIsItem:function(t){if(!this.isItem(t))throw new Error("dojox.data.PicasaStore: a function was passed an item argument that was not an item")},_assertIsAttribute:function(t){if("string"!=typeof t)throw new Error("dojox.data.PicasaStore: a function was passed an attribute argument that was not an attribute name string")},getFeatures:function(){return{"dojo.data.api.Read":!0}},getValue:function(t,e){var a=this.getValues(t,e);return a?a[0]:void 0},getAttributes:function(){return["id","published","updated","category","title$type","title","summary$type","summary","rights$type","rights","link","author","gphoto$id","gphoto$name","location"]},hasAttribute:function(t,e){return this.getValue(t,e)?!0:!1},isItemLoaded:function(t){return this.isItem(t)},loadItem:function(){},getLabel:function(t){return this.getValue(t,this.label)},getLabelAttributes:function(){return[this.label]},containsValue:function(t,e,a){for(var r=this.getValues(t,e),i=0;i<r.length;i++)if(r[i]===a)return!0;return!1},getValues:function(e,a){return this._assertIsItem(e),this._assertIsAttribute(a),"title"===a?[this._unescapeHtml(e.title)]:"author"===a?[this._unescapeHtml(e.author[0].name)]:"datePublished"===a?[t.date.stamp.fromISOString(e.published)]:"dateTaken"===a?[t.date.stamp.fromISOString(e.date_taken)]:"imageUrlSmall"===a?[e.media.thumbnail[1].url]:"imageUrl"===a?[e.content$src]:"imageUrlMedium"===a?[e.media.thumbnail[2].url]:"link"===a?[e.link[1]]:"tags"===a?e.tags.split(" "):"description"===a?[this._unescapeHtml(e.summary)]:void 0},isItem:function(t){return t&&t[this._storeRef]===this?!0:!1},close:function(){},_fetchItems:function(e,a,r){e.query||(e.query={});var i={alt:"jsonm",pp:"1",psc:"G"};i["start-index"]="1",e.query.start&&(i["start-index"]=e.query.start),e.query.tags&&(i.q=e.query.tags),e.query.userid&&(i.uname=e.query.userid),e.query.userids&&(i.ids=e.query.userids),e.query.lang&&(i.hl=e.query.lang),i["max-results"]=e.count?e.count:"20";var s=this,o=null,n=function(r){null!==o&&t.disconnect(o),a(s._processPicasaData(r),e)},u={url:this._picasaUrl,content:i,callbackParamName:"callback",handle:n},l=t.io.script.get(u);l.addErrback(function(a){t.disconnect(o),r(a,e)})},_processPicasaData:function(t){var e=[];if(t.feed){e=t.feed.entry;for(var a=0;a<e.length;a++){var r=e[a];r[this._storeRef]=this}}return e},_unescapeHtml:function(t){return t=t.replace(/&amp;/gm,"&").replace(/&lt;/gm,"<").replace(/&gt;/gm,">").replace(/&quot;/gm,'"'),t=t.replace(/&#39;/gm,"'")}}),t.extend(dojox.data.PicasaStore,t.data.util.simpleFetch))}});