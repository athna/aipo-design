dojo._hasResource["dojox.gfx.vml"]||(dojo._hasResource["dojox.gfx.vml"]=!0,dojo.provide("dojox.gfx.vml"),dojo.require("dojox.gfx._base"),dojo.require("dojox.gfx.shape"),dojo.require("dojox.gfx.path"),dojo.require("dojox.gfx.arc"),dojox.gfx.vml.xmlns="urn:schemas-microsoft-com:vml",dojox.gfx.vml.text_alignment={start:"left",middle:"center",end:"right"},dojox.gfx.vml._parseFloat=function(t){return t.match(/^\d+f$/i)?parseInt(t)/65536:parseFloat(t)},dojox.gfx.vml._bool={t:1,"true":1},dojo.extend(dojox.gfx.Shape,{setFill:function(t){if(!t)return this.fillStyle=null,this.rawNode.filled="f",this;if("object"==typeof t&&"type"in t){switch(t.type){case"linear":var e=dojox.gfx.makeParameters(dojox.gfx.defaultLinearGradient,t),o=[],r=e.colors,i=this._getRealMatrix(),s=dojox.gfx.matrix;this.fillStyle=e,dojo.forEach(r,function(t,e,o){o[e].color=dojox.gfx.normalizeColor(t.color)}),r[0].offset>0&&o.push("0 "+r[0].color.toHex());for(var a=0;a<r.length;++a)o.push(r[a].offset.toFixed(8)+" "+r[a].color.toHex());var a=r.length-1;r[a].offset<1&&o.push("1 "+r[a].color.toHex());var h=this.rawNode.fill;h.colors.value=o.join(";"),h.method="sigma",h.type="gradient";var n=i?s.multiplyPoint(i,e.x1,e.y1):{x:e.x1,y:e.y1},d=i?s.multiplyPoint(i,e.x2,e.y2):{x:e.x2,y:e.y2};h.angle=(s._radToDeg(Math.atan2(d.x-n.x,d.y-n.y))+180)%360,h.on=!0;break;case"radial":var e=dojox.gfx.makeParameters(dojox.gfx.defaultRadialGradient,t);this.fillStyle=e;var l=parseFloat(this.rawNode.style.left),x=parseFloat(this.rawNode.style.top),f=parseFloat(this.rawNode.style.width),g=parseFloat(this.rawNode.style.height),p=isNaN(f)?1:2*e.r/f,r=new Array(e.colors.length);dojo.forEach(e.colors,function(t,e){r[e]={offset:1-t.offset*p,color:dojox.gfx.normalizeColor(t.color)}});for(var a=r.length-1;a>=0&&r[a].offset<0;)--a;if(a<r.length-1){var u=r[a],c=r[a+1];for(c.color=dojo.blendColors(u.color,c.color,u.offset/(u.offset-c.offset)),c.offset=0;r.length-a>2;)r.pop()}var a=r.length-1,o=[];for(r[a].offset>0&&o.push("0 "+r[a].color.toHex());a>=0;--a)o.push(r[a].offset.toFixed(8)+" "+r[a].color.toHex());r[0].offset<1&&o.push("1 "+r[0].color.toHex());var h=this.rawNode.fill;h.colors.value=o.join(";"),h.method="sigma",h.type="gradientradial",h.focusposition=isNaN(f)||isNaN(g)||isNaN(l)||isNaN(x)?"0.5 0.5":((e.cx-l)/f).toFixed(8)+" "+((e.cy-x)/g).toFixed(8),h.focussize="0 0",h.on=!0;break;case"pattern":var e=dojox.gfx.makeParameters(dojox.gfx.defaultPattern,t);this.fillStyle=e;var h=this.rawNode.fill;h.type="tile",h.src=e.src,e.width&&e.height&&(h.size.x=dojox.gfx.px2pt(e.width),h.size.y=dojox.gfx.px2pt(e.height)),h.alignShape="f",h.position.x=0,h.position.y=0,h.origin.x=e.width?e.x/e.width:0,h.origin.y=e.height?e.y/e.height:0,h.on=!0}return this.rawNode.fill.opacity=1,this}return this.fillStyle=dojox.gfx.normalizeColor(t),this.rawNode.fillcolor=this.fillStyle.toHex(),this.rawNode.fill.opacity=this.fillStyle.a,this.rawNode.filled=!0,this},setStroke:function(t){if(!t)return this.strokeStyle=null,this.rawNode.stroked="f",this;"string"==typeof t&&(t={color:t});var e=this.strokeStyle=dojox.gfx.makeParameters(dojox.gfx.defaultStroke,t);e.color=dojox.gfx.normalizeColor(e.color);var o=this.rawNode;return o.stroked=!0,o.strokecolor=e.color.toCss(),o.strokeweight=e.width+"px",o.stroke&&(o.stroke.opacity=e.color.a,o.stroke.endcap=this._translate(this._capMap,e.cap),"number"==typeof e.join?(o.stroke.joinstyle="miter",o.stroke.miterlimit=e.join):o.stroke.joinstyle=e.join,o.stroke.dashstyle="none"==e.style?"Solid":e.style),this},_capMap:{butt:"flat"},_capMapReversed:{flat:"butt"},_translate:function(t,e){return e in t?t[e]:e},_applyTransform:function(){this.fillStyle&&"linear"==this.fillStyle.type&&this.setFill(this.fillStyle);var t=this._getRealMatrix();if(!t)return this;var e=this.rawNode.skew;if("undefined"==typeof e)for(var o=0;o<this.rawNode.childNodes.length;++o)if("skew"==this.rawNode.childNodes[o].tagName){e=this.rawNode.childNodes[o];break}if(e){e.on="f";var r=t.xx.toFixed(8)+" "+t.xy.toFixed(8)+" "+t.yx.toFixed(8)+" "+t.yy.toFixed(8)+" 0 0",i=Math.floor(t.dx).toFixed()+"px "+Math.floor(t.dy).toFixed()+"px",s=this.rawNode.style,a=parseFloat(s.left),h=parseFloat(s.top),n=parseFloat(s.width),d=parseFloat(s.height);isNaN(a)&&(a=0),isNaN(h)&&(h=0),isNaN(n)&&(n=1),isNaN(d)&&(d=1);var l=(-a/n-.5).toFixed(8)+" "+(-h/d-.5).toFixed(8);e.matrix=r,e.origin=l,e.offset=i,e.on=!0}return this},setRawNode:function(t){t.stroked="f",t.filled="f",this.rawNode=t},_moveToFront:function(){return this.rawNode.parentNode.appendChild(this.rawNode),this},_moveToBack:function(){var t=this.rawNode,e=t.parentNode,o=e.firstChild;return e.insertBefore(t,o),"rect"==o.tagName&&o.swapNode(t),this},_getRealMatrix:function(){return this.parentMatrix?new dojox.gfx.Matrix2D([this.parentMatrix,this.matrix]):this.matrix}}),dojo.declare("dojox.gfx.Group",dojox.gfx.Shape,{constructor:function(){dojox.gfx.vml.Container._init.call(this)},_applyTransform:function(){for(var t=this._getRealMatrix(),e=0;e<this.children.length;++e)this.children[e]._updateParentMatrix(t);return this}}),dojox.gfx.Group.nodeType="group",dojo.declare("dojox.gfx.Rect",dojox.gfx.shape.Rect,{setShape:function(t){var e=this.shape=dojox.gfx.makeParameters(this.shape,t);this.bbox=null;var o=this.rawNode.style;o.left=e.x.toFixed(),o.top=e.y.toFixed(),o.width="string"==typeof e.width&&e.width.indexOf("%")>=0?e.width:e.width.toFixed(),o.height="string"==typeof e.width&&e.height.indexOf("%")>=0?e.height:e.height.toFixed();var r=Math.min(1,e.r/Math.min(parseFloat(e.width),parseFloat(e.height))).toFixed(8),i=this.rawNode.parentNode,s=null;if(i){if(i.lastChild!=this.rawNode)for(var a=0;a<i.childNodes.length;++a)if(i.childNodes[a]==this.rawNode){s=i.childNodes[a+1];break}i.removeChild(this.rawNode)}return this.rawNode.arcsize=r,i&&(s?i.insertBefore(this.rawNode,s):i.appendChild(this.rawNode)),this.setTransform(this.matrix).setFill(this.fillStyle).setStroke(this.strokeStyle)}}),dojox.gfx.Rect.nodeType="roundrect",dojo.declare("dojox.gfx.Ellipse",dojox.gfx.shape.Ellipse,{setShape:function(t){var e=this.shape=dojox.gfx.makeParameters(this.shape,t);this.bbox=null;var o=this.rawNode.style;return o.left=(e.cx-e.rx).toFixed(),o.top=(e.cy-e.ry).toFixed(),o.width=(2*e.rx).toFixed(),o.height=(2*e.ry).toFixed(),this.setTransform(this.matrix)}}),dojox.gfx.Ellipse.nodeType="oval",dojo.declare("dojox.gfx.Circle",dojox.gfx.shape.Circle,{setShape:function(t){var e=this.shape=dojox.gfx.makeParameters(this.shape,t);this.bbox=null;var o=this.rawNode.style;return o.left=(e.cx-e.r).toFixed(),o.top=(e.cy-e.r).toFixed(),o.width=(2*e.r).toFixed(),o.height=(2*e.r).toFixed(),this}}),dojox.gfx.Circle.nodeType="oval",dojo.declare("dojox.gfx.Line",dojox.gfx.shape.Line,{constructor:function(t){t&&t.setAttribute("dojoGfxType","line")},setShape:function(t){var e=this.shape=dojox.gfx.makeParameters(this.shape,t);return this.bbox=null,this.rawNode.path.v="m"+e.x1.toFixed()+" "+e.y1.toFixed()+"l"+e.x2.toFixed()+" "+e.y2.toFixed()+"e",this.setTransform(this.matrix)}}),dojox.gfx.Line.nodeType="shape",dojo.declare("dojox.gfx.Polyline",dojox.gfx.shape.Polyline,{constructor:function(t){t&&t.setAttribute("dojoGfxType","polyline")},setShape:function(t,e){t&&t instanceof Array?(this.shape=dojox.gfx.makeParameters(this.shape,{points:t}),e&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):this.shape=dojox.gfx.makeParameters(this.shape,t),this.bbox=null;var o=[],r=this.shape.points;if(r.length>0){o.push("m");var i=1;if("number"==typeof r[0]?(o.push(r[0].toFixed()),o.push(r[1].toFixed()),i=2):(o.push(r[0].x.toFixed()),o.push(r[0].y.toFixed())),r.length>i){o.push("l");for(var s=i;s<r.length;++s)"number"==typeof r[s]?o.push(r[s].toFixed()):(o.push(r[s].x.toFixed()),o.push(r[s].y.toFixed()))}}return o.push("e"),this.rawNode.path.v=o.join(" "),this.setTransform(this.matrix)}}),dojox.gfx.Polyline.nodeType="shape",dojo.declare("dojox.gfx.Image",dojox.gfx.shape.Image,{constructor:function(t){t&&t.setAttribute("dojoGfxType","image")},getEventSource:function(){return this.rawNode?this.rawNode.firstChild:null},setShape:function(t){var e=this.shape=dojox.gfx.makeParameters(this.shape,t);this.bbox=null;var o=this.rawNode.firstChild;return o.src=e.src,(e.width||e.height)&&(o.style.width=e.width,o.style.height=e.height),this.setTransform(this.matrix)},_applyTransform:function(){var t=this._getRealMatrix();if(!t)return this;t=dojox.gfx.matrix.multiply(t,{dx:this.shape.x,dy:this.shape.y});var e=this.rawNode.filters["DXImageTransform.Microsoft.Matrix"];return e.M11=t.xx,e.M12=t.xy,e.M21=t.yx,e.M22=t.yy,e.Dx=t.dx,e.Dy=t.dy,this}}),dojox.gfx.Image.nodeType="div",dojo.declare("dojox.gfx.Text",dojox.gfx.shape.Text,{constructor:function(t){t&&t.setAttribute("dojoGfxType","text"),this.fontStyle=null},_alignment:{start:"left",middle:"center",end:"right"},setShape:function(t){this.shape=dojox.gfx.makeParameters(this.shape,t),this.bbox=null;var e=this.rawNode,o=this.shape,r=o.x,i=o.y.toFixed();switch(o.align){case"middle":r-=5;break;case"end":r-=10}this.rawNode.path.v="m"+r.toFixed()+","+i+"l"+(r+10).toFixed()+","+i+"e";for(var s=null,a=null,h=e.childNodes,n=0;n<h.length;++n){var d=h[n].tagName;if("path"==d){if(s=h[n],a)break}else if("textpath"==d&&(a=h[n],s))break}s||(s=this.rawNode.ownerDocument.createElement("v:path"),e.appendChild(s)),a||(a=this.rawNode.ownerDocument.createElement("v:textpath"),e.appendChild(a)),s.textPathOk=!0,a.on=!0;var l=dojox.gfx.vml.text_alignment[o.align];return a.style["v-text-align"]=l?l:"left",a.style["text-decoration"]=o.decoration,a.style["v-rotate-letters"]=o.rotated,a.style["v-text-kern"]=o.kerning,a.string=o.text,this.setTransform(this.matrix)},_setFont:function(){for(var t=this.fontStyle,e=this.rawNode.childNodes,o=0;o<e.length;++o)if("textpath"==e[o].tagName){e[o].style.font=dojox.gfx.makeFontString(t);break}this.setTransform(this.matrix)},_getRealMatrix:function(){var t=dojox.gfx.Shape.prototype._getRealMatrix.call(this);return t&&(t=dojox.gfx.matrix.multiply(t,{dy:.35*-dojox.gfx.normalizedLength(this.fontStyle?this.fontStyle.size:"10pt")})),t},getTextWidth:function(){var t=this.rawNode,e=t.style.display;t.style.display="inline";var o=dojox.gfx.pt2px(parseFloat(t.currentStyle.width));return t.style.display=e,o}}),dojox.gfx.Text.nodeType="shape",dojox.gfx.path._calcArc=function(t){var e=Math.cos(t),o=Math.sin(t),r={x:e+4/3*(1-e),y:o-4/3*e*(1-e)/o};return{s:{x:e,y:-o},c1:{x:r.x,y:-r.y},c2:r,e:{x:e,y:o}}},dojo.declare("dojox.gfx.Path",dojox.gfx.path.Path,{constructor:function(t){t&&!t.getAttribute("dojoGfxType")&&t.setAttribute("dojoGfxType","path"),this.vmlPath="",this.lastControl={}},_updateWithSegment:function(t){var e=dojo.clone(this.last);dojox.gfx.Path.superclass._updateWithSegment.apply(this,arguments);var o=this[this.renderers[t.action]](t,e);"string"==typeof this.vmlPath?(this.vmlPath+=o.join(""),this.rawNode.path.v=this.vmlPath+" r0,0 e"):this.vmlPath=this.vmlPath.concat(o)},setShape:function(){return this.vmlPath=[],this.lastControl={},dojox.gfx.Path.superclass.setShape.apply(this,arguments),this.vmlPath=this.vmlPath.join(""),this.rawNode.path.v=this.vmlPath+" r0,0 e",this},_pathVmlToSvgMap:{m:"M",l:"L",t:"m",r:"l",c:"C",v:"c",qb:"Q",x:"z",e:""},renderers:{M:"_moveToA",m:"_moveToR",L:"_lineToA",l:"_lineToR",H:"_hLineToA",h:"_hLineToR",V:"_vLineToA",v:"_vLineToR",C:"_curveToA",c:"_curveToR",S:"_smoothCurveToA",s:"_smoothCurveToR",Q:"_qCurveToA",q:"_qCurveToR",T:"_qSmoothCurveToA",t:"_qSmoothCurveToR",A:"_arcTo",a:"_arcTo",Z:"_closePath",z:"_closePath"},_addArgs:function(t,e,o,r){"undefined"==typeof r&&(r=e.length),"undefined"==typeof o&&(o=0);for(var i=o;r>i;++i)t.push(" "),t.push(e[i].toFixed())},_addArgsAdjusted:function(t,e,o,r,i){"undefined"==typeof i&&(i=o.length),"undefined"==typeof r&&(r=0);for(var s=r;i>s;s+=2)t.push(" "),t.push((e.x+o[s]).toFixed()),t.push(" "),t.push((e.y+o[s+1]).toFixed())},_moveToA:function(t){var e=[" m"],o=t.args,r=o.length;return 2==r?this._addArgs(e,o):(this._addArgs(e,o,0,2),e.push(" l"),this._addArgs(e,o,2)),this.lastControl={},e},_moveToR:function(t,e){var o=["x"in e?" t":" m"],r=t.args,i=r.length;return 2==i?this._addArgs(o,r):(this._addArgs(o,r,0,2),o.push(" r"),this._addArgs(o,r,2)),this.lastControl={},o},_lineToA:function(t){var e=[" l"];return this._addArgs(e,t.args),this.lastControl={},e},_lineToR:function(t){var e=[" r"];return this._addArgs(e,t.args),this.lastControl={},e},_hLineToA:function(t,e){for(var o=[" l"],r=t.args,i=r.length,s=" "+e.y.toFixed(),a=0;i>a;++a)o.push(" "),o.push(r[a].toFixed()),o.push(s);return this.lastControl={},o},_hLineToR:function(t){for(var e=[" r"],o=t.args,r=o.length,i=0;r>i;++i)e.push(" "),e.push(o[i].toFixed()),e.push(" 0");return this.lastControl={},e},_vLineToA:function(t,e){for(var o=[" l"],r=t.args,i=r.length,s=" "+e.x.toFixed(),a=0;i>a;++a)o.push(s),o.push(" "),o.push(r[a].toFixed());return this.lastControl={},o},_vLineToR:function(t){for(var e=[" r"],o=t.args,r=o.length,i=0;r>i;++i)e.push(" 0 "),e.push(o[i].toFixed());return this.lastControl={},e},_curveToA:function(t){for(var e=[],o=t.args,r=o.length,i=0;r>i;i+=6)e.push(" c"),this._addArgs(e,o,i,i+6);return this.lastControl={x:o[r-4],y:o[r-3],type:"C"},e},_curveToR:function(t,e){for(var o=[],r=t.args,i=r.length,s=0;i>s;s+=6)o.push(" v"),this._addArgs(o,r,s,s+6),this.lastControl={x:e.x+r[s+2],y:e.y+r[s+3]},e.x+=r[s+4],e.y+=r[s+5];return this.lastControl.type="C",o},_smoothCurveToA:function(t,e){for(var o=[],r=t.args,i=r.length,s=0;i>s;s+=4)o.push(" c"),"C"==this.lastControl.type?this._addArgs(o,[2*e.x-this.lastControl.x,2*e.y-this.lastControl.y]):this._addArgs(o,[e.x,e.y]),this._addArgs(o,r,s,s+4);return this.lastControl={x:r[i-4],y:r[i-3],type:"C"},o},_smoothCurveToR:function(t,e){for(var o=[],r=t.args,i=r.length,s=0;i>s;s+=4)o.push(" v"),"C"==this.lastControl.type?this._addArgs(o,[e.x-this.lastControl.x,e.y-this.lastControl.y]):this._addArgs(o,[0,0]),this._addArgs(o,r,s,s+4),this.lastControl={x:e.x+r[s],y:e.y+r[s+1]},e.x+=r[s+2],e.y+=r[s+3];return this.lastControl.type="C",o},_qCurveToA:function(t){for(var e=[],o=t.args,r=o.length,i=0;r>i;i+=4)e.push(" qb"),this._addArgs(e,o,i,i+4);return this.lastControl={x:o[r-4],y:o[r-3],type:"Q"},e},_qCurveToR:function(t,e){for(var o=[],r=t.args,i=r.length,s=0;i>s;s+=4)o.push(" qb"),this._addArgsAdjusted(o,e,r,s,s+4),this.lastControl={x:e.x+r[s],y:e.y+r[s+1]},e.x+=r[s+2],e.y+=r[s+3];return this.lastControl.type="Q",o},_qSmoothCurveToA:function(t,e){for(var o=[],r=t.args,i=r.length,s=0;i>s;s+=2)o.push(" qb"),"Q"==this.lastControl.type?this._addArgs(o,[this.lastControl.x=2*e.x-this.lastControl.x,this.lastControl.y=2*e.y-this.lastControl.y]):this._addArgs(o,[this.lastControl.x=e.x,this.lastControl.y=e.y]),this._addArgs(o,r,s,s+2);return this.lastControl.type="Q",o},_qSmoothCurveToR:function(t,e){for(var o=[],r=t.args,i=r.length,s=0;i>s;s+=2)o.push(" qb"),"Q"==this.lastControl.type?this._addArgs(o,[this.lastControl.x=2*e.x-this.lastControl.x,this.lastControl.y=2*e.y-this.lastControl.y]):this._addArgs(o,[this.lastControl.x=e.x,this.lastControl.y=e.y]),this._addArgsAdjusted(o,e,r,s,s+2);return this.lastControl.type="Q",o},_arcTo:function(t,e){for(var o=[],r=t.args,i=r.length,s="a"==t.action,a=0;i>a;a+=7){var h=r[a+5],n=r[a+6];s&&(h+=e.x,n+=e.y);for(var d=dojox.gfx.arc.arcAsBezier(e,r[a],r[a+1],r[a+2],r[a+3]?1:0,r[a+4]?1:0,h,n),l=0;l<d.length;++l)o.push(" c"),this._addArgs(o,d[l]);e={x:h,y:n}}return this.lastControl={},o},_closePath:function(){return this.lastControl={},["x"]}}),dojox.gfx.Path.nodeType="shape",dojo.declare("dojox.gfx.TextPath",dojox.gfx.Path,{constructor:function(t){t&&t.setAttribute("dojoGfxType","textpath"),this.fontStyle=null,"text"in this||(this.text=dojo.clone(dojox.gfx.defaultTextPath)),"fontStyle"in this||(this.fontStyle=dojo.clone(dojox.gfx.defaultFont))},setText:function(t){return this.text=dojox.gfx.makeParameters(this.text,"string"==typeof t?{text:t}:t),this._setText(),this},setFont:function(t){return this.fontStyle="string"==typeof t?dojox.gfx.splitFontString(t):dojox.gfx.makeParameters(dojox.gfx.defaultFont,t),this._setFont(),this},_setText:function(){this.bbox=null;for(var t=this.rawNode,e=this.text,o=null,r=null,i=t.childNodes,s=0;s<i.length;++s){var a=i[s].tagName;if("path"==a){if(o=i[s],r)break}else if("textpath"==a&&(r=i[s],o))break}o||(o=this.rawNode.ownerDocument.createElement("v:path"),t.appendChild(o)),r||(r=this.rawNode.ownerDocument.createElement("v:textpath"),t.appendChild(r)),o.textPathOk=!0,r.on=!0;var h=dojox.gfx.vml.text_alignment[e.align];r.style["v-text-align"]=h?h:"left",r.style["text-decoration"]=e.decoration,r.style["v-rotate-letters"]=e.rotated,r.style["v-text-kern"]=e.kerning,r.string=e.text},_setFont:function(){for(var t=this.fontStyle,e=this.rawNode.childNodes,o=0;o<e.length;++o)if("textpath"==e[o].tagName){e[o].style.font=dojox.gfx.makeFontString(t);break}}}),dojox.gfx.TextPath.nodeType="shape",dojo.declare("dojox.gfx.Surface",dojox.gfx.shape.Surface,{constructor:function(){dojox.gfx.vml.Container._init.call(this)},setDimensions:function(t,e){if(this.width=dojox.gfx.normalizedLength(t),this.height=dojox.gfx.normalizedLength(e),!this.rawNode)return this;var o=this.clipNode.style,r=this.rawNode,i=r.style,s=this.bgNode.style;return o.width=t,o.height=e,o.clip="rect(0 "+t+" "+e+" 0)",i.width=t,i.height=e,r.coordsize=t+" "+e,s.width=t,s.height=e,this},getDimensions:function(){var t=this.rawNode?{width:dojox.gfx.normalizedLength(this.rawNode.style.width),height:dojox.gfx.normalizedLength(this.rawNode.style.height)}:null;return t.width<=0&&(t.width=this.width),t.height<=0&&(t.height=this.height),t}}),dojox.gfx.createSurface=function(t,e,o){e||(e="100%"),o||(o="100%");var r=new dojox.gfx.Surface,i=dojo.byId(t),s=r.clipNode=i.ownerDocument.createElement("div"),a=r.rawNode=i.ownerDocument.createElement("v:group"),h=s.style,n=a.style;i.style.width=e,i.style.height=o,h.width=e,h.height=o,h.clip="rect(0 "+e+" "+o+" 0)",h.position="absolute",n.width=e,n.height=o,a.coordsize=("100%"==e?e:parseFloat(e))+" "+("100%"==o?o:parseFloat(o)),a.coordorigin="0 0";var d=r.bgNode=a.ownerDocument.createElement("v:rect"),l=d.style;return l.left=l.top=0,l.width=n.width,l.height=n.height,d.filled=d.stroked="f",a.appendChild(d),s.appendChild(a),i.appendChild(s),r.width=dojox.gfx.normalizedLength(e),r.height=dojox.gfx.normalizedLength(o),r},dojox.gfx.vml.Container={_init:function(){dojox.gfx.shape.Container._init.call(this)},add:function(t){return this!=t.getParent()&&(this.rawNode.appendChild(t.rawNode),dojox.gfx.shape.Container.add.apply(this,arguments)),this},remove:function(t){return this==t.getParent()&&(this.rawNode==t.rawNode.parentNode&&this.rawNode.removeChild(t.rawNode),dojox.gfx.shape.Container.remove.apply(this,arguments)),this},clear:function(){for(var t=this.rawNode;t.firstChild!=t.lastChild;)t.firstChild!=this.bgNode&&t.removeChild(t.firstChild),t.lastChild!=this.bgNode&&t.removeChild(t.lastChild);return dojox.gfx.shape.Container.clear.apply(this,arguments)},_moveChildToFront:dojox.gfx.shape.Container._moveChildToFront,_moveChildToBack:dojox.gfx.shape.Container._moveChildToBack},dojo.mixin(dojox.gfx.shape.Creator,{createGroup:function(){var t=this.createObject(dojox.gfx.Group,null),e=t.rawNode.ownerDocument.createElement("v:rect");return e.style.left=e.style.top=0,e.style.width=t.rawNode.style.width,e.style.height=t.rawNode.style.height,e.filled=e.stroked="f",t.rawNode.appendChild(e),t.bgNode=e,t},createImage:function(t){if(!this.rawNode)return null;var e=new dojox.gfx.Image,o=this.rawNode.ownerDocument.createElement("div");o.style.position="absolute",o.style.width=this.rawNode.style.width,o.style.height=this.rawNode.style.height,o.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11=1, M12=0, M21=0, M22=1, Dx=0, Dy=0)";var r=this.rawNode.ownerDocument.createElement("img");return o.appendChild(r),e.setRawNode(o),this.rawNode.appendChild(o),e.setShape(t),this.add(e),e},createObject:function(t,e){if(!this.rawNode)return null;var o=new t,r=this.rawNode.ownerDocument.createElement("v:"+t.nodeType);switch(o.setRawNode(r),this.rawNode.appendChild(r),t){case dojox.gfx.Group:case dojox.gfx.Line:case dojox.gfx.Polyline:case dojox.gfx.Text:case dojox.gfx.Path:case dojox.gfx.TextPath:this._overrideSize(r)}return o.setShape(e),this.add(o),o},_overrideSize:function(t){for(var e=this;e&&!(e instanceof dojox.gfx.Surface);e=e.parent);t.style.width=e.width,t.style.height=e.height,t.coordsize=e.width+" "+e.height}}),dojo.extend(dojox.gfx.Group,dojox.gfx.vml.Container),dojo.extend(dojox.gfx.Group,dojox.gfx.shape.Creator),dojo.extend(dojox.gfx.Surface,dojox.gfx.vml.Container),dojo.extend(dojox.gfx.Surface,dojox.gfx.shape.Creator));