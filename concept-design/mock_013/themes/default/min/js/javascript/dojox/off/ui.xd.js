dojo._xdResourceLoaded({depends:[["provide","dojox.off.ui"],["require","dojox.storage.Provider"],["require","dojox.storage.manager"],["require","dojox.storage.GearsStorageProvider"]],defineResource:function(e){e._hasResource["dojox.off.ui"]||(e._hasResource["dojox.off.ui"]=!0,e.provide("dojox.off.ui"),e.require("dojox.storage.Provider"),e.require("dojox.storage.manager"),e.require("dojox.storage.GearsStorageProvider"),e.mixin(dojox.off.ui,{appName:"setme",autoEmbed:!0,autoEmbedID:"dot-widget",runLink:window.location.href,runLinkTitle:"Run Application",learnHowPath:e.moduleUrl("dojox","off/resources/learnhow.html"),customLearnHowPath:!1,htmlTemplatePath:e.moduleUrl("dojox","off/resources/offline-widget.html").uri,cssTemplatePath:e.moduleUrl("dojox","off/resources/offline-widget.css").uri,onlineImagePath:e.moduleUrl("dojox","off/resources/greenball.png").uri,offlineImagePath:e.moduleUrl("dojox","off/resources/redball.png").uri,rollerImagePath:e.moduleUrl("dojox","off/resources/roller.gif").uri,checkmarkImagePath:e.moduleUrl("dojox","off/resources/checkmark.png").uri,learnHowJSPath:e.moduleUrl("dojox","off/resources/learnhow.js").uri,_initialized:!1,onLoad:function(){},_initialize:function(){return 0==this._validateAppName(this.appName)?(alert("You must set dojox.off.ui.appName; it can only contain letters, numbers, and spaces; right now it is incorrectly set to '"+dojox.off.ui.appName+"'"),dojox.off.enabled=!1,void 0):(this.runLinkText="Run "+this.appName,e.connect(dojox.off,"onNetwork",this,"_onNetwork"),e.connect(dojox.off.sync,"onSync",this,"_onSync"),dojox.off.files.cache([this.htmlTemplatePath,this.cssTemplatePath,this.onlineImagePath,this.offlineImagePath,this.rollerImagePath,this.checkmarkImagePath]),this.autoEmbed&&this._doAutoEmbed(),void 0)},_doAutoEmbed:function(){e.xhrGet({url:this.htmlTemplatePath,handleAs:"text",error:function(e){dojox.off.enabled=!1,e=e.message||e,alert("Error loading the Dojo Offline Widget from "+this.htmlTemplatePath+": "+e)},load:e.hitch(this,this._templateLoaded)})},_templateLoaded:function(o){var t=e.byId(this.autoEmbedID);if(t&&(t.innerHTML=o),this._initImages(),this._updateNetIndicator(),this._initLearnHow(),this._initialized=!0,!dojox.off.hasOfflineCache)return this._showNeedsOfflineCache(),void 0;if(dojox.off.hasOfflineCache&&dojox.off.browserRestart)return this._needsBrowserRestart(),void 0;var n=e.byId("dot-widget-browser-restart");n&&(n.style.display="none"),this._updateSyncUI(),this._initMainEvtHandlers(),this._setOfflineEnabled(dojox.off.enabled),this._onNetwork(dojox.off.isOnline?"online":"offline"),this._testNet()},_testNet:function(){dojox.off.goOnline(e.hitch(this,function(e){this._onNetwork(e?"online":"offline"),this.onLoad()}))},_updateNetIndicator:function(){var o=e.byId("dot-widget-network-indicator-online"),t=e.byId("dot-widget-network-indicator-offline"),n=e.byId("dot-widget-title-text");o&&t&&(1==dojox.off.isOnline?(o.style.display="inline",t.style.display="none"):(o.style.display="none",t.style.display="inline")),n&&(n.innerHTML=dojox.off.isOnline?"Online":"Offline")},_initLearnHow:function(){var o=e.byId("dot-widget-learn-how-link");if(o){if(!this.customLearnHowPath){var t=djConfig.baseRelativePath;this.learnHowPath+="?appName="+encodeURIComponent(this.appName)+"&hasOfflineCache="+dojox.off.hasOfflineCache+"&runLink="+encodeURIComponent(this.runLink)+"&runLinkText="+encodeURIComponent(this.runLinkText)+"&baseRelativePath="+encodeURIComponent(t),dojox.off.files.cache(this.learnHowJSPath),dojox.off.files.cache(this.learnHowPath)}o.setAttribute("href",this.learnHowPath);var n=e.byId("dot-widget-learn-how-app-name");n&&(n.innerHTML="",n.appendChild(document.createTextNode(this.appName)))}},_validateAppName:function(e){return e?/^[a-z0-9 ]*$/i.test(e):!1},_updateSyncUI:function(){var o=e.byId("dot-roller"),t=e.byId("dot-success-checkmark"),n=e.byId("dot-sync-messages"),i=e.byId("dot-sync-details"),s=e.byId("dot-sync-cancel");dojox.off.sync.isSyncing?(this._clearSyncMessage(),o&&(o.style.display="inline"),t&&(t.style.display="none"),n&&e.removeClass(n,"dot-sync-error"),i&&(i.style.display="none"),s&&(s.style.display="inline")):(o&&(o.style.display="none"),s&&(s.style.display="none"),n&&e.removeClass(n,"dot-sync-error"))},_setSyncMessage:function(o){var t=e.byId("dot-sync-messages");if(t){for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}},_clearSyncMessage:function(){this._setSyncMessage("")},_initImages:function(){var o=e.byId("dot-widget-network-indicator-online");o&&o.setAttribute("src",this.onlineImagePath);var t=e.byId("dot-widget-network-indicator-offline");t&&t.setAttribute("src",this.offlineImagePath);var n=e.byId("dot-roller");n&&n.setAttribute("src",this.rollerImagePath);var i=e.byId("dot-success-checkmark");i&&i.setAttribute("src",this.checkmarkImagePath)},_showDetails:function(e){if(e.preventDefault(),e.stopPropagation(),dojox.off.sync.details.length){var o="";o+="<html><head><title>Sync Details</title><head><body>",o+="<h1>Sync Details</h1>\n",o+="<ul>\n";for(var t=0;t<dojox.off.sync.details.length;t++)o+="<li>",o+=dojox.off.sync.details[t],o+="</li>";o+="</ul>\n",o+="<a href='javascript:window.close()' style='text-align: right; padding-right: 2em;'>Close Window</a>\n",o+="</body></html>";var n="height=400,width=600,resizable=true,scrollbars=true,toolbar=no,menubar=no,location=no,directories=no,dependent=yes",i=window.open("","SyncDetails",n);if(!i)return alert("Please allow popup windows for this domain; can't display sync details window"),void 0;i.document.open(),i.document.write(o),i.document.close(),i.focus&&i.focus()}},_cancel:function(e){e.preventDefault(),e.stopPropagation(),dojox.off.sync.cancel()},_needsBrowserRestart:function(){var o=e.byId("dot-widget-browser-restart");o&&e.addClass(o,"dot-needs-browser-restart");var t=e.byId("dot-widget-browser-restart-app-name");t&&(t.innerHTML="",t.appendChild(document.createTextNode(this.appName)));var n=e.byId("dot-sync-status");n&&(n.style.display="none")},_showNeedsOfflineCache:function(){var o=e.byId("dot-widget-container");o&&e.addClass(o,"dot-needs-offline-cache")},_hideNeedsOfflineCache:function(){var o=e.byId("dot-widget-container");o&&e.removeClass(o,"dot-needs-offline-cache")},_initMainEvtHandlers:function(){var o=e.byId("dot-sync-details-button");o&&e.connect(o,"onclick",this,this._showDetails);var t=e.byId("dot-sync-cancel-button");t&&e.connect(t,"onclick",this,this._cancel)},_setOfflineEnabled:function(o){var t=[];t.push(e.byId("dot-sync-status"));for(var n=0;n<t.length;n++)t[n]&&(t[n].style.visibility=o?"visible":"hidden")},_syncFinished:function(){this._updateSyncUI();var o=e.byId("dot-success-checkmark"),t=e.byId("dot-sync-details");if(1==dojox.off.sync.successful)this._setSyncMessage("Sync Successful"),o&&(o.style.display="inline");else if(1==dojox.off.sync.cancelled)this._setSyncMessage("Sync Cancelled"),o&&(o.style.display="none");else{this._setSyncMessage("Sync Error");var n=e.byId("dot-sync-messages");n&&e.addClass(n,"dot-sync-error"),o&&(o.style.display="none")}dojox.off.sync.details.length&&t&&(t.style.display="inline")},_onFrameworkEvent:function(o,t){if("save"==o)t.status!=dojox.storage.FAILED||t.isCoreSave||(alert("Please increase the amount of local storage available to this application"),dojox.storage.hasSettingsUI()&&dojox.storage.showSettingsUI());else if("coreOperationFailed"==o)console.log("Application does not have permission to use Dojo Offline"),this._userInformed||(alert("This application will not work if Google Gears is not allowed to run"),this._userInformed=!0);else if("offlineCacheInstalled"==o){if(this._hideNeedsOfflineCache(),1==dojox.off.hasOfflineCache&&1==dojox.off.browserRestart)return this._needsBrowserRestart(),void 0;var n=e.byId("dot-widget-browser-restart");n&&(n.style.display="none"),this._updateSyncUI(),this._initMainEvtHandlers(),this._setOfflineEnabled(dojox.off.enabled),this._testNet()}},_onSync:function(o){switch(o){case"start":this._updateSyncUI();break;case"refreshFiles":this._setSyncMessage("Downloading UI...");break;case"upload":this._setSyncMessage("Uploading new data...");break;case"download":this._setSyncMessage("Downloading new data...");break;case"finished":this._syncFinished();break;case"cancel":this._setSyncMessage("Canceling Sync...");break;default:e.warn("Programming error: Unknown sync type in dojox.off.ui: "+o)}},_onNetwork:function(o){if(this._initialized)if(this._updateNetIndicator(),"offline"==o){this._setSyncMessage("You are working offline");var t=e.byId("dot-sync-details");t&&(t.style.display="none"),this._updateSyncUI()}else dojox.off.sync.autoSync&&window.setTimeout("dojox.off.sync.synchronize()",1e3)}}),e.connect(dojox.off,"onFrameworkEvent",dojox.off.ui,"_onFrameworkEvent"),e.connect(dojox.off,"onLoad",dojox.off.ui,dojox.off.ui._initialize))}});