dojo._xdResourceLoaded({depends:[["provide","dojox.storage.WhatWGStorageProvider"],["require","dojox.storage.Provider"],["require","dojox.storage.manager"]],defineResource:function(e){e._hasResource["dojox.storage.WhatWGStorageProvider"]||(e._hasResource["dojox.storage.WhatWGStorageProvider"]=!0,e.provide("dojox.storage.WhatWGStorageProvider"),e.require("dojox.storage.Provider"),e.require("dojox.storage.manager"),e.declare("dojox.storage.WhatWGStorageProvider",[dojox.storage.Provider],{initialized:!1,_domain:null,_available:null,_statusHandler:null,_allNamespaces:null,_storageEventListener:null,initialize:function(){1!=djConfig.disableWhatWGStorage&&(this._domain="localhost"==location.hostname?"localhost.localdomain":location.hostname,this.initialized=!0,dojox.storage.manager.loaded())},isAvailable:function(){try{{globalStorage["localhost"==location.hostname?"localhost.localdomain":location.hostname]}}catch(e){return this._available=!1,this._available}return this._available=!0,this._available},put:function(t,o,a,r){if(0==this.isValidKey(t))throw new Error("Invalid key given: "+t);r=r||this.DEFAULT_NAMESPACE,t=this.getFullKey(t,r),this._statusHandler=a,o=e.isString(o)?"string:"+o:e.toJson(o);var i=e.hitch(this,function(){window.removeEventListener("storage",i,!1),a&&a.call(null,this.SUCCESS,t)});window.addEventListener("storage",i,!1);try{var n=globalStorage[this._domain];n.setItem(t,o)}catch(s){this._statusHandler.call(null,this.FAILED,t,s.toString())}},get:function(t,o){if(0==this.isValidKey(t))throw new Error("Invalid key given: "+t);o=o||this.DEFAULT_NAMESPACE,t=this.getFullKey(t,o);var a=globalStorage[this._domain],r=a.getItem(t);return null==r||""==r?null:(r=r.value,r=e.isString(r)&&/^string:/.test(r)?r.substring("string:".length):e.fromJson(r))},getNamespaces:function(){for(var e=[this.DEFAULT_NAMESPACE],t={},o=globalStorage[this._domain],a=/^__([^_]*)_/,r=0;r<o.length;r++){var i=o.key(r);if(1==a.test(i)){var n=i.match(a)[1];"undefined"==typeof t[n]&&(t[n]=!0,e.push(n))}}return e},getKeys:function(e){if(e=e||this.DEFAULT_NAMESPACE,0==this.isValidKey(e))throw new Error("Invalid namespace given: "+e);var t;t=e==this.DEFAULT_NAMESPACE?new RegExp("^([^_]{2}.*)$"):new RegExp("^__"+e+"_(.*)$");for(var o=globalStorage[this._domain],a=[],r=0;r<o.length;r++){var i=o.key(r);1==t.test(i)&&(i=i.match(t)[1],a.push(i))}return a},clear:function(t){if(t=t||this.DEFAULT_NAMESPACE,0==this.isValidKey(t))throw new Error("Invalid namespace given: "+t);var o;o=t==this.DEFAULT_NAMESPACE?new RegExp("^[^_]{2}"):new RegExp("^__"+t+"_");for(var a=globalStorage[this._domain],r=[],i=0;i<a.length;i++)1==o.test(a.key(i))&&(r[r.length]=a.key(i));e.forEach(r,e.hitch(a,"removeItem"))},remove:function(e,t){e=this.getFullKey(e,t);var o=globalStorage[this._domain];o.removeItem(e)},isPermanent:function(){return!0},getMaximumSize:function(){return this.SIZE_NO_LIMIT},hasSettingsUI:function(){return!1},showSettingsUI:function(){throw new Error(this.declaredClass+" does not support a storage settings user-interface")},hideSettingsUI:function(){throw new Error(this.declaredClass+" does not support a storage settings user-interface")},getFullKey:function(e,t){if(t=t||this.DEFAULT_NAMESPACE,0==this.isValidKey(t))throw new Error("Invalid namespace given: "+t);return t==this.DEFAULT_NAMESPACE?e:"__"+t+"_"+e}}),dojox.storage.manager.register("dojox.storage.WhatWGStorageProvider",new dojox.storage.WhatWGStorageProvider))}});