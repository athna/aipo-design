dojo._hasResource["dojox.charting.Chart2D"]||(dojo._hasResource["dojox.charting.Chart2D"]=!0,dojo.provide("dojox.charting.Chart2D"),dojo.require("dojox.gfx"),dojo.require("dojox.lang.functional"),dojo.require("dojox.charting.Theme"),dojo.require("dojox.charting.Series"),dojo.require("dojox.charting.axis2d.Default"),dojo.require("dojox.charting.plot2d.Default"),dojo.require("dojox.charting.plot2d.Lines"),dojo.require("dojox.charting.plot2d.Areas"),dojo.require("dojox.charting.plot2d.Markers"),dojo.require("dojox.charting.plot2d.MarkersOnly"),dojo.require("dojox.charting.plot2d.Scatter"),dojo.require("dojox.charting.plot2d.Stacked"),dojo.require("dojox.charting.plot2d.StackedLines"),dojo.require("dojox.charting.plot2d.StackedAreas"),dojo.require("dojox.charting.plot2d.Columns"),dojo.require("dojox.charting.plot2d.StackedColumns"),dojo.require("dojox.charting.plot2d.ClusteredColumns"),dojo.require("dojox.charting.plot2d.Bars"),dojo.require("dojox.charting.plot2d.StackedBars"),dojo.require("dojox.charting.plot2d.ClusteredBars"),dojo.require("dojox.charting.plot2d.Grid"),dojo.require("dojox.charting.plot2d.Pie"),function(){var t=dojox.lang.functional,i=dojox.charting,s=t.lambda("item.clear()"),e=t.lambda("item.purgeGroup()"),o=t.lambda("item.destroy()"),r=t.lambda("item.dirty = false"),h=t.lambda("item.dirty = true");dojo.declare("dojox.charting.Chart2D",null,{constructor:function(t,i){i||(i={}),this.margins=i.margins?i.margins:{l:10,t:10,r:10,b:10},this.stroke=i.stroke,this.fill=i.fill,this.theme=null,this.axes={},this.stack=[],this.plots={},this.series=[],this.runs={},this.dirty=!0,this.coords=null,this.node=dojo.byId(t);var s=dojo.marginBox(t);this.surface=dojox.gfx.createSurface(this.node,s.w,s.h)},destroy:function(){dojo.forEach(this.series,o),dojo.forEach(this.stack,o),t.forIn(this.axes,o)},getCoords:function(){return this.coords||(this.coords=dojo.coords(this.node,!0)),this.coords},setTheme:function(t){return this.theme=t,this.dirty=!0,this},addAxis:function(t,s){var e;return e=s&&"type"in s?"string"==typeof s.type?new i.axis2d[s.type](this,s):new s.type(this,s):new i.axis2d.Default(this,s),e.name=t,e.dirty=!0,t in this.axes&&this.axes[t].destroy(),this.axes[t]=e,this.dirty=!0,this},addPlot:function(t,s){var e;return e=s&&"type"in s?"string"==typeof s.type?new i.plot2d[s.type](this,s):new s.type(this,s):new i.plot2d.Default(this,s),e.name=t,e.dirty=!0,t in this.plots?(this.stack[this.plots[t]].destroy(),this.stack[this.plots[t]]=e):(this.plots[t]=this.stack.length,this.stack.push(e)),this.dirty=!0,this},addSeries:function(t,s,e){var o=new i.Series(this,s,e);return t in this.runs?(this.series[this.runs[t]].destroy(),this.series[this.runs[t]]=o):(this.runs[t]=this.series.length,this.series.push(o)),this.dirty=!0,!("ymin"in o)&&"min"in o&&(o.ymin=o.min),!("ymax"in o)&&"max"in o&&(o.ymax=o.max),this},updateSeries:function(t,i){if(t in this.runs){var s,e=this.series[this.runs[t]],o=this.stack[this.plots[e.plot]];e.data=i,e.dirty=!0,o.hAxis?(s=this.axes[o.hAxis],s.dependOnData()&&(s.dirty=!0,dojo.forEach(this.stack,function(t){t.hAxis&&t.hAxis==o.hAxis&&(t.dirty=!0)}))):o.dirty=!0,o.vAxis?(s=this.axes[o.vAxis],s.dependOnData()&&(s.dirty=!0,dojo.forEach(this.stack,function(t){t.vAxis&&t.vAxis==o.vAxis&&(t.dirty=!0)}))):o.dirty=!0}return this},resize:function(t,i){var s;switch(arguments.length){case 0:s=dojo.marginBox(this.node);break;case 1:s=t;break;default:s={w:t,h:i}}return dojo.marginBox(this.node,s),this.surface.setDimensions(s.w,s.h),this.dirty=!0,this.coords=null,this.render()},render:function(){return this.dirty?this.fullRender():(dojo.forEach(this.stack,function(t){(t.dirty||t.hAxis&&this.axes[t.hAxis].dirty||t.vAxis&&this.axes[t.vAxis].dirty)&&t.calculateAxes(this.plotArea)},this),t.forEachReversed(this.stack,function(t){t.render(this.dim,this.offsets)},this),t.forIn(this.axes,function(t){t.render(this.dim,this.offsets)},this),this._makeClean(),this.surface.render&&this.surface.render(),this)},fullRender:function(){this._makeDirty(),dojo.forEach(this.stack,s),dojo.forEach(this.series,e),t.forIn(this.axes,e),dojo.forEach(this.stack,e),this.surface.clear(),dojo.forEach(this.series,function(t){if(!(t.plot in this.plots)){var s=new i.plot2d.Default(this,{});s.name=t.plot,this.plots[t.plot]=this.stack.length,this.stack.push(s)}this.stack[this.plots[t.plot]].addSeries(t)},this),dojo.forEach(this.stack,function(t){t.hAxis&&t.setAxis(this.axes[t.hAxis]),t.vAxis&&t.setAxis(this.axes[t.vAxis])},this),this.theme||(this.theme=new dojox.charting.Theme(dojox.charting._def));var o=t.foldl(this.stack,"z + plot.getRequiredColors()",0);this.theme.defineColors({num:o,cache:!1});var r=this.dim=this.surface.getDimensions();r.width=dojox.gfx.normalizedLength(r.width),r.height=dojox.gfx.normalizedLength(r.height),t.forIn(this.axes,s),dojo.forEach(this.stack,function(t){t.calculateAxes(r)});var h=this.offsets={l:0,r:0,t:0,b:0};t.forIn(this.axes,function(i){t.forIn(i.getOffsets(),function(t,i){h[i]+=t})}),t.forIn(this.margins,function(t,i){h[i]+=t}),this.plotArea={width:r.width-h.l-h.r,height:r.height-h.t-h.b},t.forIn(this.axes,s),dojo.forEach(this.stack,function(t){t.calculateAxes(this.plotArea)},this);var a=this.theme,d=this.fill?this.fill:a.chart&&a.chart.fill,n=this.stroke?this.stroke:a.chart&&a.chart.stroke;return d&&this.surface.createRect({width:r.width,height:r.height}).setFill(d),n&&this.surface.createRect({width:r.width-1,height:r.height-1}).setStroke(n),d=a.plotarea&&a.plotarea.fill,n=a.plotarea&&a.plotarea.stroke,d&&this.surface.createRect({x:h.l,y:h.t,width:r.width-h.l-h.r,height:r.height-h.t-h.b}).setFill(d),n&&this.surface.createRect({x:h.l,y:h.t,width:r.width-h.l-h.r-1,height:r.height-h.t-h.b-1}).setStroke(n),t.foldr(this.stack,function(t,i){return i.render(r,h),0},0),t.forIn(this.axes,function(t){t.render(r,h)}),this._makeClean(),this},_makeClean:function(){dojo.forEach(this.axes,r),dojo.forEach(this.stack,r),dojo.forEach(this.series,r),this.dirty=!1},_makeDirty:function(){dojo.forEach(this.axes,h),dojo.forEach(this.stack,h),dojo.forEach(this.series,h),this.dirty=!0}})}());