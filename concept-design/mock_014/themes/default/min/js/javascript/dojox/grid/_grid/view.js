dojo._hasResource["dojox.grid._grid.view"]||(dojo._hasResource["dojox.grid._grid.view"]=!0,dojo.provide("dojox.grid._grid.view"),dojo.require("dijit._Widget"),dojo.require("dijit._Templated"),dojo.require("dojox.grid._grid.builder"),dojo.declare("dojox.GridView",[dijit._Widget,dijit._Templated],{defaultWidth:"18em",viewWidth:"",templateString:'<div class="dojoxGrid-view"><div class="dojoxGrid-header" dojoAttachPoint="headerNode"><div style="width: 9000em"><div dojoAttachPoint="headerContentNode"></div></div></div><input type="checkbox" class="dojoxGrid-hidden-focus" dojoAttachPoint="hiddenFocusNode" /><input type="checkbox" class="dojoxGrid-hidden-focus" /><div class="dojoxGrid-scrollbox" dojoAttachPoint="scrollboxNode"><div class="dojoxGrid-content" dojoAttachPoint="contentNode" hidefocus="hidefocus"></div></div></div>',themeable:!1,classTag:"dojoxGrid",marginBottom:0,rowPad:2,postMixInProperties:function(){this.rowNodes=[]},postCreate:function(){dojo.connect(this.scrollboxNode,"onscroll",dojo.hitch(this,"doscroll")),dojox.grid.funnelEvents(this.contentNode,this,"doContentEvent",["mouseover","mouseout","click","dblclick","contextmenu"]),dojox.grid.funnelEvents(this.headerNode,this,"doHeaderEvent",["dblclick","mouseover","mouseout","mousemove","mousedown","click","contextmenu"]),this.content=new dojox.grid.contentBuilder(this),this.header=new dojox.grid.headerBuilder(this)},destroy:function(){dojox.grid.removeNode(this.headerNode),this.inherited("destroy",arguments)},focus:function(){dojo.isSafari||dojo.isOpera?this.hiddenFocusNode.focus():this.scrollboxNode.focus()},setStructure:function(t){var e=this.structure=t;this.viewWidth=e.width&&dojo.isNumber(e.width)?e.width+"em":e.width||this.viewWidth,this.onBeforeRow=e.onBeforeRow,this.noscroll=e.noscroll,this.noscroll&&(this.scrollboxNode.style.overflow="hidden"),this.testFlexCells(),this.updateStructure()},testFlexCells:function(){this.flexCells=!1;for(var t,e=0;t=this.structure.rows[e];e++)for(var o,i=0;o=t[i];i++)o.view=this,this.flexCells=this.flexCells||o.isFlex();return this.flexCells},updateStructure:function(){this.header.update(),this.content.update()},getScrollbarWidth:function(){return this.noscroll?0:dojox.grid.getScrollbarWidth()},getColumnsWidth:function(){return this.headerContentNode.firstChild.offsetWidth},getWidth:function(){return this.viewWidth||this.getColumnsWidth()+this.getScrollbarWidth()+"px"},getContentWidth:function(){return Math.max(0,dojo._getContentBox(this.domNode).w-this.getScrollbarWidth())+"px"},render:function(){this.scrollboxNode.style.height="",this.renderHeader()},renderHeader:function(){this.headerContentNode.innerHTML=this.header.generateHtml(this._getHeaderContent)},_getHeaderContent:function(t){var e=t.name||t.grid.getCellName(t);return t.index!=t.grid.getSortIndex()?e:['<div class="',t.grid.sortInfo>0?"dojoxGrid-sort-down":"dojoxGrid-sort-up",'">',e,"</div>"].join("")},resize:function(){this.resizeHeight(),this.resizeWidth()},hasScrollbar:function(){return this.scrollboxNode.clientHeight!=this.scrollboxNode.offsetHeight},resizeHeight:function(){if(!this.grid.autoHeight){var t=this.domNode.clientHeight;this.hasScrollbar()||(t-=dojox.grid.getScrollbarWidth()),dojox.grid.setStyleHeightPx(this.scrollboxNode,t)}},resizeWidth:function(){this.flexCells&&(this.contentWidth=this.getContentWidth(),this.headerContentNode.firstChild.style.width=this.contentWidth);var w=this.scrollboxNode.offsetWidth-this.getScrollbarWidth();with(w=Math.max(w,this.getColumnsWidth())+"px",this.contentNode)style.width="",style.width=w},setSize:function(w,h){with(this.domNode.style)w&&(width=w),height=h>=0?h+"px":"";with(this.headerNode.style)w&&(width=w)},renderRow:function(t,e){var o=this.createRowNode(t);return this.buildRow(t,o,e),this.grid.edit.restore(this,t),o},createRowNode:function(t){var e=document.createElement("div");return e.className=this.classTag+"-row",e[dojox.grid.rowIndexTag]=t,this.rowNodes[t]=e,e},buildRow:function(t,e){this.buildRowContent(t,e),this.styleRow(t,e)},buildRowContent:function(t,e){e.innerHTML=this.content.generateHtml(t,t),this.flexCells&&(e.firstChild.style.width=this.contentWidth)},rowRemoved:function(t){this.grid.edit.save(this,t),delete this.rowNodes[t]},getRowNode:function(t){return this.rowNodes[t]},getCellNode:function(t,e){var o=this.getRowNode(t);return o?this.content.getCellNode(o,e):void 0},styleRow:function(t,e){e._style=dojox.grid.getStyleText(e),this.styleRowNode(t,e)},styleRowNode:function(t,e){e&&this.doStyleRowNode(t,e)},doStyleRowNode:function(t,e){this.grid.styleRowNode(t,e)},updateRow:function(t){var e=this.getRowNode(t);return e&&(e.style.height="",this.buildRow(t,e)),e},updateRowStyles:function(t){this.styleRowNode(t,this.getRowNode(t))},lastTop:0,doscroll:function(){this.headerNode.scrollLeft=this.scrollboxNode.scrollLeft;var t=this.scrollboxNode.scrollTop;t!=this.lastTop&&this.grid.scrollTo(t)},setScrollTop:function(t){return this.lastTop=t,this.scrollboxNode.scrollTop=t,this.scrollboxNode.scrollTop},doContentEvent:function(t){this.content.decorateEvent(t)&&this.grid.onContentEvent(t)},doHeaderEvent:function(t){this.header.decorateEvent(t)&&this.grid.onHeaderEvent(t)},dispatchContentEvent:function(t){return this.content.dispatchEvent(t)},dispatchHeaderEvent:function(t){return this.header.dispatchEvent(t)},setColWidth:function(t,e){this.grid.setCellWidth(t,e+"px")},update:function(){var t=this.scrollboxNode.scrollLeft;this.content.update(),this.grid.update(),this.scrollboxNode.scrollLeft=t}}));