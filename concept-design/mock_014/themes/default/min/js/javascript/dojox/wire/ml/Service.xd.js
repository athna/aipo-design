dojo._xdResourceLoaded({depends:[["provide","dojox.wire.ml.Service"],["provide","dojox.wire.ml.RestHandler"],["provide","dojox.wire.ml.XmlHandler"],["provide","dojox.wire.ml.JsonHandler"],["require","dijit._Widget"],["require","dojox.data.dom"],["require","dojox.wire._base"],["require","dojox.wire.ml.util"]],defineResource:function(e){e._hasResource["dojox.wire.ml.Service"]||(e._hasResource["dojox.wire.ml.Service"]=!0,e.provide("dojox.wire.ml.Service"),e.provide("dojox.wire.ml.RestHandler"),e.provide("dojox.wire.ml.XmlHandler"),e.provide("dojox.wire.ml.JsonHandler"),e.require("dijit._Widget"),e.require("dojox.data.dom"),e.require("dojox.wire._base"),e.require("dojox.wire.ml.util"),e.declare("dojox.wire.ml.Service",dijit._Widget,{url:"",serviceUrl:"",serviceType:"",handlerClass:"",preventCache:!0,postCreate:function(){this.handler=this._createHandler()},_handlerClasses:{TEXT:"dojox.wire.ml.RestHandler",XML:"dojox.wire.ml.XmlHandler",JSON:"dojox.wire.ml.JsonHandler","JSON-RPC":"dojo.rpc.JsonService"},_createHandler:function(){if(this.url){var r=this,t=e.xhrGet({url:this.url,handleAs:"json",sync:!0});t.addCallback(function(e){r.smd=e}),this.smd&&!this.serviceUrl&&(this.serviceUrl=this.smd.serviceUrl||this.smd.serviceURL)}var i=void 0;return this.handlerClass?i=dojox.wire._getClass(this.handlerClass):this.serviceType?(i=this._handlerClasses[this.serviceType],i&&e.isString(i)&&(i=dojox.wire._getClass(i),this._handlerClasses[this.serviceType]=i)):this.smd&&this.smd.serviceType&&(i=this._handlerClasses[this.smd.serviceType],i&&e.isString(i)&&(i=dojox.wire._getClass(i),this._handlerClasses[this.smd.serviceType]=i)),i?new i:null},callMethod:function(r,t){var i=new e.Deferred;return this.handler.bind(r,t,i,this.serviceUrl),i}}),e.declare("dojox.wire.ml.RestHandler",null,{contentType:"text/plain",handleAs:"text",bind:function(r,t,i,n){r=r.toUpperCase();var s=this,o={url:this._getUrl(r,t,n),contentType:this.contentType,handleAs:this.handleAs,headers:this.headers,preventCache:this.preventCache},l=null;"POST"==r?(o.postData=this._getContent(r,t),l=e.rawXhrPost(o)):"PUT"==r?(o.putData=this._getContent(r,t),l=e.rawXhrPut(o)):l="DELETE"==r?e.xhrDelete(o):e.xhrGet(o),l.addCallbacks(function(e){i.callback(s._getResult(e))},function(e){i.errback(e)})},_getUrl:function(e,r,t){if("GET"==e||"DELETE"==e){var i=r[0],n="";for(var s in i){var o=i[s];if(o){o=encodeURIComponent(o);var l="{"+s+"}",d=t.indexOf(l);d>=0?t=t.substring(0,d)+o+t.substring(d+l.length):(n&&(n+="&"),n+=s+"="+o)}}n&&(t+="?"+n)}return t},_getContent:function(e,r){return"POST"==e||"PUT"==e?r?r[0]:null:null},_getResult:function(e){return e}}),e.declare("dojox.wire.ml.XmlHandler",dojox.wire.ml.RestHandler,{contentType:"text/xml",handleAs:"xml",_getContent:function(r,t){var i=null;if("POST"==r||"PUT"==r){var n=t[0];if(n)if(e.isString(n))i=n;else{var s=n;s instanceof dojox.wire.ml.XmlElement?s=s.element:9===s.nodeType&&(s=s.documentElement);var o='<?xml version="1.0"?>';i=o+dojox.data.dom.innerXML(s)}}return i},_getResult:function(e){return e&&(e=new dojox.wire.ml.XmlElement(e)),e}}),e.declare("dojox.wire.ml.JsonHandler",dojox.wire.ml.RestHandler,{contentType:"text/json",handleAs:"json",headers:{Accept:"*/json"},_getContent:function(r,t){var i=null;if("POST"==r||"PUT"==r){var n=t?t[0]:void 0;n&&(i=e.isString(n)?n:e.toJson(n))}return i}}))}});