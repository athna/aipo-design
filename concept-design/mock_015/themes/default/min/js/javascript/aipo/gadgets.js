function recurseNames(e,t,n,r){if(0!=n)for(var i in e)if(e.hasOwnProperty(i)&&-1==i.indexOf("_")){var o=typeof e[i];"function"==o?r.push(t+i):"object"==o&&recurseNames(e[i],t+i+".",n-1,r)}}var gadgets=gadgets||{},shindig=shindig||{},osapi=osapi||{};gadgets.config=function(){var e,t={};return{register:function(e,n,r){var i=t[e];i||(i=[],t[e]=i),i.push({validators:n||{},callback:r})},get:function(t){return t?e[t]||{}:e},init:function(n,r){e=n;for(var i in t)if(t.hasOwnProperty(i))for(var o=t[i],a=n[i],s=0,g=o.length;g>s;++s){var d=o[s];if(a&&!r){var u=d.validators;for(var c in u)if(u.hasOwnProperty(c)&&!u[c](a[c]))throw new Error('Invalid config value "'+a[c]+'" for parameter "'+c+'" in component "'+i+'"')}d.callback&&d.callback(n)}},EnumValidator:function(e){var t=[];if(arguments.length>1)for(var n,r=0;n=arguments[r];++r)t.push(n);else t=e;return function(e){for(var n,r=0;n=t[r];++r)if(e===t[r])return!0;return!1}},RegExValidator:function(e){return function(t){return e.test(t)}},ExistsValidator:function(e){return"undefined"!=typeof e},NonEmptyStringValidator:function(e){return"string"==typeof e&&e.length>0},BooleanValidator:function(e){return"boolean"==typeof e},LikeValidator:function(e){return function(t){for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(!r(t[n]))return!1}return!0}}}}(),gadgets.config.isGadget=!1,gadgets.config.isContainer=!0,gadgets.util=function(){function e(e){var t,n=e.indexOf("?"),r=e.indexOf("#");return t=-1===r?e.substr(n+1):[e.substr(n+1,r-n-1),"&",e.substr(r+1)].join(""),t.split("&")}function t(e,t){return String.fromCharCode(t)}function n(e){i=e["core.util"]||{}}var r=null,i={},o={},a=[],s={0:!1,10:!0,13:!0,34:!0,39:!0,60:!0,62:!0,92:!0,8232:!0,8233:!0};return gadgets.config&&gadgets.config.register("core.util",null,n),{getUrlParameters:function(t){var n="undefined"==typeof t;if(null!==r&&n)return r;for(var i={},o=e(t||document.location.href),a=window.decodeURIComponent?decodeURIComponent:unescape,s=0,g=o.length;g>s;++s){var d=o[s].indexOf("=");if(-1!==d){var u=o[s].substring(0,d),c=o[s].substring(d+1);c=c.replace(/\+/g," "),i[u]=a(c)}}return n&&(r=i),i},makeClosure:function(e,t){for(var n=[],r=2,i=arguments.length;i>r;++r)n.push(arguments[r]);return function(){for(var r=n.slice(),i=0,o=arguments.length;o>i;++i)r.push(arguments[i]);return t.apply(e,r)}},makeEnum:function(e){var t,n,r={};for(t=0;n=e[t];++t)r[n]=n;return r},getFeatureParameters:function(e){return"undefined"==typeof i[e]?null:i[e]},hasFeature:function(e){return"undefined"!=typeof i[e]},getServices:function(){return o},registerOnLoadHandler:function(e){a.push(e)},runOnLoadHandlers:function(){for(var e=0,t=a.length;t>e;++e)a[e]()},escape:function(e,t){if(!e)return e;if("string"==typeof e)return gadgets.util.escapeString(e);if("array"==typeof e)for(var n=0,r=e.length;r>n;++n)e[n]=gadgets.util.escape(e[n]);else if("object"==typeof e&&t){var i={};for(var o in e)e.hasOwnProperty(o)&&(i[gadgets.util.escapeString(o)]=gadgets.util.escape(e[o],!0));return i}return e},escapeString:function(e){if(!e)return e;for(var t,n,r=[],i=0,o=e.length;o>i;++i)t=e.charCodeAt(i),n=s[t],n===!0?r.push("&#",t,";"):n!==!1&&r.push(e.charAt(i));return r.join("")},unescapeString:function(e){return e?e.replace(/&#([0-9]+);/g,t):e},attachBrowserEvent:function(e,t,n,r){"undefined"!=typeof e.addEventListener?e.addEventListener(t,n,r):"undefined"!=typeof e.attachEvent?e.attachEvent("on"+t,n):gadgets.warn("cannot attachBrowserEvent: "+t)},removeBrowserEvent:function(e,t,n,r){e.removeEventListener?e.removeEventListener(t,n,r):e.detachEvent?e.detachEvent("on"+t,n):gadgets.warn("cannot removeBrowserEvent: "+t)}}}(),gadgets.util.getUrlParameters();var tamings___=tamings___||[];tamings___.push(function(){caja___.whitelistFuncs([[gadgets.util,"escapeString"],[gadgets.util,"getFeatureParameters"],[gadgets.util,"getUrlParameters"],[gadgets.util,"hasFeature"],[gadgets.util,"registerOnLoadHandler"],[gadgets.util,"unescapeString"]])}),gadgets.json=window.JSON&&window.JSON.parse&&window.JSON.stringify?function(){var e=/___$/;return{parse:function(e){try{return window.JSON.parse(e)}catch(t){return!1}},stringify:function(t){try{return window.JSON.stringify(t,function(t,n){return e.test(t)?null:n})}catch(n){return null}}}}():function(){function f(e){return 10>e?"0"+e:e}function stringify(e){var t,n,r,i,o,a=/["\\\x00-\x1f\x7f-\x9f]/g;switch(typeof e){case"string":return a.test(e)?'"'+e.replace(a,function(e){var t=m[e];return t?t:(t=e.charCodeAt(),"\\u00"+Math.floor(t/16).toString(16)+(t%16).toString(16))})+'"':'"'+e+'"';case"number":return isFinite(e)?String(e):"null";case"boolean":case"null":return String(e);case"object":if(!e)return"null";if(t=[],"number"==typeof e.length&&!e.propertyIsEnumerable("length")){for(i=e.length,n=0;i>n;n+=1)t.push(stringify(e[n])||"null");return"["+t.join(",")+"]"}for(r in e)r.match("___$")||e.hasOwnProperty(r)&&"string"==typeof r&&(o=stringify(e[r]),o&&t.push(stringify(r)+":"+o));return"{"+t.join(",")+"}"}return""}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return{stringify:stringify,parse:function(text){return/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))?eval("("+text+")"):!1}}}(),gadgets.json.flatten=function(e){var t={};if(null===e||void 0===e)return t;for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(null===r||void 0===r)continue;t[n]="string"==typeof r?r:gadgets.json.stringify(r)}return t};var tamings___=tamings___||[];tamings___.push(function(){___.tamesTo(gadgets.json.stringify,safeJSON.stringify),___.tamesTo(gadgets.json.parse,safeJSON.parse)}),shindig.Auth=function(){function addParamsToToken(e){for(var t=authToken.split("&"),n=0;n<t.length;n++){var r=t[n].split("=");if(2===r.length){var i=r[0],o=r[1];"$"===o&&(o=encodeURIComponent(e[i]),t[n]=i+"="+o)}}authToken=t.join("&")}function init(configuration){var urlParams=gadgets.util.getUrlParameters(),config=configuration["shindig.auth"]||{};config.authToken?authToken=config.authToken:urlParams.st&&(authToken=urlParams.st),null!==authToken&&addParamsToToken(urlParams),config.trustedJson&&(trusted=eval("("+config.trustedJson+")"))}var authToken=null,trusted=null;return gadgets.config.register("shindig.auth",null,init),{getSecurityToken:function(){return authToken},updateSecurityToken:function(e){authToken=e},getTrustedData:function(){return trusted}}},shindig.auth=new shindig.Auth,gadgets.rpctx=gadgets.rpctx||{},gadgets.rpctx.wpm||(gadgets.rpctx.wpm=function(){function e(e,t,n){"undefined"!=typeof window.addEventListener?window.addEventListener(e,t,n):"undefined"!=typeof window.attachEvent&&window.attachEvent("on"+e,t)}function t(e){var t=gadgets.json.parse(e.data);if(t&&t.f){var r=gadgets.rpc.getTargetOrigin(t.f);("undefined"!=typeof e.origin?e.origin===r:e.domain===/^.+:\/\/([^:]+).*/.exec(r)[1])&&n(t,e.origin)}}var n,r;return{getCode:function(){return"wpm"},isParentVerifiable:function(){return!0},init:function(i,o){return n=i,r=o,e("message",t,!1),r("..",!0),!0},setup:function(e){return r(e,!0),!0},call:function(e,t,n){var r=gadgets.rpc.getTargetOrigin(e),i=gadgets.rpc._getTargetWin(e);return r?window.setTimeout(function(){i.postMessage(gadgets.json.stringify(n),r)},0):gadgets.error("No relay set (used as window.postMessage targetOrigin), cannot send cross-domain message"),!0}}}()),gadgets.rpctx=gadgets.rpctx||{},gadgets.rpctx.flash||(gadgets.rpctx.flash=function(){function e(){window[A]=window[A]||{};var e=window[A],t=e[G]={};return l=A+"."+G,t}function t(e,t){var n=function(){e.apply({},arguments)};return N[t]=N[t]||n,l+"."+t}function n(e){return".."===e?gadgets.rpc.RPC_ID:e}function r(e){return".."===e?"INNER":"OUTER"}function i(e){v&&(p=e.rpc.commSwf||"/xpc.swf")}function o(){if(null===_&&document.body&&p){var e=p+"?cb="+Math.random()+"&origin="+k+"&jsl=1",t=document.createElement("div");t.style.height="1px",t.style.width="1px";var n='<object height="1" width="1" id="'+h+'" type="application/x-shockwave-flash"><param name="allowScriptAccess" value="always"></param><param name="movie" value="'+e+'"></param><embed type="application/x-shockwave-flash" allowScriptAccess="always" src="'+e+'" height="1" width="1"></embed></object>';document.body.appendChild(t),t.innerHTML=n,_=t.firstChild}++S,null!==T&&(null!==_||S>=I)?window.clearTimeout(T):T=window.setTimeout(o,w)}function a(){b[".."]||(f(".."),O++,O>=U&&null!==x?(window.clearTimeout(x),x=null):x=window.setTimeout(a,R))}function s(){if(null!==_)for(;E.length>0;){var e=E.shift(),t=e.targetId;_.setup(e.token,n(t),r(t))}}function g(){s(),null!==T&&window.clearTimeout(T),T=null}function d(){b[".."]||null!==x||(x=window.setTimeout(a,R))}function u(e,t,i){var o=gadgets.rpc.getTargetOrigin(e),a=gadgets.rpc.getAuthToken(e),s="sendMessage_"+n(e)+"_"+a+"_"+r(e),g=_[s];return g.call(_,gadgets.json.stringify(i),o),!0}function c(e,t){var n=gadgets.json.parse(e),r=n[C];return r?(y(r,!0),b[r]=!0,".."!==r&&f(r,!0),void 0):(window.setTimeout(function(){m(n,t)},0),void 0)}function f(e,t){var n=gadgets.rpc.RPC_ID,r={};r[C]=t?"..":n,r[P]=n,u(e,n,r)}var l,h="___xpcswf",p=null,v=!1,m=null,y=null,_=null,w=100,I=50,E=[],T=null,S=0,C="_scr",P="_pnt",R=100,U=50,O=0,x=null,b={},k=window.location.protocol+"//"+window.location.host,A="___jsl",G="_fm",N=e();return gadgets.config.register("rpc",null,i),t(g,"ready"),t(d,"setupDone"),t(c,"receiveMessage"),{getCode:function(){return"flash"},isParentVerifiable:function(){return!0},init:function(e,t){return m=e,y=t,v=!0,!0},setup:function(e,t){return E.push({token:t,targetId:e}),null===_&&null===T&&(T=window.setTimeout(o,w)),s(),!0},call:u,_receiveMessage:c,_ready:g,_setupDone:d}}()),gadgets.rpctx=gadgets.rpctx||{},gadgets.rpctx.frameElement||(gadgets.rpctx.frameElement=function(){function e(e,n,o){try{if(".."!==n){var a=window.frameElement;if("function"==typeof a[r])return"function"!=typeof a[r][i]&&(a[r][i]=function(e){t(gadgets.json.parse(e))}),a[r](gadgets.json.stringify(o)),!0}else{var s=document.getElementById(e);if("function"==typeof s[r]&&"function"==typeof s[r][i])return s[r][i](gadgets.json.stringify(o)),!0}}catch(g){}return!1}var t,n,r="__g2c_rpc",i="__c2g_rpc";return{getCode:function(){return"fe"},isParentVerifiable:function(){return!1},init:function(e,r){return t=e,n=r,!0},setup:function(e){if(".."!==e)try{var i=document.getElementById(e);i[r]=function(e){t(gadgets.json.parse(e))}}catch(o){return!1}if(".."===e){n("..",!0);var a=function(){window.setTimeout(function(){gadgets.rpc.call(e,gadgets.rpc.ACK)},500)};gadgets.util.registerOnLoadHandler(a)}return!0},call:function(t,n,r){return e(t,n,r)}}}()),gadgets.rpctx=gadgets.rpctx||{},gadgets.rpctx.nix||(gadgets.rpctx.nix=function(){function e(){var n=g[".."];if(!n){if(++d>a)return gadgets.warn("Nix transport setup failed, falling back..."),t("..",!1),void 0;if(!n&&window.opener&&"GetAuthToken"in window.opener&&(n=window.opener,n.GetAuthToken()==gadgets.rpc.getAuthToken(".."))){var i=gadgets.rpc.getAuthToken("..");return n.CreateChannel(window[r]("..",i),i),g[".."]=n,window.opener=null,t("..",!0),void 0}window.setTimeout(function(){e()},s)}}var t,n="GRPC____NIXVBS_wrapper",r="GRPC____NIXVBS_get_wrapper",i="GRPC____NIXVBS_handle_message",o="GRPC____NIXVBS_create_channel",a=10,s=500,g={},d=0;return{getCode:function(){return"nix"},isParentVerifiable:function(){return!1},init:function(e,a){if(t=a,"unknown"!=typeof window[r]){window[i]=function(t){window.setTimeout(function(){e(gadgets.json.parse(t))},0)},window[o]=function(e,n,r){gadgets.rpc.getAuthToken(e)===r&&(g[e]=n,t(e,!0))};var s="Class "+n+"\n Private m_Intended\nPrivate m_Auth\nPublic Sub SetIntendedName(name)\n If isEmpty(m_Intended) Then\nm_Intended = name\nEnd If\nEnd Sub\nPublic Sub SetAuth(auth)\n If isEmpty(m_Auth) Then\nm_Auth = auth\nEnd If\nEnd Sub\nPublic Sub SendMessage(data)\n "+i+"(data)\nEnd Sub\nPublic Function GetAuthToken()\n GetAuthToken = m_Auth\nEnd Function\nPublic Sub CreateChannel(channel, auth)\n Call "+o+"(m_Intended, channel, auth)\nEnd Sub\nEnd Class\nFunction "+r+"(name, auth)\nDim wrap\nSet wrap = New "+n+"\nwrap.SetIntendedName name\nwrap.SetAuth auth\nSet "+r+" = wrap\nEnd Function";try{window.execScript(s,"vbscript")}catch(d){return!1}}return!0},setup:function(t,n){if(".."===t)return e(),!0;try{var i=document.getElementById(t),o=window[r](t,n);i.contentWindow.opener=o}catch(a){return!1}return!0},call:function(e,t,n){try{g[e]&&g[e].SendMessage(gadgets.json.stringify(n))}catch(r){return!1}return!0}}}()),gadgets.rpctx=gadgets.rpctx||{},gadgets.rpctx.rmr||(gadgets.rpctx.rmr=function(){function e(e,t,n,r){var i=function(){document.body.appendChild(e),e.src="about:blank",r&&(e.onload=function(){o(r)}),e.src=t+"#"+n};document.body?i():gadgets.util.registerOnLoadHandler(function(){i()})}function t(t){if("object"!=typeof c[t]){var r=document.createElement("iframe"),o=r.style;o.position="absolute",o.top="0px",o.border="0",o.opacity="0",o.width="10px",o.height="1px",r.id="rmrtransport-"+t,r.name=r.id;var a=gadgets.rpc.getRelayUrl(t),s=gadgets.rpc.getOrigin(f);a||(a=s+"/robots.txt"),c[t]={frame:r,receiveWindow:null,relayUri:a,relayOrigin:s,searchCounter:0,width:10,waiting:!0,queue:[],sendId:0,recvId:0,verifySendToken:String(Math.random()),verifyRecvToken:null,originVerified:!1},".."!==t&&e(r,a,i(t)),n(t)}}function n(e){var t=null;c[e].searchCounter++;try{var r=gadgets.rpc._getTargetWin(e);t=".."===e?r.frames["rmrtransport-"+gadgets.rpc.RPC_ID]:r.frames["rmrtransport-.."]}catch(i){}var o=!1;if(t&&(o=a(e,t)),!o){if(c[e].searchCounter>u)return;window.setTimeout(function(){n(e)},d)}}function r(e,t,n,r){var o=null;if(o=".."!==n?c[".."]:c[e]){if(t!==gadgets.rpc.ACK&&o.queue.push(r),o.waiting||0===o.queue.length&&(t!==gadgets.rpc.ACK||!r||r.ackAlone!==!0))return!0;o.queue.length>0&&(o.waiting=!0);var a=o.relayUri+"#"+i(e);try{o.frame.contentWindow.location=a;var s=10==o.width?20:10;o.frame.style.width=s+"px",o.width=s}catch(g){return!1}}return!0}function i(e){var t=c[e],n={id:t.sendId};if(t){n.d=Array.prototype.slice.call(t.queue,0);var r={s:gadgets.rpc.ACK,id:t.recvId};t.originVerified||(r.sendToken=t.verifySendToken),t.verifyRecvToken&&(r.recvToken=t.verifyRecvToken),n.d.push(r)}return gadgets.json.stringify(n)}function o(e){for(var t=c[e],n=t.receiveWindow.location.hash.substring(1),i=gadgets.json.parse(decodeURIComponent(n))||{},o=i.d||[],a=!1,d=!1,u=0,f=t.recvId-i.id,l=0;l<o.length;++l){var h=o[l];if(h.s!==gadgets.rpc.ACK)a=!0,++u<=f||(++t.recvId,s(h,t.originVerified?t.relayOrigin:void 0));else{g(e,!0),t.verifyRecvToken=h.sendToken,!t.originVerified&&h.recvToken&&String(h.recvToken)==String(t.verifySendToken)&&(t.originVerified=!0),t.waiting&&(d=!0),t.waiting=!1;var p=Math.max(0,h.id-t.sendId);t.queue.splice(0,p),t.sendId=Math.max(t.sendId,h.id||0)}}if(a||d&&t.queue.length>0){var v=".."===e?gadgets.rpc.RPC_ID:"..";r(e,gadgets.rpc.ACK,v,{ackAlone:a})}}function a(t,n){function r(){o(t)}var a=c[t];try{var s=!1;if(s="document"in n,!s)return!1;if(s="object"==typeof n.document,!s)return!1;var g=n.location.href;if("about:blank"===g)return!1}catch(d){return!1}return a.receiveWindow=n,"undefined"==typeof n.attachEvent?n.onresize=r:n.attachEvent("onresize",r),".."===t?e(a.frame,a.relayUri,i(t),t):o(t),!0}var s,g,d=500,u=10,c={},f=gadgets.util.getUrlParameters().parent;return{getCode:function(){return"rmr"},isParentVerifiable:function(){return!0},init:function(e,t){return s=e,g=t,!0},setup:function(e){try{t(e)}catch(n){return gadgets.warn("Caught exception setting up RMR: "+n),!1}return!0},call:function(e,t,n){return r(e,n.s,t,n)}}}()),gadgets.rpctx=gadgets.rpctx||{},gadgets.rpctx.ifpc||(gadgets.rpctx.ifpc=function(){function e(e){for(var t=[],n=0,r=e.length;r>n;++n)t.push(encodeURIComponent(gadgets.json.stringify(e[n])));return t.join("&")}function t(e){for(var t,n=i.length-1;n>=0;--n){var r=i[n];try{if(r&&(r.recyclable||"complete"===r.readyState)){if(r.parentNode.removeChild(r),!window.ActiveXObject){r.recyclable=!1,t=r;break}i[n]=r=null,i.splice(n,1)}}catch(o){}}t||(t=document.createElement("iframe"),t.style.border=t.style.width=t.style.height="0px",t.style.visibility="hidden",t.style.position="absolute",t.onload=function(){this.recyclable=!0},i.push(t)),t.src=e,window.setTimeout(function(){document.body.appendChild(t)},0)}function n(e,t){for(var n=t-1;n>=0;--n)if("undefined"==typeof e[n])return!1;return!0}var r,i=[],o=0,a=2e3,s={};return{getCode:function(){return"ifpc"},isParentVerifiable:function(){return!0},init:function(e,t){return r=t,r("..",!0),!0},setup:function(e){return r(e,!0),!0},call:function(n,r,i){var s=gadgets.rpc.getRelayUrl(n);if(++o,!s)return gadgets.warn("No relay file assigned for IFPC"),!1;var g=null,d=[];if(i.l){var u=i.a;g=[s,"#",e([r,o,1,0,e([r,i.s,"","",r].concat(u))])].join(""),d.push(g)}else{g=[s,"#",n,"&",r,"@",o,"&"].join("");for(var c,f=encodeURIComponent(gadgets.json.stringify(i)),l=a-g.length,h=Math.ceil(f.length/l),p=0;f.length>0;)c=f.substring(0,l),f=f.substring(l),d.push([g,h,"&",p,"&",c].join("")),p+=1}do t(d.shift());while(d.length>0);return!0},_receiveMessage:function(e,t){var r=e[1],i=parseInt(e[2],10),o=parseInt(e[3],10),a=e[e.length-1],g=1===i;i>1&&(s[r]||(s[r]=[]),s[r][o]=a,n(s[r],i)&&(a=s[r].join(""),delete s[r],g=!0)),g&&t(gadgets.json.parse(decodeURIComponent(a)))}}}()),window.gadgets.rpc||(gadgets.rpc=function(){function e(){return"flash"==L.rpctx?gadgets.rpctx.flash:"rmr"==L.rpctx?gadgets.rpctx.rmr:"function"==typeof window.postMessage?gadgets.rpctx.wpm:"object"==typeof window.postMessage?gadgets.rpctx.wpm:window.ActiveXObject?gadgets.rpctx.flash?gadgets.rpctx.flash:gadgets.rpctx.nix:navigator.userAgent.indexOf("WebKit")>0?gadgets.rpctx.rmr:"Gecko"===navigator.product?gadgets.rpctx.frameElement:gadgets.rpctx.ifpc}function t(e,t){if(!D[e]){var n=et;t||(n=z),D[e]=n;for(var r=j[e]||[],i=0;i<r.length;++i){var o=r[i];o.t=h(e),n.call(e,o.f,o)}j[e]=[]}}function n(){function e(){Q=!0}Z||("undefined"!=typeof window.addEventListener?window.addEventListener("unload",e,!1):"undefined"!=typeof window.attachEvent&&window.attachEvent("onunload",e),Z=!0)}function r(e,t,r,i,o){A[t]&&A[t]===r||(gadgets.error("Invalid auth token. "+A[t]+" vs "+r),X(t,W)),o.onunload=function(){B[t]&&!Q&&(X(t,J),gadgets.rpc.removeReceiver(t))},n(),i=gadgets.json.parse(decodeURIComponent(i))}function i(e,n){if(e&&"string"==typeof e.s&&"string"==typeof e.f&&e.a instanceof Array){if(A[e.f]&&A[e.f]!==e.t&&(gadgets.error("Invalid auth token. "+A[e.f]+" vs "+e.t),X(e.f,W)),e.s===T)return window.setTimeout(function(){t(e.f,!0)},0),void 0;if(e.c&&(e[R]=function(t){gadgets.rpc.call(e.f,I,null,e.c,t)}),n){var r=o(n);e[U]=n;var i=e.r;i&&o(i)==r||(i=n),e[O]=i}var a=(x[e.s]||x[E]).apply(e,e.a);e.c&&"undefined"!=typeof a&&gadgets.rpc.call(e.f,I,null,e.c,a)}}function o(e){if(!e)return"";e=e.toLowerCase(),0==e.indexOf("//")&&(e=window.location.protocol+e),-1==e.indexOf("://")&&(e=window.location.protocol+"//"+e);var t=e.substring(e.indexOf("://")+3),n=t.indexOf("/");-1!=n&&(t=t.substring(0,n));var r=e.substring(0,e.indexOf("://")),i="",o=t.indexOf(":");if(-1!=o){var a=t.substring(o+1);t=t.substring(0,o),("http"===r&&"80"!==a||"https"===r&&"443"!==a)&&(i=":"+a)}return r+"://"+t+i}function a(e,t){return"/"+e+(t?P+t:"")}function s(e){if("/"==e.charAt(0)){var t=e.indexOf(P),n=t>0?e.substring(1,t):e.substring(1),r=t>0?e.substring(t+1):null;return{id:n,origin:r}}return null}function g(e){if("undefined"==typeof e||".."===e)return window.parent;var t=s(e);if(t)return window.top.frames[t.id];e=String(e);var n=window.frames[e];return n?n:(n=document.getElementById(e),n&&n.contentWindow?n.contentWindow:null)}function d(e){var t=null,n=f(e);if(n)t=n;else{var r=s(e);t=r?r.origin:".."==e?L.parent:document.getElementById(e).src}return o(t)}function u(e,t){if(B[e]!==!0){"undefined"==typeof B[e]&&(B[e]=0);var n=g(e);return".."!==e&&null==n||et.setup(e,t)!==!0?(B[e]!==!0&&B[e]++<C?window.setTimeout(function(){u(e,t)},S):(D[e]=z,B[e]=!0),void 0):(B[e]=!0,void 0)}}function c(e,t){if("undefined"==typeof M[e]){M[e]=!1;var n=f(e);if(o(n)!==o(window.location.href))return!1;var r=g(e);try{var i=r.gadgets;M[e]=i.rpc.receiveSameDomain}catch(a){}}return"function"==typeof M[e]?(M[e](t),!0):!1}function f(e){var t=b[e];return t&&"/"===t.substring(0,1)&&(t="/"===t.substring(1,2)?document.location.protocol+t:document.location.protocol+"//"+document.location.host+t),t}function l(e,t,n){/http(s)?:\/\/.+/.test(t)||(0==t.indexOf("//")?t=window.location.protocol+t:"/"==t.charAt(0)?t=window.location.protocol+"//"+window.location.host+t:-1==t.indexOf("://")&&(t=window.location.protocol+"//"+t)),b[e]=t,k[e]=!!n}function h(e){return A[e]}function p(e,t){t=t||"",A[e]=String(t),u(e,t)}function v(e){var t=e.passReferrer||"",n=t.split(":",2);F=n[0]||"none",V=n[1]||"origin"}function m(e,n){function r(r){var a=r?r.rpc:{},s="true"===String(a.useLegacyProtocol);v(a);var g=a.parentRelayUrl||"";g=o(L.parent||n)+g,l("..",g,s),s&&(et=gadgets.rpctx.ifpc,et.init(i,t)),p("..",e)}return!L.parent&&n?(r({}),void 0):(gadgets.config.register("rpc",null,r),void 0)}function y(e,t,n){if("/"!=e.charAt(0)){if(!gadgets.util)return;var r=document.getElementById(e);if(!r)throw new Error("Cannot set up gadgets.rpc receiver with ID: "+e+", element not found.")}var i=r&&r.src,o=t||gadgets.rpc.getOrigin(i);l(e,o);var a=gadgets.util.getUrlParameters(i),s=n||a.rpctoken;p(e,s)}function _(e,t,n){if(".."===e){var r=n||L.rpctoken||L.ifpctok||"";m(r,t)}else y(e,t,n)}function w(e){if("bidir"===F||"c2p"===F&&".."===e||"p2c"===F&&".."!==e){var t=window.location.href,n="?";if("query"===V)n="#";else if("hash"===V)return t;var r=t.lastIndexOf(n);return r=-1===r?t.length:r,t.substring(0,r)}return null}var I="__cb",E="",T="__ack",S=500,C=10,P="|",R="callback",U="origin",O="referer",x={},b={},k={},A={},G=0,N={},B={},M={},L={},D={},j={},F=null,V=null,H=window.top!==window.self,q=window.name,X=function(){},K=0,J=1,W=2,Y=window.console,$=Y&&Y.log&&function(e){Y.log(e)}||function(){},z=function(){function e(e){return function(){$(e+": call ignored")}}return{getCode:function(){return"noop"},isParentVerifiable:function(){return!0},init:e("init"),setup:e("setup"),call:e("call")}}();gadgets.util&&(L=gadgets.util.getUrlParameters());var Q=!1,Z=!1,et=e();return x[E]=function(){$("Unknown RPC service: "+this.s)},x[I]=function(e,t){var n=N[e];n&&(delete N[e],n.call(this,t))},{config:function(e){"function"==typeof e.securityCallback&&(X=e.securityCallback)},register:function(e,t){if(e===I||e===T)throw new Error("Cannot overwrite callback/ack service");if(e===E)throw new Error("Cannot overwrite default service: use registerDefault");x[e]=t},unregister:function(e){if(e===I||e===T)throw new Error("Cannot delete callback/ack service");if(e===E)throw new Error("Cannot delete default service: use unregisterDefault");delete x[e]},registerDefault:function(e){x[E]=e},unregisterDefault:function(){delete x[E]},forceParentVerifiable:function(){et.isParentVerifiable()||(et=gadgets.rpctx.ifpc)},call:function(e,t,n){e=e||"..";var r="..";".."===e?r=q:"/"==e.charAt(0)&&(r=a(q,gadgets.rpc.getOrigin(window.location.href))),++G,n&&(N[G]=n);var i={s:t,f:r,c:n?G:0,a:Array.prototype.slice.call(arguments,3),t:A[e],l:k[e]},o=w(e);if(o&&(i.r=o),(".."===e||null!=s(e)||document.getElementById(e))&&!c(e,i)){var g=D[e];if(g||null===s(e)||(g=et),!g)return j[e]?j[e].push(i):j[e]=[i],void 0;k[e]&&(g=gadgets.rpctx.ifpc),g.call(e,r,i)===!1&&(D[e]=z,et.call(e,r,i))}},getRelayUrl:f,setRelayUrl:l,setAuthToken:p,setupReceiver:_,getAuthToken:h,removeReceiver:function(e){delete b[e],delete k[e],delete A[e],delete B[e],delete M[e],delete D[e]},getRelayChannel:function(){return et.getCode()},receive:function(e,t){e.length>4?et._receiveMessage(e,i):r.apply(null,e.concat(t))},receiveSameDomain:function(e){e.a=Array.prototype.slice.call(e.a),window.setTimeout(function(){i(e)},0)},getOrigin:o,getTargetOrigin:d,init:function(){et.init(i,t)===!1&&(et=z),H?_(".."):gadgets.config.register("rpc",null,function(e){v(e.rpc||{})})},_getTargetWin:g,_parseSiblingId:s,ACK:T,RPC_ID:q||"..",SEC_ERROR_LOAD_TIMEOUT:K,SEC_ERROR_FRAME_PHISH:J,SEC_ERROR_FORGED_MSG:W}}(),gadgets.rpc.init()),gadgets.io=function(){function makeXhr(){var e;if("undefined"!=typeof shindig&&shindig.xhrwrapper&&shindig.xhrwrapper.createXHR)return shindig.xhrwrapper.createXHR();if("undefined"!=typeof ActiveXObject)return e=new ActiveXObject("Msxml2.XMLHTTP"),e||(e=new ActiveXObject("Microsoft.XMLHTTP")),e;if("undefined"!=typeof XMLHttpRequest||window.XMLHttpRequest)return new window.XMLHttpRequest;throw"no xhr available"}function hadError(e,t){if(4!==e.readyState)return!0;try{if(200!==e.status){var n=""+e.status;return e.responseText&&(n=n+" "+e.responseText),t({errors:[n],rc:e.status,text:e.responseText}),!0}}catch(r){return t({errors:[r.number+" Error not specified"],rc:r.number,text:r.description}),!0}return!1}function processNonProxiedResponse(e,t,n,r){if(!hadError(r,t)){var i={body:r.responseText};t(transformResponseData(n,i))}}function processResponse(url,callback,params,xobj){if(!hadError(xobj,callback)){var txt=xobj.responseText,offset=txt.indexOf(UNPARSEABLE_CRUFT)+UNPARSEABLE_CRUFT.length;if(!(offset<UNPARSEABLE_CRUFT.length)){txt=txt.substr(offset);var data=eval("("+txt+")");data=data[url],data.oauthState&&(oauthState=data.oauthState),data.st&&shindig.auth.updateSecurityToken(data.st),callback(transformResponseData(params,data))}}}function transformResponseData(e,t){var n={text:t.body,rc:t.rc||200,headers:t.headers,oauthApprovalUrl:t.oauthApprovalUrl,oauthError:t.oauthError,oauthErrorText:t.oauthErrorText,errors:[]};if(n.rc<200||n.rc>=400)n.errors=[n.rc+" Error"];else if(n.text)switch(n.rc>=300&&n.rc<400&&(e.CONTENT_TYPE="TEXT"),e.CONTENT_TYPE){case"JSON":case"FEED":n.data=gadgets.json.parse(n.text),n.data||(n.errors.push("500 Failed to parse JSON"),n.rc=500,n.data=null);break;case"DOM":var r;if("undefined"!=typeof ActiveXObject)r=new ActiveXObject("Microsoft.XMLDOM"),r.async=!1,r.validateOnParse=!1,r.resolveExternals=!1,r.loadXML(n.text)?n.data=r:(n.errors.push("500 Failed to parse XML"),n.rc=500);else{var i=new DOMParser;r=i.parseFromString(n.text,"text/xml"),"parsererror"===r.documentElement.nodeName?(n.errors.push("500 Failed to parse XML"),n.rc=500):n.data=r}break;default:n.data=n.text}return n}function makeXhrRequest(e,t,n,r,i,o,a,s){var g=makeXhr();0==t.indexOf("//")&&(t=document.location.protocol+t),g.open(i,t,!0),n&&(g.onreadystatechange=gadgets.util.makeClosure(null,a,e,n,o,g)),null!==r?(g.setRequestHeader("Content-Type",s||"application/x-www-form-urlencoded"),g.send(r)):g.send(null)}function respondWithPreload(e,t,n){if(gadgets.io.preloaded_&&"GET"===e.httpMethod)for(var r=0;r<gadgets.io.preloaded_.length;r++){var i=gadgets.io.preloaded_[r];if(i&&i.id===e.url){if(delete gadgets.io.preloaded_[r],200!==i.rc)n({rc:i.rc,errors:[i.rc+" Error"]});else{i.oauthState&&(oauthState=i.oauthState);var o={body:i.body,rc:i.rc,headers:i.headers,oauthApprovalUrl:i.oauthApprovalUrl,oauthError:i.oauthError,oauthErrorText:i.oauthErrorText,errors:[]};n(transformResponseData(t,o))}return!0}}return!1}function init(e){config=e["core.io"]||{}}var config={},oauthState,UNPARSEABLE_CRUFT="throw 1; < don't be evil' >",requiredConfig={proxyUrl:new gadgets.config.RegExValidator(/.*%(raw)?url%.*/),jsonProxyUrl:gadgets.config.NonEmptyStringValidator};return gadgets.config.register("core.io",requiredConfig,init),{makeRequest:function(e,t,n){var r,i,o=n||{},a=o.METHOD||"GET",s=o.REFRESH_INTERVAL;o.AUTHORIZATION&&"NONE"!==o.AUTHORIZATION?(r=o.AUTHORIZATION.toLowerCase(),i=shindig.auth.getSecurityToken()):"GET"===a&&void 0===s&&(s=3600);var g=!0;"undefined"!=typeof o.OWNER_SIGNED&&(g=o.OWNER_SIGNED);var d=!0;"undefined"!=typeof o.VIEWER_SIGNED&&(d=o.VIEWER_SIGNED);var u=o.HEADERS||{};"POST"!==a||u["Content-Type"]||(u["Content-Type"]="application/x-www-form-urlencoded");var c=gadgets.util.getUrlParameters(),f={url:e,httpMethod:a,headers:gadgets.io.encodeValues(u,!1),postData:o.POST_DATA||"",authz:r||"",st:i||"",contentType:o.CONTENT_TYPE||"TEXT",numEntries:o.NUM_ENTRIES||"3",getSummaries:!!o.GET_SUMMARIES,signOwner:g,signViewer:d,gadget:c.url,container:c.container||c.synd||"default",bypassSpecCache:gadgets.util.getUrlParameters().nocache||"",getFullHeaders:!!o.GET_FULL_HEADERS};if("oauth"===r||"signed"===r){gadgets.io.oauthReceivedCallbackUrl_&&(f.OAUTH_RECEIVED_CALLBACK=gadgets.io.oauthReceivedCallbackUrl_,gadgets.io.oauthReceivedCallbackUrl_=null),f.oauthState=oauthState||"";for(var l in o)o.hasOwnProperty(l)&&0===l.indexOf("OAUTH_")&&(f[l]=o[l])}var h=config.jsonProxyUrl.replace("%host%",document.location.host);if(!respondWithPreload(f,o,t,processResponse))if("GET"===a&&s>0){var p="?refresh="+s+"&"+gadgets.io.encodeValues(f);makeXhrRequest(e,h+p,t,null,"GET",o,processResponse)}else makeXhrRequest(e,h,t,gadgets.io.encodeValues(f),"POST",o,processResponse)},makeNonProxiedRequest:function(e,t,n,r){var i=n||{};makeXhrRequest(e,e,t,i.POST_DATA,i.METHOD,i,processNonProxiedResponse,r)},clearOAuthState:function(){oauthState=void 0},encodeValues:function(e,t){var n=!t,r=[],i=!1;for(var o in e)e.hasOwnProperty(o)&&!/___$/.test(o)&&(i?r.push("&"):i=!0,r.push(n?encodeURIComponent(o):o),r.push("="),r.push(n?encodeURIComponent(e[o]):e[o]));return r.join("")},getProxyUrl:function(e){return e}}}(),gadgets.io.RequestParameters=gadgets.util.makeEnum(["METHOD","CONTENT_TYPE","POST_DATA","HEADERS","AUTHORIZATION","NUM_ENTRIES","GET_SUMMARIES","GET_FULL_HEADERS","REFRESH_INTERVAL","OAUTH_SERVICE_NAME","OAUTH_USE_TOKEN","OAUTH_TOKEN_NAME","OAUTH_REQUEST_TOKEN","OAUTH_REQUEST_TOKEN_SECRET","OAUTH_RECEIVED_CALLBACK"]),gadgets.io.MethodType=gadgets.util.makeEnum(["GET","POST","PUT","DELETE","HEAD"]),gadgets.io.ContentType=gadgets.util.makeEnum(["TEXT","DOM","JSON","FEED"]),gadgets.io.AuthorizationType=gadgets.util.makeEnum(["NONE","SIGNED","OAUTH"]);var tamings___=tamings___||[];tamings___.push(function(){caja___.whitelistFuncs([[gadgets.io,"encodeValues"],[gadgets.io,"getProxyUrl"],[gadgets.io,"makeRequest"]])}),gadgets.log=function(){function e(e,t){a>e||!s||(e===n&&s.warn?s.warn(t):e===r&&s.error?s.error(t):s.log&&s.log(t))}var t=1,n=2,r=3,i=4,o=function(n){e(t,n)};gadgets.warn=function(t){e(n,t)},gadgets.error=function(t){e(r,t)},gadgets.setLogLevel=function(e){a=e},o.INFO=t,o.WARNING=n,o.NONE=i;var a=t,s=window.console?window.console:window.opera?window.opera.postError:void 0;return o}();var tamings___=tamings___||[];tamings___.push(function(){___.grantRead(gadgets.log,"INFO"),___.grantRead(gadgets.log,"WARNING"),___.grantRead(gadgets.log,"ERROR"),___.grantRead(gadgets.log,"NONE"),caja___.whitelistFuncs([[gadgets,"log"],[gadgets,"warn"],[gadgets,"error"],[gadgets,"setLogLevel"]])}),shindig.uri=function(){var e=new RegExp("^(?:([^:/?#]+):)?(?://([^/?#]*))?([^?#]*)(?:\\?([^#]*))?(?:#(.*))?");return function(t){function n(t){if(null===t.match(e))throw"Malformed URL: "+t;v=RegExp.$1,m=RegExp.$2,y=RegExp.$3,_=RegExp.$4,I=RegExp.$5}function r(e){for(var t=[],n=0,r=e.length;r>n;++n){var i=e[n][0],o=e[n][1];void 0!==o&&t.push(S(i)+(null!==o?"="+S(o):""))}return t.join("&")}function i(){return w&&(_=r(w),w=null),_}function o(){return E&&(I=r(E),E=null),I}function a(e){return w=w||f(_),l(w,e)}function s(e){return E=E||f(I),l(E,e)}function g(e,t){return w=h(w||f(_),e,t),C}function d(e,t){return E=h(E||f(I),e,t),C}function u(){return[v,""!==v?":":"",""!==m?"//":"",m].join("")}function c(){var e=i(),t=o();return[u(),y,""!==e?"?":"",e,""!==t?"#":"",t].join("")}function f(e){for(var t=[],n=e.split("&"),r=0,i=n.length;i>r;++r){var o=n[r].split("="),a=o.shift(),s=null;o.length>0&&(s=o.join("").replace(/\+/g," ")),t.push([a,null!=s?T(s):null])}return t}function l(e,t){for(var n=0,r=e.length;r>n;++n)if(e[n][0]==t)return e[n][1];return void 0}function h(e,t,n){var r=t;
"string"==typeof t&&(r={},r[t]=n);for(var i in r){for(var o=!1,a=0,s=e.length;!o&&s>a;++a)e[a][0]==i&&(e[a][1]=r[i],o=!0);o||e.push([i,r[i]])}return e}function p(e,t){return e=e||"",e[0]===t&&(e=e.substr(t.length)),e}var v="",m="",y="",_="",w=null,I="",E=null,T=window.decodeURIComponent?decodeURIComponent:unescape,S=window.encodeURIComponent?encodeURIComponent:escape,C=null;return"object"==typeof t&&"function"==typeof t.toString?n(t.toString()):t&&n(t),C={getSchema:function(){return v},getAuthority:function(){return m},getOrigin:u,getPath:function(){return y},getQuery:i,getFragment:o,getQP:a,getFP:s,setSchema:function(e){return v=e,C},setAuthority:function(e){return m=e,C},setPath:function(e){return y=("/"===e[0]?"":"/")+e,C},setQuery:function(e){return w=null,_=p(e,"?"),C},setFragment:function(e){return E=null,I=p(e,"#"),C},setQP:g,setFP:d,setExistingP:function(e,t){return void 0!==a(e,t)&&g(e,t),void 0!==s(e,t)&&d(e,t),C},toString:c}}}(),function(){osapi._registerMethod=function(e,t){var n="undefined"!=typeof ___;if("newBatch"!=e){for(var r=e.split("."),i=osapi,o=0;o<r.length-1;o++)i[r[o]]=i[r[o]]||{},i=i[r[o]];var a=function(r){var i=osapi.newBatch(),o={};return o.execute=function(t){var r=n?___.untame(t):t,o=n?___.USELESS:this;i.add(e,this),i.execute(function(t){t.error?r.call(o,t.error):r.call(o,t[e])})},n&&___.markInnocent(o.execute,"execute"),r=r||{},r.userId=r.userId||"@viewer",r.groupId=r.groupId||"@self",o.method=e,o.transport=t,o.rpc=r,o};n&&"undefined"!=typeof ___.markInnocent&&___.markInnocent(a,e),i[r[r.length-1]]||(i[r[r.length-1]]=a)}}}(),function(){var e=function(){var e={},t=[],n=function(n,r){return r&&n&&t.push({key:n,request:r}),e},r=function(e){var t={method:e.request.method,id:e.key};return e.request.rpc&&(t.params=e.request.rpc),t},i=function(e){for(var n={},i={},o=0,a=[],s=0;s<t.length;s++){var g=t[s].request.transport;i[g.name]||(a.push(g),o++),i[g.name]=i[g.name]||[],i[g.name].push(r(t[s]))}for(var d=function(r){r.error&&(n.error=r.error);for(var i=0;i<t.length;i++){var a=t[i].key,s=r[a];s&&(n[a]=s.error?s:s.data||s.result)}o--,0===o&&e(n)},u=0;u<a.length;u++)a[u].execute(i[a[u].name],d);0==o&&window.setTimeout(function(){e(n)},0)};return e.execute=i,e.add=n,e};osapi.newBatch=e}(),function(){function e(e,t){function n(e){if(e.errors[0])t({error:{code:e.rc,message:e.text}});else{var n=e.result||e.data;if(n.error)t(n);else{for(var r={},i=0;i<n.length;i++)r[n[i].id]=n[i];t(r)}}}var r={POST_DATA:gadgets.json.stringify(e),CONTENT_TYPE:"JSON",METHOD:"POST",AUTHORIZATION:"SIGNED"},i=this.name,o=shindig.auth.getSecurityToken();o&&(i+="?st=",i+=encodeURIComponent(o)),gadgets.io.makeNonProxiedRequest(i,n,r,"application/json")}function t(t){var n=t["osapi.services"];if(n)for(var r in n)if(n.hasOwnProperty(r)&&(0==r.indexOf("http")||0==r.indexOf("//")))for(var i=r.replace("%host%",document.location.host),o={name:i,execute:e},a=n[r],s=0;s<a.length;s++)osapi._registerMethod(a[s],o)}gadgets.config&&gadgets.config.register("osapi.services",null,t)}(),gadgets&&gadgets.rpc&&!function(){function e(e,t){var n=function(e){if(e)if(e.error)t(e);else{for(var n={},r=0;r<e.length;r++)n[e[r].id]=e[r];t(n)}else t({code:500,message:"Container refused the request"})};gadgets.rpc.call("..","osapi._handleGadgetRpcMethod",n,e)}function t(t){var n={name:"gadgets.rpc",execute:e},r=t["osapi.services"];if(r)for(var i in r)if(r.hasOwnProperty(i)&&"gadgets.rpc"===i)for(var o=r[i],a=0;a<o.length;a++)osapi._registerMethod(o[a],n);if(osapi.container&&osapi.container.listMethods){var s=gadgets.util.runOnLoadHandlers,g=2,d=function(){g--,0==g&&s()};gadgets.util.runOnLoadHandlers=d,osapi.container.listMethods({}).execute(function(e){if(!e.error)for(var t=0;t<e.length;t++)"container.listMethods"!=e[t]&&osapi._registerMethod(e[t],n);d()}),window.setTimeout(d,500)}}gadgets.config&&gadgets.config.isGadget&&gadgets.config.register("osapi.services",null,t)}(),gadgets.util.registerOnLoadHandler(function(){osapi&&osapi.people&&osapi.people.get&&(osapi.people.getViewer=function(e){return e=e||{},e.userId="@viewer",e.groupId="@self",osapi.people.get(e)},osapi.people.getViewerFriends=function(e){return e=e||{},e.userId="@viewer",e.groupId="@friends",osapi.people.get(e)},osapi.people.getOwner=function(e){return e=e||{},e.userId="@owner",e.groupId="@self",osapi.people.get(e)},osapi.people.getOwnerFriends=function(e){return e=e||{},e.userId="@owner",e.groupId="@friends",osapi.people.get(e)})});var tamings___=tamings___||[];tamings___.push(function(e){___.tamesTo(osapi.newBatch,___.markFuncFreeze(function(){var e=osapi.newBatch();return ___.markInnocent(e.add,"add"),___.markInnocent(e.execute,"execute"),___.tame(e)})),e.outers.osapi=___.tame(osapi),___.grantRead(e.outers,"osapi");var t=e;gadgets.util.registerOnLoadHandler(function(){osapi&&osapi.people&&osapi.people.get&&(caja___.whitelistFuncs([[osapi.people,"getViewer"],[osapi.people,"getViewerFriends"],[osapi.people,"getOwner"],[osapi.people,"getOwnerFriends"]]),t.outers.osapi.people.getViewer=___.tame(osapi.people.getViewer),t.outers.osapi.people.getViewerFriends=___.tame(osapi.people.getViewerFriends),t.outers.osapi.people.getOwner=___.tame(osapi.people.getOwner),t.outers.osapi.people.getOwnerFriends=___.tame(osapi.people.getOwnerFriends))})}),shindig._uri=shindig.uri,shindig.uri=function(){function e(e,t){return e.getOrigin()==t.getOrigin()}function t(e,t){""==e.getSchema()&&e.setSchema(t.getSchema()),""==e.getAuthority()&&e.setAuthority(t.getAuthority());var n=e.getPath();if(""==n||"/"!=n.charAt(0)){var r=t.getPath(),i=r.lastIndexOf("/");-1!=i&&(r=r.substring(0,i+1)),e.setPath(t.getPath()+n)}}var n=shindig._uri;return shindig._uri=null,function(r){var i=n(r);return i.hasSameOrigin=function(t){return e(i,t)},i.resolve=function(e){return t(i,e)},i}}(),Function.prototype.inherits=function(e){function t(){}t.prototype=e.prototype,this.superClass_=e.prototype,this.prototype=new t,this.prototype.constructor=this},shindig.cookies={},shindig.cookies.JsType_={UNDEFINED:"undefined"},shindig.cookies.isDef=function(e){return typeof e!=shindig.cookies.JsType_.UNDEFINED},shindig.cookies.set=function(e,t,n,r,i){if(/;=/g.test(e))throw new Error('Invalid cookie name "'+e+'"');if(/;/g.test(t))throw new Error('Invalid cookie value "'+t+'"');shindig.cookies.isDef(n)||(n=-1);var o,a=i?";domain="+i:"",s=r?";path="+r:"";if(0>n)o="";else if(0===n){var g=new Date(1970,1,1);o=";expires="+g.toUTCString()}else{var d=new Date((new Date).getTime()+1e3*n);o=";expires="+d.toUTCString()}document.cookie=e+"="+t+a+s+o},shindig.cookies.get=function(e,t){for(var n=e+"=",r=String(document.cookie),i=-1;(i=r.indexOf(n,i+1))>=0;){for(var o=i;--o>=0;){var a=r.charAt(o);if(";"==a){o=-1;break}}if(-1==o){var s=r.indexOf(";",i);return 0>s&&(s=r.length),r.substring(i+n.length,s)}}return t},shindig.cookies.remove=function(e,t,n){var r=shindig.cookies.containsKey(e);return shindig.cookies.set(e,"",0,t,n),r},shindig.cookies.getKeyValues_=function(){for(var e,t,n=String(document.cookie),r=n.split(/\s*;\s*/),i=[],o=[],a=0;t=r[a];a++)e=t.indexOf("="),-1==e?(i.push(""),o.push(t)):(i.push(t.substring(0,e)),o.push(t.substring(e+1)));return{keys:i,values:o}},shindig.cookies.getKeys=function(){return shindig.cookies.getKeyValues_().keys},shindig.cookies.getValues=function(){return shindig.cookies.getKeyValues_().values},shindig.cookies.isEmpty=function(){return""===document.cookie},shindig.cookies.getCount=function(){var e=String(document.cookie);if(""===e)return 0;var t=e.split(/\s*;\s*/);return t.length},shindig.cookies.containsKey=function(e){var t={};return shindig.cookies.get(e,t)!==t},shindig.cookies.containsValue=function(e){for(var t=shindig.cookies.getKeyValues_().values,n=0;n<t.length;n++)if(t[n]==e)return!0;return!1},shindig.cookies.clear=function(){for(var e=shindig.cookies.getKeyValues_().keys,t=e.length-1;t>=0;t--)shindig.cookies.remove(e[t])},shindig.cookies.MAX_COOKIE_LENGTH=3950,shindig.errors={},shindig.errors.SUBCLASS_RESPONSIBILITY="subclass responsibility",shindig.errors.TO_BE_DONE="to be done",shindig.callAsyncAndJoin=function(e,t,n){for(var r=e.length,i=[],o=0;o<e.length;o++){var a=function(o){var a=e[o];"string"==typeof a&&(a=n[a]),a.call(n,function(e){i[o]=e,0===--r&&t(i)})};a(o)}},shindig.Extensible=function(){},shindig.Extensible.prototype.setDependencies=function(e){for(var t in e)this[t]=e[t]},shindig.Extensible.prototype.getDependencies=function(e){return this[e]},shindig.UserPrefStore=function(){},shindig.UserPrefStore.prototype.getPrefs=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.UserPrefStore.prototype.savePrefs=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.DefaultUserPrefStore=function(){shindig.UserPrefStore.call(this)},shindig.DefaultUserPrefStore.inherits(shindig.UserPrefStore),shindig.DefaultUserPrefStore.prototype.getPrefs=function(){},shindig.DefaultUserPrefStore.prototype.savePrefs=function(){},shindig.GadgetService=function(){},shindig.GadgetService.prototype.setHeight=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.GadgetService.prototype.setTitle=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.GadgetService.prototype.setUserPref=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.IfrGadgetService=function(){shindig.GadgetService.call(this),gadgets.rpc.register("resize_iframe",this.setHeight),gadgets.rpc.register("set_pref",this.setUserPref),gadgets.rpc.register("set_title",this.setTitle),gadgets.rpc.register("requestNavigateTo",this.requestNavigateTo),gadgets.rpc.register("requestSendMessage",this.requestSendMessage)},shindig.IfrGadgetService.inherits(shindig.GadgetService),shindig.IfrGadgetService.prototype.setHeight=function(e){e>shindig.container.maxheight_&&(e=shindig.container.maxheight_);var t=document.getElementById(this.f);t&&(t.style.height=e+"px")},shindig.IfrGadgetService.prototype.setTitle=function(e){var t=document.getElementById(this.f+"_title");t&&(t.innerHTML=e.replace(/&/g,"&amp;").replace(/</g,"&lt;"))},shindig.IfrGadgetService.prototype.setUserPref=function(){for(var e=shindig.container.gadgetService.getGadgetIdFromModuleId(this.f),t=shindig.container.getGadget(e),n=1,r=arguments.length;r>n;n+=2)this.userPrefs[arguments[n]].value=arguments[n+1];t.saveUserPrefs()},shindig.IfrGadgetService.prototype.requestSendMessage=function(e,t,n){n&&window.setTimeout(function(){n(new opensocial.ResponseItem(null,null,opensocial.ResponseItem.Error.NOT_IMPLEMENTED,null))},0)},shindig.IfrGadgetService.prototype.requestNavigateTo=function(e,t){var n=(shindig.container.gadgetService.getGadgetIdFromModuleId(this.f),shindig.container.gadgetService.getUrlForView(e));if(t){var r=gadgets.json.stringify(t);r.length>0&&(n+="&appParams="+encodeURIComponent(r))}n&&-1==document.location.href.indexOf(n)&&(document.location.href=n)},shindig.IfrGadgetService.prototype.getUrlForView=function(e){return"canvas"===e?"/canvas":"profile"===e?"/profile":null},shindig.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(e){return parseInt(e.match(/_([0-9]+)$/)[1],10)},shindig.LayoutManager=function(){},shindig.LayoutManager.prototype.getGadgetChrome=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.StaticLayoutManager=function(){shindig.LayoutManager.call(this)},shindig.StaticLayoutManager.inherits(shindig.LayoutManager),shindig.StaticLayoutManager.prototype.setGadgetChromeIds=function(e){this.gadgetChromeIds_=e},shindig.StaticLayoutManager.prototype.getGadgetChrome=function(e){var t=this.gadgetChromeIds_[e.id];return t?document.getElementById(t):null},shindig.FloatLeftLayoutManager=function(e){shindig.LayoutManager.call(this),this.layoutRootId_=e},shindig.FloatLeftLayoutManager.inherits(shindig.LayoutManager),shindig.FloatLeftLayoutManager.prototype.getGadgetChrome=function(){var e=document.getElementById(this.layoutRootId_);if(e){var t=document.createElement("div");return t.className="gadgets-gadget-chrome",t.style.cssFloat="left",e.appendChild(t),t}return null},shindig.Gadget=function(e){if(this.userPrefs={},e)for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);this.secureToken||(this.secureToken="john.doe:john.doe:appid:cont:url:0:default")},shindig.Gadget.prototype.getUserPrefs=function(){return this.userPrefs},shindig.Gadget.prototype.saveUserPrefs=function(){shindig.container.userPrefStore.savePrefs(this)},shindig.Gadget.prototype.getUserPrefValue=function(e){var t=this.userPrefs[e];return"undefined"!=typeof t.value&&null!=t.value?t.value:t["default"]},shindig.Gadget.prototype.render=function(e){if(e){var t=this;this.getContent(function(n){e.innerHTML=n,t.finishRender(e)})}},shindig.Gadget.prototype.getContent=function(e){shindig.callAsyncAndJoin(["getTitleBarContent","getUserPrefsDialogContent","getMainContent"],function(t){e(t.join(""))},this)},shindig.Gadget.prototype.getTitleBarContent=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Gadget.prototype.getUserPrefsDialogContent=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Gadget.prototype.getMainContent=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Gadget.prototype.finishRender=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Gadget.prototype.getAdditionalParams=function(){return""},shindig.BaseIfrGadget=function(e){shindig.Gadget.call(this,e),this.serverBase_="/gadgets/",this.queryIfrGadgetType_()},shindig.BaseIfrGadget.inherits(shindig.Gadget),shindig.BaseIfrGadget.prototype.GADGET_IFRAME_PREFIX_="remote_iframe_",shindig.BaseIfrGadget.prototype.CONTAINER="default",shindig.BaseIfrGadget.prototype.cssClassGadget="gadgets-gadget",shindig.BaseIfrGadget.prototype.cssClassTitleBar="gadgets-gadget-title-bar",shindig.BaseIfrGadget.prototype.cssClassTitle="gadgets-gadget-title",shindig.BaseIfrGadget.prototype.cssClassTitleButtonBar="gadgets-gadget-title-button-bar",shindig.BaseIfrGadget.prototype.cssClassGadgetUserPrefsDialog="gadgets-gadget-user-prefs-dialog",shindig.BaseIfrGadget.prototype.cssClassGadgetUserPrefsDialogActionBar="gadgets-gadget-user-prefs-dialog-action-bar",shindig.BaseIfrGadget.prototype.cssClassTitleButton="gadgets-gadget-title-button",shindig.BaseIfrGadget.prototype.cssClassGadgetContent="gadgets-gadget-content",shindig.BaseIfrGadget.prototype.rpcToken=2147483647*Math.random()|0,shindig.BaseIfrGadget.prototype.rpcRelay="../container/rpc_relay.html",shindig.BaseIfrGadget.prototype.getTitleBarContent=function(e){var t=this.hasViewablePrefs_()?'<a href="#" onclick="shindig.container.getGadget('+this.id+').handleOpenUserPrefsDialog();return false;" class="'+this.cssClassTitleButton+'">settings</a> ':"";e('<div id="'+this.cssClassTitleBar+"-"+this.id+'" class="'+this.cssClassTitleBar+'"><span id="'+this.getIframeId()+'_title" class="'+this.cssClassTitle+'">'+(this.title?this.title:"Title")+'</span> | <span class="'+this.cssClassTitleButtonBar+'">'+t+'<a href="#" onclick="shindig.container.getGadget('+this.id+').handleToggle();return false;" class="'+this.cssClassTitleButton+'">toggle</a></span></div>')},shindig.BaseIfrGadget.prototype.getUserPrefsDialogContent=function(e){e('<div id="'+this.getUserPrefsDialogId()+'" class="'+this.cssClassGadgetUserPrefsDialog+'"></div>')},shindig.BaseIfrGadget.prototype.setServerBase=function(e){this.serverBase_=e},shindig.BaseIfrGadget.prototype.getServerBase=function(){return this.serverBase_},shindig.BaseIfrGadget.prototype.getMainContent=function(e){var t=this;window.setTimeout(function(){t.getMainContent(e)},0)},shindig.BaseIfrGadget.prototype.getIframeId=function(){return this.GADGET_IFRAME_PREFIX_+this.id},shindig.BaseIfrGadget.prototype.getUserPrefsDialogId=function(){return this.getIframeId()+"_userPrefsDialog"},shindig.BaseIfrGadget.prototype.getUserPrefsParams=function(){var e="";for(var t in this.getUserPrefs())e+="&up_"+encodeURIComponent(t)+"="+encodeURIComponent(this.getUserPrefValue(t));return e},shindig.BaseIfrGadget.prototype.handleToggle=function(){var e=document.getElementById(this.getIframeId());if(e){var t=e.parentNode,n=t.style.display;t.style.display=n?"":"none"}},shindig.BaseIfrGadget.prototype.hasViewablePrefs_=function(){for(var e in this.getUserPrefs()){var t=this.userPrefs[e];if("hidden"!=t.type)return!0}return!1},shindig.BaseIfrGadget.prototype.handleOpenUserPrefsDialog=function(){if(this.userPrefsDialogContentLoaded)this.showUserPrefsDialog();else{var e=this,t="ig_callback_"+this.id;window[t]=function(t){e.userPrefsDialogContentLoaded=!0,e.buildUserPrefsDialog(t),e.showUserPrefsDialog()};var n=document.createElement("script");n.src="http://www.gmodules.com/ig/gadgetsettings?mid="+this.id+"&output=js"+this.getUserPrefsParams()+"&url="+this.specUrl,document.body.appendChild(n)}},shindig.BaseIfrGadget.prototype.buildUserPrefsDialog=function(e){var t=document.getElementById(this.getUserPrefsDialogId());t.innerHTML=e+'<div class="'+this.cssClassGadgetUserPrefsDialogActionBar+'"><input type="button" value="Save" onclick="shindig.container.getGadget('+this.id+').handleSaveUserPrefs()"> <input type="button" value="Cancel" onclick="shindig.container.getGadget('+this.id+').handleCancelUserPrefs()"></div>',t.childNodes[0].style.display=""},shindig.BaseIfrGadget.prototype.showUserPrefsDialog=function(e){var t=document.getElementById(this.getUserPrefsDialogId());t.style.display=e||void 0===e?"":"none"},shindig.BaseIfrGadget.prototype.hideUserPrefsDialog=function(){this.showUserPrefsDialog(!1)},shindig.BaseIfrGadget.prototype.handleSaveUserPrefs=function(){this.hideUserPrefsDialog();for(var e=document.getElementById("m_"+this.id+"_numfields").value,t=0;e>t;t++){var n=document.getElementById("m_"+this.id+"_"+t),r="m_"+this.id+"_up_",i=n.name.substring(r.length),o=n.value;this.userPrefs[i].value=o}this.saveUserPrefs(),this.refresh()},shindig.BaseIfrGadget.prototype.handleCancelUserPrefs=function(){this.hideUserPrefsDialog()},shindig.BaseIfrGadget.prototype.refresh=function(){var e=this.getIframeId();document.getElementById(e).src=this.getIframeUrl()},shindig.BaseIfrGadget.prototype.queryIfrGadgetType_=function(){function e(e){for(var t=!1,n=e.data.gadgets[0].features,r=0;r<n.length;r++)if("pubsub-2"===n[r]){t=!0;break}var o=t?shindig.OAAIfrGadget:shindig.IfrGadget;for(var a in o)o.hasOwnProperty(a)&&(i[a]=o[a])}var t={context:{country:"default",language:"default",view:"default",container:"default"},gadgets:[{url:this.specUrl,moduleId:1}]},n={CONTENT_TYPE:"JSON",METHOD:"POST",POST_DATA:gadgets.json.stringify(t)},r=this.serverBase_+"metadata?st="+this.secureToken;gadgets.io.makeNonProxiedRequest(r,e,n,"application/javascript");var i=this},shindig.IfrGadget={getMainContent:function(e){var t=this.getIframeId();gadgets.rpc.setRelayUrl(t,this.serverBase_+this.rpcRelay),gadgets.rpc.setAuthToken(t,this.rpcToken),e('<div class="'+this.cssClassGadgetContent+'"><iframe id="'+t+'" name="'+t+'" class="'+this.cssClassGadget+'" src="about:blank" frameborder="no" scrolling="no"'+(this.height?' height="'+this.height+'"':"")+(this.width?' width="'+this.width+'"':"")+"></iframe></div>")},finishRender:function(){window.frames[this.getIframeId()].location=this.getIframeUrl()},getIframeUrl:function(){return this.serverBase_+"ifr?container="+this.CONTAINER+"&mid="+this.id+"&nocache="+shindig.container.nocache_+"&country="+shindig.container.country_+"&lang="+shindig.container.language_+"&view="+shindig.container.view_+(this.specVersion?"&v="+this.specVersion:"")+(shindig.container.parentUrl_?"&parent="+encodeURIComponent(shindig.container.parentUrl_):"")+(this.debug?"&debug=1":"")+this.getAdditionalParams()+this.getUserPrefsParams()+(this.secureToken?"&st="+this.secureToken:"")+"&url="+encodeURIComponent(this.specUrl)+"#rpctoken="+this.rpcToken+(this.viewParams?"&view-params="+encodeURIComponent(gadgets.json.stringify(this.viewParams)):"")+(this.hashData?"&"+this.hashData:"")}},shindig.OAAIfrGadget={getMainContent:function(e){e('<div id="'+this.cssClassGadgetContent+"-"+this.id+'" class="'+this.cssClassGadgetContent+'"></div>')},finishRender:function(){var e={className:this.cssClassGadget,frameborder:"no",scrolling:"no"};this.height&&(e.height=this.height),this.width&&(e.width=this.width),new OpenAjax.hub.IframeContainer(gadgets.pubsub2router.hub,this.getIframeId(),{Container:{onSecurityAlert:function(e,t){gadgets.error("Security error for container "+e.getClientID()+" : "+t),e.getIframe().src="about:blank"}},IframeContainer:{parent:document.getElementById(this.cssClassGadgetContent+"-"+this.id),uri:this.getIframeUrl(),tunnelURI:shindig.uri(this.serverBase_+this.rpcRelay).resolve(shindig.uri(window.location.href)),iframeAttrs:e}})},getIframeUrl:function(){return this.serverBase_+"ifr?container="+this.CONTAINER+"&mid="+this.id+"&nocache="+shindig.container.nocache_+"&country="+shindig.container.country_+"&lang="+shindig.container.language_+"&view="+shindig.container.view_+(this.specVersion?"&v="+this.specVersion:"")+(this.debug?"&debug=1":"")+this.getAdditionalParams()+this.getUserPrefsParams()+(this.secureToken?"&st="+this.secureToken:"")+"&url="+encodeURIComponent(this.specUrl)+(this.viewParams?"&view-params="+encodeURIComponent(gadgets.json.stringify(this.viewParams)):"")+(this.hashData?"#"+this.hashData:"")}},shindig.Container=function(){this.gadgets_={},this.parentUrl_=document.location.href+"://"+document.location.host,this.country_="ALL",this.language_="ALL",this.view_="default",this.nocache_=1,this.maxheight_=2147483647},shindig.Container.inherits(shindig.Extensible),shindig.Container.prototype.gadgetClass=shindig.Gadget,shindig.Container.prototype.userPrefStore=new shindig.DefaultUserPrefStore,shindig.Container.prototype.gadgetService=new shindig.GadgetService,shindig.Container.prototype.layoutManager=new shindig.StaticLayoutManager,shindig.Container.prototype.setParentUrl=function(e){this.parentUrl_=e},shindig.Container.prototype.setCountry=function(e){this.country_=e},shindig.Container.prototype.setNoCache=function(e){this.nocache_=e},shindig.Container.prototype.setLanguage=function(e){this.language_=e},shindig.Container.prototype.setView=function(e){this.view_=e},shindig.Container.prototype.setMaxHeight=function(e){this.maxheight_=e},shindig.Container.prototype.getGadgetKey_=function(e){return"gadget_"+e},shindig.Container.prototype.getGadget=function(e){return this.gadgets_[this.getGadgetKey_(e)]},shindig.Container.prototype.createGadget=function(e){return new this.gadgetClass(e)},shindig.Container.prototype.addGadget=function(e){e.id=this.getNextGadgetInstanceId(),this.gadgets_[this.getGadgetKey_(e.id)]=e},shindig.Container.prototype.addGadgets=function(e){for(var t=0;t<e.length;t++)this.addGadget(e[t])},shindig.Container.prototype.renderGadgets=function(){for(var e in this.gadgets_)this.renderGadget(this.gadgets_[e])},shindig.Container.prototype.renderGadget=function(){throw Error(shindig.errors.SUBCLASS_RESPONSIBILITY)},shindig.Container.prototype.nextGadgetInstanceId_=0,shindig.Container.prototype.getNextGadgetInstanceId=function(){return this.nextGadgetInstanceId_++},shindig.Container.prototype.refreshGadgets=function(){for(var e in this.gadgets_)this.gadgets_[e].refresh()},shindig.IfrContainer=function(){shindig.Container.call(this)},shindig.IfrContainer.inherits(shindig.Container),shindig.IfrContainer.prototype.gadgetClass=shindig.BaseIfrGadget,shindig.IfrContainer.prototype.gadgetService=new shindig.IfrGadgetService,shindig.IfrContainer.prototype.setParentUrl=function(e){e.match(/^http[s]?:\/\//)||(e=document.location.href.match(/^[^?#]+\//)[0]+e),this.parentUrl_=e},shindig.IfrContainer.prototype.renderGadget=function(e){var t=this.layoutManager.getGadgetChrome(e);e.render(t)},shindig.container=new shindig.IfrContainer,gadgets&&gadgets.rpc&&(osapi._handleGadgetRpcMethod=function(e){for(var t=new Array(e.length),n=0,r=this.callback,i=function(e,t){t({})},o=0;o<e.length;o++){var a=osapi;if(-1==e[o].method.indexOf("_"))for(var s=e[o].method.split("."),g=0;g<s.length;g++){if(!a.hasOwnProperty(s[g])){a=i;break}a=a[s[g]]}else a=i;a(e[o].params,function(i){return function(o){t[i]={id:e[i].id,data:o},n++,n==e.length&&r(t)}}(o))}},osapi.container={},osapi.container.listMethods=function(e,t){var n=[];recurseNames(osapi,"",5,n),t(n)},gadgets.rpc.register("osapi._handleGadgetRpcMethod",osapi._handleGadgetRpcMethod)),gadgets.config.init({"shindig.auth":{},osapi:{endPoints:["https://%host%/rpc"]},"osapi.services":{"gadgets.rpc":["container.listMethods"],"https://%host%/rpc":["activities.supportedFields","activities.update","gadgets.metadata","activities.delete","activities.get","appdata.update","http.put","http.post","gadgets.tokenSupportedFields","appdata.get","activities.create","system.listMethods","cache.invalidate","groups.get","people.supportedFields","http.get","http.head","appdata.delete","http.delete","aipo.version","gadgets.token","appdata.create","people.get","gadgets.supportedFields"]},rpc:{parentRelayUrl:"/gadgets/files/container/rpc_relay.html",useLegacyProtocol:!1},"core.io":{proxyUrl:"//%host%/gadgets/proxy?container=default&refresh=%refresh%&url=%url%%rewriteMime%",jsonProxyUrl:"//%host%/gadgets/makeRequest"}});