dojo._hasResource["dojo.dnd.Container"]||(dojo._hasResource["dojo.dnd.Container"]=!0,dojo.provide("dojo.dnd.Container"),dojo.require("dojo.dnd.common"),dojo.require("dojo.parser"),dojo.declare("dojo.dnd.Container",null,{skipForm:!1,constructor:function(t,e){this.node=dojo.byId(t),e||(e={}),this.creator=e.creator||null,this.skipForm=e.skipForm,this.defaultCreator=dojo.dnd._defaultCreator(this.node),this.map={},this.current=null,this.containerState="",dojo.addClass(this.node,"dojoDndContainer"),e&&e._skipStartup||this.startup(),this.events=[dojo.connect(this.node,"onmouseover",this,"onMouseOver"),dojo.connect(this.node,"onmouseout",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",this,"onSelectStart"),dojo.connect(this.node,"onselectstart",this,"onSelectStart")]},creator:function(){},getItem:function(t){return this.map[t]},setItem:function(t,e){this.map[t]=e},delItem:function(t){delete this.map[t]},forInItems:function(t,e){e=e||dojo.global;var o=this.map,n=dojo.dnd._empty;for(var d in this.map)d in n||t.call(e,o[d],d,o)},clearItems:function(){this.map={}},getAllNodes:function(){return dojo.query("> .dojoDndItem",this.parent)},insertNodes:function(t,e,o){if(this.parent.firstChild?e?o||(o=this.parent.firstChild):o&&(o=o.nextSibling):o=null,o)for(var n=0;n<t.length;++n){var d=this._normalizedCreator(t[n]);this.setItem(d.node.id,{data:d.data,type:d.type}),this.parent.insertBefore(d.node,o)}else for(var n=0;n<t.length;++n){var d=this._normalizedCreator(t[n]);this.setItem(d.node.id,{data:d.data,type:d.type}),this.parent.appendChild(d.node)}return this},destroy:function(){dojo.forEach(this.events,dojo.disconnect),this.clearItems(),this.node=this.parent=this.current},markupFactory:function(t,e){return t._skipStartup=!0,new dojo.dnd.Container(e,t)},startup:function(){if(this.parent=this.node,"table"==this.parent.tagName.toLowerCase()){var t=this.parent.getElementsByTagName("tbody");t&&t.length&&(this.parent=t[0])}dojo.query("> .dojoDndItem",this.parent).forEach(function(t){t.id||(t.id=dojo.dnd.getUniqueId());var e=t.getAttribute("dndType"),o=t.getAttribute("dndData");this.setItem(t.id,{data:o?o:t.innerHTML,type:e?e.split(/\s*,\s*/):["text"]})},this)},onMouseOver:function(t){for(var e=t.relatedTarget;e&&e!=this.node;)try{e=e.parentNode}catch(o){e=null}e||(this._changeState("Container","Over"),this.onOverEvent()),e=this._getChildByEvent(t),this.current!=e&&(this.current&&this._removeItemClass(this.current,"Over"),e&&this._addItemClass(e,"Over"),this.current=e)},onMouseOut:function(t){for(var e=t.relatedTarget;e;){if(e==this.node)return;try{e=e.parentNode}catch(o){e=null}}this.current&&(this._removeItemClass(this.current,"Over"),this.current=null),this._changeState("Container",""),this.onOutEvent()},onSelectStart:function(t){this.skipForm&&dojo.dnd.isFormElement(t)||dojo.stopEvent(t)},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(t,e){var o="dojoDnd"+t,n=t.toLowerCase()+"State";dojo.removeClass(this.node,o+this[n]),dojo.addClass(this.node,o+e),this[n]=e},_addItemClass:function(t,e){dojo.addClass(t,"dojoDndItem"+e)},_removeItemClass:function(t,e){dojo.removeClass(t,"dojoDndItem"+e)},_getChildByEvent:function(t){var e=t.target;if(e)for(var o=e.parentNode;o;e=o,o=e.parentNode)if(o==this.parent&&dojo.hasClass(e,"dojoDndItem"))return e;return null},_normalizedCreator:function(t,e){var o=(this.creator?this.creator:this.defaultCreator)(t,e);return dojo.isArray(o.type)||(o.type=["text"]),o.node.id||(o.node.id=dojo.dnd.getUniqueId()),dojo.addClass(o.node,"dojoDndItem"),o}}),dojo.dnd._createNode=function(t){return t?function(e){var o=dojo.doc.createElement(t);return o.innerHTML=e,o}:dojo.dnd._createSpan},dojo.dnd._createTrTd=function(t){var e=dojo.doc.createElement("tr"),o=dojo.doc.createElement("td");return o.innerHTML=t,e.appendChild(o),e},dojo.dnd._createSpan=function(t){var e=dojo.doc.createElement("span");return e.innerHTML=t,e},dojo.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"},dojo.dnd._defaultCreator=function(t){var e=t.tagName.toLowerCase(),o="table"==e?dojo.dnd._createTrTd:dojo.dnd._createNode(dojo.dnd._defaultCreatorNodes[e]);return function(t,e){var n=dojo.isObject(t)&&t,d=n&&t.data?t.data:t,r=n&&t.type?t.type:["text"],a=String(d),i=("avatar"==e?dojo.dnd._createSpan:o)(a);return i.id=dojo.dnd.getUniqueId(),{node:i,data:d,type:r}}});