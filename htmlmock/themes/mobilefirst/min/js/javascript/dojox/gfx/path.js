dojo._hasResource["dojox.gfx.path"]||(dojo._hasResource["dojox.gfx.path"]=!0,dojo.provide("dojox.gfx.path"),dojo.require("dojox.gfx.shape"),dojo.declare("dojox.gfx.path.Path",dojox.gfx.Shape,{constructor:function(t){this.shape=dojo.clone(dojox.gfx.defaultPath),this.segments=[],this.absolute=!0,this.last={},this.rawNode=t},setAbsoluteMode:function(t){return this.absolute="string"==typeof t?"absolute"==t:t,this},getAbsoluteMode:function(){return this.absolute},getBoundingBox:function(){return this.bbox&&"l"in this.bbox?{x:this.bbox.l,y:this.bbox.t,width:this.bbox.r-this.bbox.l,height:this.bbox.b-this.bbox.t}:null},getLastPosition:function(){return"x"in this.last?this.last:null},_updateBBox:function(t,s){this.bbox&&"l"in this.bbox?(this.bbox.l>t&&(this.bbox.l=t),this.bbox.r<t&&(this.bbox.r=t),this.bbox.t>s&&(this.bbox.t=s),this.bbox.b<s&&(this.bbox.b=s)):this.bbox={l:t,b:s,r:t,t:s}},_updateWithSegment:function(t){var s=t.args,e=s.length;switch(t.action){case"M":case"L":case"C":case"S":case"Q":case"T":for(var h=0;e>h;h+=2)this._updateBBox(s[h],s[h+1]);this.last.x=s[e-2],this.last.y=s[e-1],this.absolute=!0;break;case"H":for(var h=0;e>h;++h)this._updateBBox(s[h],this.last.y);this.last.x=s[e-1],this.absolute=!0;break;case"V":for(var h=0;e>h;++h)this._updateBBox(this.last.x,s[h]);this.last.y=s[e-1],this.absolute=!0;break;case"m":var o=0;"x"in this.last||(this._updateBBox(this.last.x=s[0],this.last.y=s[1]),o=2);for(var h=o;e>h;h+=2)this._updateBBox(this.last.x+=s[h],this.last.y+=s[h+1]);this.absolute=!1;break;case"l":case"t":for(var h=0;e>h;h+=2)this._updateBBox(this.last.x+=s[h],this.last.y+=s[h+1]);this.absolute=!1;break;case"h":for(var h=0;e>h;++h)this._updateBBox(this.last.x+=s[h],this.last.y);this.absolute=!1;break;case"v":for(var h=0;e>h;++h)this._updateBBox(this.last.x,this.last.y+=s[h]);this.absolute=!1;break;case"c":for(var h=0;e>h;h+=6)this._updateBBox(this.last.x+s[h],this.last.y+s[h+1]),this._updateBBox(this.last.x+s[h+2],this.last.y+s[h+3]),this._updateBBox(this.last.x+=s[h+4],this.last.y+=s[h+5]);this.absolute=!1;break;case"s":case"q":for(var h=0;e>h;h+=4)this._updateBBox(this.last.x+s[h],this.last.y+s[h+1]),this._updateBBox(this.last.x+=s[h+2],this.last.y+=s[h+3]);this.absolute=!1;break;case"A":for(var h=0;e>h;h+=7)this._updateBBox(s[h+5],s[h+6]);this.last.x=s[e-2],this.last.y=s[e-1],this.absolute=!0;break;case"a":for(var h=0;e>h;h+=7)this._updateBBox(this.last.x+=s[h+5],this.last.y+=s[h+6]);this.absolute=!1}for(var i=[t.action],h=0;e>h;++h)i.push(dojox.gfx.formatNumber(s[h],!0));if("string"==typeof this.shape.path)this.shape.path+=i.join("");else for(var e=i.length,a=this.shape.path,h=0;e>h;++h)a.push(i[h])},_validSegments:{m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},_pushSegment:function(t,s){var e=this._validSegments[t.toLowerCase()];if("number"==typeof e)if(e){if(s.length>=e){var h={action:t,args:s.slice(0,s.length-s.length%e)};this.segments.push(h),this._updateWithSegment(h)}}else{var h={action:t,args:[]};this.segments.push(h),this._updateWithSegment(h)}},_collectArgs:function(t,s){for(var e=0;e<s.length;++e){var h=s[e];"boolean"==typeof h?t.push(h?1:0):"number"==typeof h?t.push(h):h instanceof Array?this._collectArgs(t,h):"x"in h&&"y"in h&&t.push(h.x,h.y)}},moveTo:function(){var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"M":"m",t),this},lineTo:function(){var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"L":"l",t),this},hLineTo:function(){var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"H":"h",t),this},vLineTo:function(){var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"V":"v",t),this},curveTo:function(){var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"C":"c",t),this},smoothCurveTo:function(){var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"S":"s",t),this},qCurveTo:function(){var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"Q":"q",t),this},qSmoothCurveTo:function(){var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"T":"t",t),this},arcTo:function(){var t=[];return this._collectArgs(t,arguments),this._pushSegment(this.absolute?"A":"a",t),this},closePath:function(){return this._pushSegment("Z",[]),this},_setPath:function(t){var s=dojo.isArray(t)?t:t.match(dojox.gfx.pathSvgRegExp);if(this.segments=[],this.absolute=!0,this.bbox={},this.last={},s){for(var e="",h=[],o=s.length,i=0;o>i;++i){var a=s[i],r=parseFloat(a);isNaN(r)?(e&&this._pushSegment(e,h),h=[],e=a):h.push(r)}this._pushSegment(e,h)}},setShape:function(t){dojox.gfx.Shape.prototype.setShape.call(this,"string"==typeof t?{path:t}:t);var s=this.shape.path;return this.shape.path=[],this._setPath(s),this.shape.path=this.shape.path.join(""),this},_2PI:2*Math.PI}),dojo.declare("dojox.gfx.path.TextPath",dojox.gfx.path.Path,{constructor:function(){"text"in this||(this.text=dojo.clone(dojox.gfx.defaultTextPath)),"fontStyle"in this||(this.fontStyle=dojo.clone(dojox.gfx.defaultFont))},setText:function(t){return this.text=dojox.gfx.makeParameters(this.text,"string"==typeof t?{text:t}:t),this._setText(),this},setFont:function(t){return this.fontStyle="string"==typeof t?dojox.gfx.splitFontString(t):dojox.gfx.makeParameters(dojox.gfx.defaultFont,t),this._setFont(),this}}));