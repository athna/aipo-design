dojo._hasResource["dojox.grid._grid.edit"]||(dojo._hasResource["dojox.grid._grid.edit"]=!0,dojo.provide("dojox.grid._grid.edit"),dojo.declare("dojox.grid.edit",null,{constructor:function(i){this.grid=i,this.connections=[],dojo.isIE&&this.connections.push(dojo.connect(document.body,"onfocus",dojo.hitch(this,"_boomerangFocus")))},info:{},destroy:function(){dojo.forEach(this.connections,function(i){dojo.disconnect(i)})},cellFocus:function(i,t){this.grid.singleClickEdit||this.isEditRow(t)?this.setEditCell(i,t):this.apply(),(this.isEditing()||i&&(i.editor||0).alwaysOn)&&this._focusEditor(i,t)},rowClick:function(i){this.isEditing()&&!this.isEditRow(i.rowIndex)&&this.apply()},styleRow:function(i){i.index==this.info.rowIndex&&(i.customClasses+=" dojoxGrid-row-editing")},dispatchEvent:function(i){var t=i.cell,o=t&&t.editor;return o&&o.dispatchEvent(i.dispatch,i)},isEditing:function(){return void 0!==this.info.rowIndex},isEditCell:function(i,t){return this.info.rowIndex===i&&this.info.cell.index==t},isEditRow:function(i){return this.info.rowIndex===i},setEditCell:function(i,t){this.isEditCell(t,i.index)||this.start(i,t,this.isEditRow(t)||i.editor)},_focusEditor:function(i,t){dojox.grid.fire(i.editor,"focus",[t])},focusEditor:function(){this.isEditing()&&this._focusEditor(this.info.cell,this.info.rowIndex)},_boomerangWindow:500,_shouldCatchBoomerang:function(){return this._catchBoomerang>(new Date).getTime()},_boomerangFocus:function(){this._shouldCatchBoomerang()&&(this.grid.focus.focusGrid(),this.focusEditor(),this._catchBoomerang=0)},_doCatchBoomerang:function(){dojo.isIE&&(this._catchBoomerang=(new Date).getTime()+this._boomerangWindow)},start:function(i,t,o){this.grid.beginUpdate(),this.editorApply(),this.isEditing()&&!this.isEditRow(t)&&(this.applyRowEdit(),this.grid.updateRow(t)),o?(this.info={cell:i,rowIndex:t},this.grid.doStartEdit(i,t),this.grid.updateRow(t)):this.info={},this.grid.endUpdate(),this.grid.focus.focusGrid(),this._focusEditor(i,t),this._doCatchBoomerang()},_editorDo:function(i){var t=this.info.cell;t&&t.editor&&t.editor[i](this.info.rowIndex)},editorApply:function(){this._editorDo("apply")},editorCancel:function(){this._editorDo("cancel")},applyCellEdit:function(i,t,o){this.grid.doApplyCellEdit(i,o,t.fieldIndex)},applyRowEdit:function(){this.grid.doApplyEdit(this.info.rowIndex)},apply:function(){this.isEditing()&&(this.grid.beginUpdate(),this.editorApply(),this.applyRowEdit(),this.info={},this.grid.endUpdate(),this.grid.focus.focusGrid(),this._doCatchBoomerang())},cancel:function(){this.isEditing()&&(this.grid.beginUpdate(),this.editorCancel(),this.info={},this.grid.endUpdate(),this.grid.focus.focusGrid(),this._doCatchBoomerang())},save:function(i,t){var o=this.info.cell;!this.isEditRow(i)||t&&o.view!=t||!o.editor||o.editor.save(o,this.info.rowIndex)},restore:function(i,t){var o=this.info.cell;this.isEditRow(t)&&o.view==i&&o.editor&&o.editor.restore(o,this.info.rowIndex)}}));