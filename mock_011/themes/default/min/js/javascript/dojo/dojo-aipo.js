dojo._hasResource["dojo.date"]||(dojo._hasResource["dojo.date"]=!0,dojo.provide("dojo.date"),dojo.date.getDaysInMonth=function(e){var t=e.getMonth(),o=[31,28,31,30,31,30,31,31,30,31,30,31];return 1==t&&dojo.date.isLeapYear(e)?29:o[t]},dojo.date.isLeapYear=function(e){var t=e.getFullYear();return!(t%400&&(t%4||!(t%100)))},dojo.date.getTimezoneName=function(e){var t,o=e.toString(),n="",r=o.indexOf("(");if(r>-1)n=o.substring(++r,o.indexOf(")"));else{var a=/([A-Z\/]+) \d{4}$/;(t=o.match(a))?n=t[1]:(o=e.toLocaleString(),a=/ ([A-Z\/]+)$/,(t=o.match(a))&&(n=t[1]))}return"AM"==n||"PM"==n?"":n},dojo.date.compare=function(e,t,o){return e=new Date(Number(e)),t=new Date(Number(t||new Date)),"undefined"!=typeof o&&("date"==o?(e.setHours(0,0,0,0),t.setHours(0,0,0,0)):"time"==o&&(e.setFullYear(0,0,0),t.setFullYear(0,0,0))),e>t?1:t>e?-1:0},dojo.date.add=function(e,t,o){var n=new Date(Number(e)),r=!1,a="Date";switch(t){case"day":break;case"weekday":var i,s,d=0,l=o%5;l?(i=l,s=parseInt(o/5)):(i=o>0?5:-5,s=o>0?(o-5)/5:(o+5)/5);var c=e.getDay();6==c&&o>0?d=1:0==c&&0>o&&(d=-1);var h=c+i;(0==h||6==h)&&(d=o>0?2:-2),o=7*s+i+d;break;case"year":a="FullYear",r=!0;break;case"week":o*=7;break;case"quarter":o*=3;case"month":r=!0,a="Month";break;case"hour":case"minute":case"second":case"millisecond":a="UTC"+t.charAt(0).toUpperCase()+t.substring(1)+"s"}return a&&n["set"+a](n["get"+a]()+o),r&&n.getDate()<e.getDate()&&n.setDate(0),n},dojo.date.difference=function(e,t,o){t=t||new Date,o=o||"day";var n=t.getFullYear()-e.getFullYear(),r=1;switch(o){case"quarter":var a=e.getMonth(),i=t.getMonth(),s=Math.floor(a/3)+1,d=Math.floor(i/3)+1;d+=4*n,r=d-s;break;case"weekday":var l=Math.round(dojo.date.difference(e,t,"day")),c=parseInt(dojo.date.difference(e,t,"week")),h=l%7;if(0==h)l=5*c;else{var u=0,f=e.getDay(),m=t.getDay();c=parseInt(l/7),h=l%7;var j=new Date(e);j.setDate(j.getDate()+7*c);var p=j.getDay();if(l>0)switch(!0){case 6==f:u=-1;break;case 0==f:u=0;break;case 6==m:u=-1;break;case 0==m:u=-2;break;case p+h>5:u=-2}else if(0>l)switch(!0){case 6==f:u=0;break;case 0==f:u=1;break;case 6==m:u=2;break;case 0==m:u=1;break;case 0>p+h:u=2}l+=u,l-=2*c}r=l;break;case"year":r=n;break;case"month":r=t.getMonth()-e.getMonth()+12*n;break;case"week":r=parseInt(dojo.date.difference(e,t,"day")/7);break;case"day":r/=24;case"hour":r/=60;case"minute":r/=60;case"second":r/=1e3;case"millisecond":r*=t.getTime()-e.getTime()}return Math.round(r)}),dojo._hasResource["dojo.fx"]||(dojo._hasResource["dojo.fx"]=!0,dojo.provide("dojo.fx"),dojo.provide("dojo.fx.Toggler"),dojo.fx.chain=function(e){var t=e.shift(),o=t;return dojo.forEach(e,function(e){dojo.connect(o,"onEnd",e,"play"),o=e}),t},dojo.fx.combine=function(e){var t=new dojo._Animation({curve:[0,1]});return e.length?(t.duration=e[0].duration,dojo.forEach(e,function(e){dojo.forEach(["play","pause","stop"],function(o){e[o]&&dojo.connect(t,o,e,o)})}),t):t},dojo.declare("dojo.fx.Toggler",null,{constructor:function(e){var t=this;dojo.mixin(t,e),t.node=e.node,t._showArgs=dojo.mixin({},e),t._showArgs.node=t.node,t._showArgs.duration=t.showDuration,t.showAnim=t.showFunc(t._showArgs),t._hideArgs=dojo.mixin({},e),t._hideArgs.node=t.node,t._hideArgs.duration=t.hideDuration,t.hideAnim=t.hideFunc(t._hideArgs),dojo.connect(t.showAnim,"beforeBegin",dojo.hitch(t.hideAnim,"stop",!0)),dojo.connect(t.hideAnim,"beforeBegin",dojo.hitch(t.showAnim,"stop",!0))},node:null,showFunc:dojo.fadeIn,hideFunc:dojo.fadeOut,showDuration:200,hideDuration:200,show:function(e){return this.showAnim.play(e||0)},hide:function(e){return this.hideAnim.play(e||0)}}),dojo.fx.wipeIn=function(e){e.node=dojo.byId(e.node);var t=e.node,o=t.style,n=dojo.animateProperty(dojo.mixin({properties:{height:{start:function(){if(o.overflow="hidden","hidden"==o.visibility||"none"==o.display)return o.height="1px",o.display="",o.visibility="",1;var e=dojo.style(t,"height");return Math.max(e,1)},end:function(){return t.scrollHeight}}}},e));return dojo.connect(n,"onEnd",function(){o.height="auto"}),n},dojo.fx.wipeOut=function(e){var t=e.node=dojo.byId(e.node),o=t.style,n=dojo.animateProperty(dojo.mixin({properties:{height:{end:1}}},e));return dojo.connect(n,"beforeBegin",function(){o.overflow="hidden",o.display=""}),dojo.connect(n,"onEnd",function(){o.height="auto",o.display="none"}),n},dojo.fx.slideTo=function(e){var t=e.node=dojo.byId(e.node),o=null,n=null,r=function(e){return function(){var t=dojo.getComputedStyle(e),r=t.position;if(o="absolute"==r?e.offsetTop:parseInt(t.top)||0,n="absolute"==r?e.offsetLeft:parseInt(t.left)||0,"absolute"!=r&&"relative"!=r){var a=dojo.coords(e,!0);o=a.y,n=a.x,e.style.position="absolute",e.style.top=o+"px",e.style.left=n+"px"}}}(t);r();var a=dojo.animateProperty(dojo.mixin({properties:{top:{end:e.top||0},left:{end:e.left||0}}},e));return dojo.connect(a,"beforeBegin",a,r),a}),dojo._hasResource["dojo.i18n"]||(dojo._hasResource["dojo.i18n"]=!0,dojo.provide("dojo.i18n"),dojo.i18n.getLocalization=function(e,t,o){o=dojo.i18n.normalizeLocale(o);var n=o.split("-"),r=[e,"nls",t].join("."),a=dojo._loadedModules[r];if(a){var i,s=n[0].match(/ja|en/i)?n[0]:null;if(s&&a[s]&&(i=a[s]),i||(i=a.ROOT),i){var d=function(){};return d.prototype=i,new d}}throw new Error("Bundle not found: "+t+" in "+e+" , locale="+o)},dojo.i18n.normalizeLocale=function(e){var t=e?e.toLowerCase():dojo.locale;return"root"==t&&(t="ROOT"),t},dojo.i18n._requireLocalization=function(e,t,o,n){var r=dojo.i18n.normalizeLocale(o),a=[e,"nls",t].join("."),i="";if(n){for(var s=n.split(","),d=0;d<s.length;d++)0==r.indexOf(s[d])&&s[d].length>i.length&&(i=s[d]);i||(i="ROOT")}var l=n?i:r,c=dojo._loadedModules[a],h=null;if(c){if(djConfig.localizationComplete&&c._built)return;var u=l.replace(/-/g,"_"),f=a+"."+u;h=dojo._loadedModules[f]}if(!h){c=dojo.provide(a);var m,j=dojo._getModuleSymbols(e),p=j.concat("nls").join("/");dojo.i18n._searchLocalePath(l,n,function(e){var o=e.replace(/-/g,"_"),r=a+"."+o,i=!1;if(dojo._loadedModules[r])i=!0;else{dojo.provide(r);var s=[p];"ROOT"!=e&&s.push(e),s.push(t);var d=s.join("/")+".js";i=dojo._loadPath(d,null,function(e){var t=function(){};t.prototype=m,c[o]=new t;for(var n in e)c[o][n]=e[n]})}return i&&c[o]?(m=c[o],!0):(c[o]=m,n?!0:void 0)})}n&&r!=i&&(c[r.replace(/-/g,"_")]=c[i.replace(/-/g,"_")])},function(){var e=djConfig.extraLocale;if(e){!e instanceof Array&&(e=[e]);var t=dojo.i18n._requireLocalization;dojo.i18n._requireLocalization=function(o,n,r,a){if(t(o,n,r,a),!r)for(var i=0;i<e.length;i++)t(o,n,e[i],a)}}}(),dojo.i18n._searchLocalePath=function(e,t,o){e=dojo.i18n.normalizeLocale(e);var n=[];e.match(/ja|en/i)?n.push(e.split("-")[0]):n.push(!1);for(var r=n.length-1;r>=0;r--){var a=n[r]||"ROOT",i=o(a);if(i)break}},dojo.i18n._preloadLocalizations=function(e,t){function o(o){o=dojo.i18n.normalizeLocale(o),dojo.i18n._searchLocalePath(o,!0,function(o){for(var n=0;n<t.length;n++)if(t[n]==o)return dojo.require(e+"_"+o),!0;return!1})}o();for(var n=djConfig.extraLocale||[],r=0;r<n.length;r++)o(n[r])}),dojo._hasResource["dojo.cldr.supplemental"]||(dojo._hasResource["dojo.cldr.supplemental"]=!0,dojo.provide("dojo.cldr.supplemental"),dojo.cldr.supplemental.getFirstDayOfWeek=function(e){var t={mv:5,ae:6,af:6,bh:6,dj:6,dz:6,eg:6,er:6,et:6,iq:6,ir:6,jo:6,ke:6,kw:6,lb:6,ly:6,ma:6,om:6,qa:6,sa:6,sd:6,so:6,tn:6,ye:6,as:0,au:0,az:0,bw:0,ca:0,cn:0,fo:0,ge:0,gl:0,gu:0,hk:0,ie:0,il:0,is:0,jm:0,jp:0,kg:0,kr:0,la:0,mh:0,mo:0,mp:0,mt:0,nz:0,ph:0,pk:0,sg:0,th:0,tt:0,tw:0,um:0,us:0,uz:0,vi:0,za:0,zw:0,et:0,mw:0,ng:0,tj:0,gb:0,sy:4},o=dojo.cldr.supplemental._region(e),n=t[o];return"undefined"==typeof n?1:n},dojo.cldr.supplemental._region=function(e){e=dojo.i18n.normalizeLocale(e);var t=e.split("-"),o=t[1];return o?4==o.length&&(o=t[2]):o={de:"de",en:"us",es:"es",fi:"fi",fr:"fr",hu:"hu",it:"it",ja:"jp",ko:"kr",nl:"nl",pt:"br",sv:"se",zh:"cn"}[t[0]],o},dojo.cldr.supplemental.getWeekend=function(e){var t={eg:5,il:5,sy:5,"in":0,ae:4,bh:4,dz:4,iq:4,jo:4,kw:4,lb:4,ly:4,ma:4,om:4,qa:4,sa:4,sd:4,tn:4,ye:4},o={ae:5,bh:5,dz:5,iq:5,jo:5,kw:5,lb:5,ly:5,ma:5,om:5,qa:5,sa:5,sd:5,tn:5,ye:5,af:5,ir:5,eg:6,il:6,sy:6},n=dojo.cldr.supplemental._region(e),r=t[n],a=o[n];return"undefined"==typeof r&&(r=6),"undefined"==typeof a&&(a=0),{start:r,end:a}}),dojo._hasResource["dojo.regexp"]||(dojo._hasResource["dojo.regexp"]=!0,dojo.provide("dojo.regexp"),dojo.regexp.escapeString=function(e,t){return e.replace(/([\.$?*!=:|{}\(\)\[\]\\\/^])/g,function(e){return t&&-1!=t.indexOf(e)?e:"\\"+e})},dojo.regexp.buildGroupRE=function(e,t,o){if(!(e instanceof Array))return t(e);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r]));return dojo.regexp.group(n.join("|"),o)},dojo.regexp.group=function(e,t){return"("+(t?"?:":"")+e+")"}),dojo._hasResource["dojo.string"]||(dojo._hasResource["dojo.string"]=!0,dojo.provide("dojo.string"),dojo.string.pad=function(e,t,o,n){var r=String(e);for(o||(o="0");r.length<t;)n?r+=o:r=o+r;return r},dojo.string.substitute=function(e,t,o,n){return e.replace(/\$\{([^\s\:\}]+)(?:\:([^\s\:\}]+))?\}/g,function(e,r,a){var i=dojo.getObject(r,!1,t);return a&&(i=dojo.getObject(a,!1,n)(i)),o&&(i=o(i,r)),i.toString()})},dojo.string.trim=function(e){e=e.replace(/^\s+/,"");for(var t=e.length-1;t>0;t--)if(/\S/.test(e.charAt(t))){e=e.substring(0,t+1);break}return e}),dojo._hasResource["dojo.date.stamp"]||(dojo._hasResource["dojo.date.stamp"]=!0,dojo.provide("dojo.date.stamp"),dojo.date.stamp.fromISOString=function(e,t){dojo.date.stamp._isoRegExp||(dojo.date.stamp._isoRegExp=/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(.\d+)?)?((?:[+-](\d{2}):(\d{2}))|Z)?)?$/);var o=dojo.date.stamp._isoRegExp.exec(e),n=null;if(o){o.shift(),o[1]&&o[1]--,o[6]&&(o[6]*=1e3),t&&(t=new Date(t),dojo.map(["FullYear","Month","Date","Hours","Minutes","Seconds","Milliseconds"],function(e){return t["get"+e]()}).forEach(function(e,t){void 0===o[t]&&(o[t]=e)})),n=new Date(o[0]||1970,o[1]||0,o[2]||0,o[3]||0,o[4]||0,o[5]||0,o[6]||0);var r=0,a=o[7]&&o[7].charAt(0);"Z"!=a&&(r=60*(o[8]||0)+(Number(o[9])||0),"-"!=a&&(r*=-1)),a&&(r-=n.getTimezoneOffset()),r&&n.setTime(n.getTime()+6e4*r)}return n},dojo.date.stamp.toISOString=function(e,t){var o=function(e){return 10>e?"0"+e:e};t=t||{};var n=[],r=t.zulu?"getUTC":"get",a="";if("time"!=t.selector&&(a=[e[r+"FullYear"](),o(e[r+"Month"]()+1),o(e[r+"Date"]())].join("-")),n.push(a),"date"!=t.selector){var i=[o(e[r+"Hours"]()),o(e[r+"Minutes"]()),o(e[r+"Seconds"]())].join(":"),s=e[r+"Milliseconds"]();if(t.milliseconds&&(i+="."+(100>s?"0":"")+o(s)),t.zulu)i+="Z";else if("time"!=t.selector){var d=e.getTimezoneOffset(),l=Math.abs(d);i+=(d>0?"-":"+")+o(Math.floor(l/60))+":"+o(l%60)}n.push(i)}return n.join("T")}),dojo._hasResource["dojo.parser"]||(dojo._hasResource["dojo.parser"]=!0,dojo.provide("dojo.parser"),dojo.parser=new function(){function e(e){return n.isString(e)?"string":"number"==typeof e?"number":"boolean"==typeof e?"boolean":n.isFunction(e)?"function":n.isArray(e)?"array":e instanceof Date?"date":e instanceof n._Url?"url":"object"}function t(e,t){switch(t){case"string":return e;case"number":return e.length?Number(e):0/0;case"boolean":return"boolean"==typeof e?e:!("false"==e.toLowerCase());case"function":n.isFunction(e)&&(e=e.toString(),e=n.trim(e.substring(e.indexOf("{")+1,e.length-1)));try{return-1!=e.search(/[^\w\.]+/i)&&(e=n.parser._nameAnonFunc(new Function(e),this)),n.getObject(e,!1)}catch(o){return new Function}case"array":return e.split(/\s*,\s*/);case"date":switch(e){case"":return new Date("");case"now":return new Date;default:return n.date.stamp.fromISOString(e)}case"url":return n.baseUrl+e;default:return n.fromJson(e)}}function o(t){if(!r[t]){var o=n.getObject(t);if(!n.isFunction(o))throw new Error("Could not load class '"+t+"'. Did you spell the name correctly and use a full path, like 'dijit.form.Button'?");var a=o.prototype,i={};for(var s in a)if("_"!=s.charAt(0)){var d=a[s];i[s]=e(d)}r[t]={cls:o,params:i}}return r[t]}var n=dojo,r={};this._functionFromScript=function(e){var t="",o="",r=e.getAttribute("args");r&&n.forEach(r.split(/\s*,\s*/),function(e,o){t+="var "+e+" = arguments["+o+"]; "});var a=e.getAttribute("with");return a&&a.length&&n.forEach(a.split(/\s*,\s*/),function(e){t+="with("+e+"){",o+="}"}),new Function(t+e.innerHTML+o)},this.instantiate=function(e){var r=[];return n.forEach(e,function(e){if(e){var a=e.getAttribute("dojoType");if(a&&a.length){var i=o(a),s=i.cls,d=s._noScript||s.prototype._noScript,l={},c=e.attributes;for(var h in i.params){var u=c.getNamedItem(h);if(u&&(u.specified||dojo.isIE&&"value"==h.toLowerCase())){var f=u.value;switch(h){case"class":f=e.className;break;case"style":f=e.style&&e.style.cssText}var m=i.params[h];l[h]=t(f,m)}}if(!d){var j=[],p=[];n.query("> script[type^='dojo/']",e).orphan().forEach(function(e){var t=e.getAttribute("event"),o=e.getAttribute("type"),r=n.parser._functionFromScript(e);t?"dojo/connect"==o?j.push({event:t,func:r}):l[t]=r:p.push(r)})}var v=s.markupFactory;!v&&s.prototype&&(v=s.prototype.markupFactory);var g=v?v(l,e,s):new s(l,e);r.push(g);var _=e.getAttribute("jsId");_&&n.setObject(_,g),d||(dojo.forEach(j,function(e){dojo.connect(g,e.event,null,e.func)}),dojo.forEach(p,function(e){e.call(g)}))}}}),n.forEach(r,function(e){!e||!e.startup||e.getParent&&e.getParent()||e.startup()}),r},this.parse=function(e){var t=n.query("[dojoType]",e),o=this.instantiate(t);return o}},function(){var e=function(){1==djConfig.parseOnLoad&&dojo.parser.parse()};dojo.exists("dijit.wai.onload")&&dijit.wai.onload===dojo._loaders[0]?dojo._loaders.splice(1,0,e):dojo._loaders.unshift(e)}(),dojo.parser._anonCtr=0,dojo.parser._anon={},dojo.parser._nameAnonFunc=function(e,t){var o=t||dojo.parser._anon;if(dojo.isIE){var n=e.__dojoNameCache;if(n&&o[n]===e)return e.__dojoNameCache}for(var r="__"+dojo.parser._anonCtr++;"undefined"!=typeof o[r];)r="__"+dojo.parser._anonCtr++;return o[r]=e,r}),dojo._hasResource["dojo.date.locale"]||(dojo._hasResource["dojo.date.locale"]=!0,dojo.provide("dojo.date.locale"),dojo.requireLocalization("dojo.cldr","gregorian",null,"ko,zh-cn,zh,ja,en,it-it,en-ca,en-au,it,en-gb,es-es,fr,pt,ROOT,ko-kr,es,de,pt-br"),function(){function e(e,t,o){return o.replace(/([a-z])\1*/gi,function(n){var r,a,i=n.charAt(0),s=n.length,d=["abbr","wide","narrow"];switch(i){case"G":r=t[4>s?"eraAbbr":"eraNames"][e.getFullYear()<0?0:1];break;case"y":switch(r=e.getFullYear(),s){case 1:break;case 2:r=String(r),r=r.substr(r.length-2);break;default:a=!0}break;case"Q":case"q":r=Math.ceil((e.getMonth()+1)/3),a=!0;break;case"M":case"L":var l,c=e.getMonth();switch(s){case 1:case 2:r=c+1,a=!0;break;case 3:case 4:case 5:l=d[s-3]}if(l){var h="L"==i?"standalone":"format",u=["months",h,l].join("-");r=t[u][c]}break;case"w":var f=0;r=dojo.date.locale._getWeekOfYear(e,f),a=!0;break;case"d":r=e.getDate(),a=!0;break;case"D":r=dojo.date.locale._getDayOfYear(e),a=!0;break;case"E":case"e":case"c":var l,m=e.getDay();switch(s){case 1:case 2:if("e"==i){var j=dojo.cldr.supplemental.getFirstDayOfWeek(options.locale);m=(m-j+7)%7}if("c"!=i){r=m+1,a=!0;break}case 3:case 4:case 5:l=d[s-3]}if(l){var h="c"==i?"standalone":"format",u=["days",h,l].join("-");r=t[u][m]}break;case"a":var p=e.getHours()<12?"am":"pm";r=t[p];break;case"h":case"H":case"K":case"k":var v=e.getHours();switch(i){case"h":r=v%12||12;break;case"H":r=v;break;case"K":r=v%12;break;case"k":r=v||24}a=!0;break;case"m":r=e.getMinutes(),a=!0;break;case"s":r=e.getSeconds(),a=!0;break;case"S":r=Math.round(e.getMilliseconds()*Math.pow(10,s-3));break;case"v":case"z":if(r=dojo.date.getTimezoneName(e))break;s=4;case"Z":var g=e.getTimezoneOffset(),_=[0>=g?"+":"-",dojo.string.pad(Math.floor(Math.abs(g)/60),2),dojo.string.pad(Math.abs(g)%60,2)];4==s&&(_.splice(0,0,"GMT"),_.splice(3,0,":")),r=_.join("");break;default:throw new Error("dojo.date.locale.format: invalid pattern char: "+o)}return a&&(r=dojo.string.pad(r,s)),r})}function t(e,t,o,n){var r=function(e){return e};t=t||r,o=o||r,n=n||r;var a=e.match(/(''|[^'])+/g),i=!1;return dojo.forEach(a,function(e,n){e?(a[n]=(i?o:t)(e),i=!i):a[n]=""}),n(a.join(""))}function o(e,t,o,n){return n=dojo.regexp.escapeString(n),o.strict||(n=n.replace(" a"," ?a")),n.replace(/([a-z])\1*/gi,function(n){var r,a=n.charAt(0),i=n.length,s="",d="";switch(o.strict?(i>1&&(s="0{"+(i-1)+"}"),i>2&&(d="0{"+(i-2)+"}")):(s="0?",d="0{0,2}"),a){case"y":r="\\d{2,4}";break;case"M":r=i>2?"\\S+":s+"[1-9]|1[0-2]";break;case"D":r=s+"[1-9]|"+d+"[1-9][0-9]|[12][0-9][0-9]|3[0-5][0-9]|36[0-6]";break;case"d":r=s+"[1-9]|[12]\\d|3[01]";break;case"w":r=s+"[1-9]|[1-4][0-9]|5[0-3]";break;case"E":r="\\S+";break;case"h":r=s+"[1-9]|1[0-2]";break;case"k":r=s+"\\d|1[01]";break;case"H":r=s+"\\d|1\\d|2[0-3]";break;case"K":r=s+"[1-9]|1\\d|2[0-4]";break;case"m":case"s":r="[0-5]\\d";break;case"S":r="\\d{"+i+"}";break;case"a":var l=o.am||t.am||"AM",c=o.pm||t.pm||"PM";o.strict?r=l+"|"+c:(r=l+"|"+c,l!=l.toLowerCase()&&(r+="|"+l.toLowerCase()),c!=c.toLowerCase()&&(r+="|"+c.toLowerCase()));break;default:r=".*"}return e&&e.push(n),"("+r+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}dojo.date.locale.format=function(o,n){n=n||{};var r=dojo.i18n.normalizeLocale(n.locale),a=n.formatLength||"short",i=dojo.date.locale._getGregorianBundle(r),s=[],d=dojo.hitch(this,e,o,i);if("year"==n.selector){var l=o.getFullYear();return r.match(/^zh|^ja/)&&(l+="年"),l}if("time"!=n.selector){var c=n.datePattern||i["dateFormat-"+a];c&&s.push(t(c,d))}if("date"!=n.selector){var h=n.timePattern||i["timeFormat-"+a];h&&s.push(t(h,d))}var u=s.join(" ");return u},dojo.date.locale.regexp=function(e){return dojo.date.locale._parseInfo(e).regexp},dojo.date.locale._parseInfo=function(e){e=e||{};var n,r=dojo.i18n.normalizeLocale(e.locale),a=dojo.date.locale._getGregorianBundle(r),i=e.formatLength||"short",s=e.datePattern||a["dateFormat-"+i],d=e.timePattern||a["timeFormat-"+i];n="date"==e.selector?s:"time"==e.selector?d:s+" "+d;var l=[],c=t(n,dojo.hitch(this,o,l,a,e));return{regexp:c,tokens:l,bundle:a}},dojo.date.locale.parse=function(e,t){var o=dojo.date.locale._parseInfo(t),n=o.tokens,r=o.bundle,a=new RegExp("^"+o.regexp+"$"),i=a.exec(e);if(!i)return null;var s=["abbr","wide","narrow"],d=new Date(1972,0),l={},c="";dojo.forEach(i,function(e,o){if(o){var a=n[o-1],i=a.length;switch(a.charAt(0)){case"y":if(2!=i)d.setFullYear(e),l.year=e;else if(100>e){e=Number(e);var h=""+(new Date).getFullYear(),u=100*h.substring(0,2),f=Number(h.substring(2,4)),m=Math.min(f+20,99),j=m>e?u+e:u-100+e;d.setFullYear(j),l.year=j}else{if(t.strict)return null;d.setFullYear(e),l.year=e}break;case"M":if(i>2){var p=r["months-format-"+s[i-3]].concat();if(t.strict||(e=e.replace(".","").toLowerCase(),p=dojo.map(p,function(e){return e.replace(".","").toLowerCase()})),e=dojo.indexOf(p,e),-1==e)return null}else e--;d.setMonth(e),l.month=e;break;case"E":case"e":var v=r["days-format-"+s[i-3]].concat();if(t.strict||(e=e.toLowerCase(),v=dojo.map(v,"".toLowerCase)),e=dojo.indexOf(v,e),-1==e)return null;break;case"d":d.setDate(e),l.date=e;break;case"D":d.setMonth(0),d.setDate(e);break;case"a":var g=t.am||r.am,_=t.pm||r.pm;if(!t.strict){var y=/\./g;e=e.replace(y,"").toLowerCase(),g=g.replace(y,"").toLowerCase(),_=_.replace(y,"").toLowerCase()}if(t.strict&&e!=g&&e!=_)return null;c=e==_?"p":e==g?"a":"";break;case"K":24==e&&(e=0);case"h":case"H":case"k":if(e>23)return null;d.setHours(e);break;case"m":d.setMinutes(e);break;case"s":d.setSeconds(e);break;case"S":d.setMilliseconds(e)}}});var h=d.getHours();return"p"===c&&12>h?d.setHours(h+12):"a"===c&&12==h&&d.setHours(0),l.year&&d.getFullYear()!=l.year?null:l.month&&d.getMonth()!=l.month?null:l.date&&d.getDate()!=l.date?null:d}}(),function(){var e=[];dojo.date.locale.addCustomFormats=function(t,o){e.push({pkg:t,name:o})},dojo.date.locale._getGregorianBundle=function(t){var o={};return dojo.forEach(e,function(e){var n=dojo.i18n.getLocalization(e.pkg,e.name,t);o=dojo.mixin(o,n)},this),o}}(),dojo.date.locale.addCustomFormats("dojo.cldr","gregorian"),dojo.date.locale.getNames=function(e,t,o,n){var r,a=dojo.date.locale._getGregorianBundle(n),i=[e,o,t];return"standAlone"==o&&(r=a[i.join("-")]),i[1]="format",(r||a[i.join("-")]).concat()},dojo.date.locale.isWeekend=function(e,t){var o=dojo.cldr.supplemental.getWeekend(t),n=(e||new Date).getDay();return o.end<o.start&&(o.end+=7,n<o.start&&(n+=7)),n>=o.start&&n<=o.end},dojo.date.locale._getDayOfYear=function(e){return dojo.date.difference(new Date(e.getFullYear(),0,1),e)+1},dojo.date.locale._getWeekOfYear=function(e,t){1==arguments.length&&(t=0);var o=new Date(e.getFullYear(),0,1).getDay(),n=(o-t+7)%7,r=Math.floor((dojo.date.locale._getDayOfYear(e)+n-1)/7);return o==t&&r++,r}),dojo._hasResource["dojo.dnd.autoscroll"]||(dojo._hasResource["dojo.dnd.autoscroll"]=!0,dojo.provide("dojo.dnd.autoscroll"),dojo.dnd.getViewport=function(){var e=dojo.doc,t=e.documentElement,o=window,n=dojo.body();return dojo.isMozilla?{w:t.clientWidth,h:o.innerHeight}:!dojo.isOpera&&o.innerWidth?{w:o.innerWidth,h:o.innerHeight}:!dojo.isOpera&&t&&t.clientWidth?{w:t.clientWidth,h:t.clientHeight}:n.clientWidth?{w:n.clientWidth,h:n.clientHeight}:null},dojo.dnd.V_TRIGGER_AUTOSCROLL=32,dojo.dnd.H_TRIGGER_AUTOSCROLL=32,dojo.dnd.V_AUTOSCROLL_VALUE=16,dojo.dnd.H_AUTOSCROLL_VALUE=16,dojo.dnd.autoScroll=function(e){var t=dojo.dnd.getViewport(),o=0,n=0;e.clientX<dojo.dnd.H_TRIGGER_AUTOSCROLL?o=-dojo.dnd.H_AUTOSCROLL_VALUE:e.clientX>t.w-dojo.dnd.H_TRIGGER_AUTOSCROLL&&(o=dojo.dnd.H_AUTOSCROLL_VALUE),e.clientY<dojo.dnd.V_TRIGGER_AUTOSCROLL?n=-dojo.dnd.V_AUTOSCROLL_VALUE:e.clientY>t.h-dojo.dnd.V_TRIGGER_AUTOSCROLL&&(n=dojo.dnd.V_AUTOSCROLL_VALUE),window.scrollBy(o,n)},dojo.dnd._validNodes={div:1,p:1,td:1},dojo.dnd._validOverflow={auto:1,scroll:1},dojo.dnd.autoScrollNodes=function(e){for(var t=e.target;t;){if(1==t.nodeType&&t.tagName.toLowerCase()in dojo.dnd._validNodes){var o=dojo.getComputedStyle(t);if(o.overflow.toLowerCase()in dojo.dnd._validOverflow){var n=dojo._getContentBox(t,o),r=dojo._abs(t,!0);n.l+=r.x+t.scrollLeft,n.t+=r.y+t.scrollTop;var a=Math.min(dojo.dnd.H_TRIGGER_AUTOSCROLL,n.w/2),i=Math.min(dojo.dnd.V_TRIGGER_AUTOSCROLL,n.h/2),s=e.pageX-n.l,d=e.pageY-n.t,l=0,c=0;s>0&&s<n.w&&(a>s?l=-dojo.dnd.H_AUTOSCROLL_VALUE:s>n.w-a&&(l=dojo.dnd.H_AUTOSCROLL_VALUE)),d>0&&d<n.h&&(i>d?c=-dojo.dnd.V_AUTOSCROLL_VALUE:d>n.h-i&&(c=dojo.dnd.V_AUTOSCROLL_VALUE));var h=t.scrollLeft,u=t.scrollTop;if(t.scrollLeft=t.scrollLeft+l,t.scrollTop=t.scrollTop+c,h!=t.scrollLeft||u!=t.scrollTop)return}}try{t=t.parentNode}catch(f){t=null}}dojo.dnd.autoScroll(e)}),dojo._hasResource["dojo.dnd.common"]||(dojo._hasResource["dojo.dnd.common"]=!0,dojo.provide("dojo.dnd.common"),dojo.dnd._copyKey=navigator.appVersion.indexOf("Macintosh")<0?"ctrlKey":"metaKey",dojo.dnd.getCopyKeyState=function(e){return e[dojo.dnd._copyKey]},dojo.dnd._uniqueId=0,dojo.dnd.getUniqueId=function(){var e;do e="dojoUnique"+ ++dojo.dnd._uniqueId;while(dojo.byId(e));return e},dojo.dnd._empty={},dojo.dnd.isFormElement=function(e){var t=e.target;return 3==t.nodeType&&(t=t.parentNode)," button textarea input select option ".indexOf(" "+t.tagName.toLowerCase()+" ")>=0}),dojo._hasResource["dojo.dnd.Container"]||(dojo._hasResource["dojo.dnd.Container"]=!0,dojo.provide("dojo.dnd.Container"),dojo.declare("dojo.dnd.Container",null,{skipForm:!1,constructor:function(e,t){this.node=dojo.byId(e),t||(t={}),this.creator=t.creator||null,this.skipForm=t.skipForm,this.defaultCreator=dojo.dnd._defaultCreator(this.node),this.map={},this.current=null,this.containerState="",dojo.addClass(this.node,"dojoDndContainer"),t&&t._skipStartup||this.startup(),this.events=[dojo.connect(this.node,"onmouseover",this,"onMouseOver"),dojo.connect(this.node,"onmouseout",this,"onMouseOut"),dojo.connect(this.node,"ondragstart",this,"onSelectStart"),dojo.connect(this.node,"onselectstart",this,"onSelectStart")]},creator:function(){},getItem:function(e){return this.map[e]},setItem:function(e,t){this.map[e]=t},delItem:function(e){delete this.map[e]},forInItems:function(e,t){t=t||dojo.global;var o=this.map,n=dojo.dnd._empty;for(var r in this.map)r in n||e.call(t,o[r],r,o)},clearItems:function(){this.map={}},getAllNodes:function(){return dojo.query("> .dojoDndItem",this.parent)},insertNodes:function(e,t,o){if(this.parent.firstChild?t?o||(o=this.parent.firstChild):o&&(o=o.nextSibling):o=null,o)for(var n=0;n<e.length;++n){var r=this._normalizedCreator(e[n]);this.setItem(r.node.id,{data:r.data,type:r.type}),this.parent.insertBefore(r.node,o)}else for(var n=0;n<e.length;++n){var r=this._normalizedCreator(e[n]);this.setItem(r.node.id,{data:r.data,type:r.type}),this.parent.appendChild(r.node)}return this},destroy:function(){dojo.forEach(this.events,dojo.disconnect),this.clearItems(),this.node=this.parent=this.current},markupFactory:function(e,t){return e._skipStartup=!0,new dojo.dnd.Container(t,e)},startup:function(){if(this.parent=this.node,"table"==this.parent.tagName.toLowerCase()){var e=this.parent.getElementsByTagName("tbody");e&&e.length&&(this.parent=e[0])}dojo.query("> .dojoDndItem",this.parent).forEach(function(e){e.id||(e.id=dojo.dnd.getUniqueId());var t=e.getAttribute("dndType"),o=e.getAttribute("dndData");this.setItem(e.id,{data:o?o:e.innerHTML,type:t?t.split(/\s*,\s*/):["text"]})},this)},onMouseOver:function(e){for(var t=e.relatedTarget;t&&t!=this.node;)try{t=t.parentNode}catch(o){t=null}t||(this._changeState("Container","Over"),this.onOverEvent()),t=this._getChildByEvent(e),this.current!=t&&(this.current&&this._removeItemClass(this.current,"Over"),t&&this._addItemClass(t,"Over"),this.current=t)},onMouseOut:function(e){for(var t=e.relatedTarget;t;){if(t==this.node)return;try{t=t.parentNode}catch(o){t=null}}this.current&&(this._removeItemClass(this.current,"Over"),this.current=null),this._changeState("Container",""),this.onOutEvent()},onSelectStart:function(e){this.skipForm&&dojo.dnd.isFormElement(e)||dojo.stopEvent(e)},onOverEvent:function(){},onOutEvent:function(){},_changeState:function(e,t){var o="dojoDnd"+e,n=e.toLowerCase()+"State";dojo.removeClass(this.node,o+this[n]),dojo.addClass(this.node,o+t),this[n]=t},_addItemClass:function(e,t){dojo.addClass(e,"dojoDndItem"+t)},_removeItemClass:function(e,t){dojo.removeClass(e,"dojoDndItem"+t)},_getChildByEvent:function(e){var t=e.target;if(t)for(var o=t.parentNode;o;t=o,o=t.parentNode)if(o==this.parent&&dojo.hasClass(t,"dojoDndItem"))return t;return null},_normalizedCreator:function(e,t){var o=(this.creator?this.creator:this.defaultCreator)(e,t);return dojo.isArray(o.type)||(o.type=["text"]),o.node.id||(o.node.id=dojo.dnd.getUniqueId()),dojo.addClass(o.node,"dojoDndItem"),o}}),dojo.dnd._createNode=function(e){return e?function(t){var o=dojo.doc.createElement(e);return o.innerHTML=t,o}:dojo.dnd._createSpan},dojo.dnd._createTrTd=function(e){var t=dojo.doc.createElement("tr"),o=dojo.doc.createElement("td");return o.innerHTML=e,t.appendChild(o),t},dojo.dnd._createSpan=function(e){var t=dojo.doc.createElement("span");return t.innerHTML=e,t},dojo.dnd._defaultCreatorNodes={ul:"li",ol:"li",div:"div",p:"div"},dojo.dnd._defaultCreator=function(e){var t=e.tagName.toLowerCase(),o="table"==t?dojo.dnd._createTrTd:dojo.dnd._createNode(dojo.dnd._defaultCreatorNodes[t]);return function(e,t){var n=dojo.isObject(e)&&e,r=n&&e.data?e.data:e,a=n&&e.type?e.type:["text"],i=String(r),s=("avatar"==t?dojo.dnd._createSpan:o)(i);return s.id=dojo.dnd.getUniqueId(),{node:s,data:r,type:a}}}),dojo._hasResource["dojo.dnd.Selector"]||(dojo._hasResource["dojo.dnd.Selector"]=!0,dojo.provide("dojo.dnd.Selector"),dojo.declare("dojo.dnd.Selector",dojo.dnd.Container,{constructor:function(e,t){t||(t={}),this.singular=t.singular,this.selection={},this.anchor=null,this.simpleSelection=!1,this.events.push(dojo.connect(this.node,"onmousedown",this,"onMouseDown"),dojo.connect(this.node,"onmouseup",this,"onMouseUp"))},singular:!1,getSelectedNodes:function(){var e=new dojo.NodeList,t=dojo.dnd._empty;for(var o in this.selection)o in t||e.push(dojo.byId(o));return e},selectNone:function(){return this._removeSelection()._removeAnchor()},selectAll:function(){return this.forInItems(function(e,t){this._addItemClass(dojo.byId(t),"Selected"),this.selection[t]=1},this),this._removeAnchor()},deleteSelectedNodes:function(){var e=dojo.dnd._empty;for(var t in this.selection)if(!(t in e)){var o=dojo.byId(t);this.delItem(t),dojo._destroyElement(o)}return this.anchor=null,this.selection={},this},insertNodes:function(e,t,o,n){var r=this._normalizedCreator;return this._normalizedCreator=function(t,o){var n=r.call(this,t,o);return e?(this.anchor?this.anchor!=n.node&&(this._removeItemClass(n.node,"Anchor"),this._addItemClass(n.node,"Selected")):(this.anchor=n.node,this._removeItemClass(n.node,"Selected"),this._addItemClass(this.anchor,"Anchor")),this.selection[n.node.id]=1):(this._removeItemClass(n.node,"Selected"),this._removeItemClass(n.node,"Anchor")),n},dojo.dnd.Selector.superclass.insertNodes.call(this,t,o,n),this._normalizedCreator=r,this},destroy:function(){dojo.dnd.Selector.superclass.destroy.call(this),this.selection=this.anchor=null},markupFactory:function(e,t){return e._skipStartup=!0,new dojo.dnd.Selector(t,e)},onMouseDown:function(e){if(this.current){if(!this.singular&&!dojo.dnd.getCopyKeyState(e)&&!e.shiftKey&&this.current.id in this.selection)return this.simpleSelection=!0,dojo.stopEvent(e),void 0;if(!this.singular&&e.shiftKey){dojo.dnd.getCopyKeyState(e)||this._removeSelection();var t=dojo.query("> .dojoDndItem",this.parent);if(t.length&&(this.anchor||(this.anchor=t[0],this._addItemClass(this.anchor,"Anchor")),this.selection[this.anchor.id]=1,this.anchor!=this.current)){for(var o=0;o<t.length;++o){var n=t[o];if(n==this.anchor||n==this.current)break}for(++o;o<t.length;++o){var n=t[o];if(n==this.anchor||n==this.current)break;this._addItemClass(n,"Selected"),this.selection[n.id]=1}this._addItemClass(this.current,"Selected"),this.selection[this.current.id]=1}}else this.singular?this.anchor==this.current?dojo.dnd.getCopyKeyState(e)&&this.selectNone():(this.selectNone(),this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1):dojo.dnd.getCopyKeyState(e)?this.anchor==this.current?(delete this.selection[this.anchor.id],this._removeAnchor()):this.current.id in this.selection?(this._removeItemClass(this.current,"Selected"),delete this.selection[this.current.id]):(this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this._addItemClass(this.anchor,"Selected")),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1):this.current.id in this.selection||(this.selectNone(),this.anchor=this.current,this._addItemClass(this.current,"Anchor"),this.selection[this.current.id]=1);dojo.stopEvent(e)}},onMouseUp:function(){this.simpleSelection&&(this.simpleSelection=!1,this.selectNone(),this.current&&(this.anchor=this.current,this._addItemClass(this.anchor,"Anchor"),this.selection[this.current.id]=1))},onMouseMove:function(){this.simpleSelection=!1},onOverEvent:function(){this.onmousemoveEvent=dojo.connect(this.node,"onmousemove",this,"onMouseMove")},onOutEvent:function(){dojo.disconnect(this.onmousemoveEvent),delete this.onmousemoveEvent},_removeSelection:function(){var e=dojo.dnd._empty;for(var t in this.selection)if(!(t in e)){var o=dojo.byId(t);o&&this._removeItemClass(o,"Selected")}return this.selection={},this},_removeAnchor:function(){return this.anchor&&(this._removeItemClass(this.anchor,"Anchor"),this.anchor=null),this}})),dojo._hasResource["dojo.dnd.Avatar"]||(dojo._hasResource["dojo.dnd.Avatar"]=!0,dojo.provide("dojo.dnd.Avatar"),dojo.dnd.Avatar=function(e){this.manager=e,this.construct()},dojo.extend(dojo.dnd.Avatar,{construct:function(){var e=dojo.doc.createElement("table");e.className="dojoDndAvatar",e.style.position="absolute",e.style.zIndex=1999,e.style.margin="0px";var t=dojo.doc.createElement("tbody"),o=dojo.doc.createElement("tr");o.className="dojoDndAvatarHeader";var n=dojo.doc.createElement("td");n.innerHTML=this._generateText(),o.appendChild(n),dojo.style(o,"opacity",.9),t.appendChild(o);for(var r=Math.min(5,this.manager.nodes.length),a=this.manager.source,i=0;r>i;++i){o=dojo.doc.createElement("tr"),o.className="dojoDndAvatarItem",n=dojo.doc.createElement("td");
var s=s=a.creator?a._normalizedCreator(a.getItem(this.manager.nodes[i].id).data,"avatar").node:this.manager.nodes[i].cloneNode(!0);s.id="",s.style.width=(this.manager.nodes[i].clientWidth||this.manager.nodes[i].offsetWidth)+"px",s.style.height="auto",n.appendChild(s),o.appendChild(n),dojo.style(o,"opacity",(9-i)/10),t.appendChild(o)}e.appendChild(t),this.node=e},destroy:function(){dojo._destroyElement(this.node),this.node=!1},update:function(){dojo[(this.manager.canDropFlag?"add":"remove")+"Class"](this.node,"dojoDndAvatarCanDrop");for(var e=this.node.getElementsByTagName("td"),t=0;t<e.length;++t){var o=e[t];if(dojo.hasClass(o.parentNode,"dojoDndAvatarHeader")){o.innerHTML=this._generateText();break}}},_generateText:function(){return this.manager.nodes.length.toString()}})),dojo._hasResource["dojo.dnd.Manager"]||(dojo._hasResource["dojo.dnd.Manager"]=!0,dojo.provide("dojo.dnd.Manager"),dojo.dnd.Manager=function(){this.avatar=null,this.source=null,this.nodes=[],this.copy=!0,this.target=null,this.canDropFlag=!1,this.events=[]},dojo.extend(dojo.dnd.Manager,{OFFSET_X:-10,OFFSET_Y:5,overSource:function(e){this.avatar&&(this.target=e&&"Disabled"!=e.targetState?e:null,this.avatar.update()),dojo.publish("/dnd/source/over",[e])},outSource:function(e){this.avatar?this.target==e&&(this.target=null,this.canDropFlag=!1,this.avatar.update(),dojo.publish("/dnd/source/over",[null])):dojo.publish("/dnd/source/over",[null])},startDrag:function(e,t,o){this.source=e,this.nodes=t,this.copy=Boolean(o),this.avatar=this.makeAvatar(),dojo.body().appendChild(this.avatar.node),dojo.publish("/dnd/start",[e,t,this.copy]),this.events=[dojo.connect(dojo.doc,"onmousemove",this,"onMouseMove"),dojo.connect(dojo.doc,"onmouseup",this,"onMouseUp"),dojo.connect(dojo.doc,"onkeydown",this,"onKeyDown"),dojo.connect(dojo.doc,"onkeyup",this,"onKeyUp")];var n="dojoDnd"+(o?"Copy":"Move");dojo.addClass(dojo.body(),n)},canDrop:function(e){var t=this.target&&e;this.canDropFlag!=t&&(this.canDropFlag=t,this.avatar.update())},stopDrag:function(){dojo.removeClass(dojo.body(),"dojoDndCopy"),dojo.removeClass(dojo.body(),"dojoDndMove"),dojo.forEach(this.events,dojo.disconnect),this.events=[],this.avatar.destroy(),this.avatar=null,this.source=null,this.nodes=[]},makeAvatar:function(){return new dojo.dnd.Avatar(this)},updateAvatar:function(){this.avatar.update()},onMouseMove:function(e){var t=this.avatar;if(t){dojo.dnd.autoScroll(e),dojo.marginBox(t.node,{l:e.pageX+this.OFFSET_X,t:e.pageY+this.OFFSET_Y});var o=Boolean(this.source.copyState(dojo.dnd.getCopyKeyState(e)));this.copy!=o&&this._setCopyStatus(o)}},onMouseUp:function(e){if(!(!this.avatar||"mouseButton"in this.source&&this.source.mouseButton!=e.button)){if(this.target&&this.canDropFlag){var t=[this.source,this.nodes,Boolean(this.source.copyState(dojo.dnd.getCopyKeyState(e))),this.target];dojo.publish("/dnd/drop/before",t),dojo.publish("/dnd/drop",t)}else dojo.publish("/dnd/cancel");this.stopDrag()}},onKeyDown:function(e){if(this.avatar)switch(e.keyCode){case dojo.keys.CTRL:var t=Boolean(this.source.copyState(!0));this.copy!=t&&this._setCopyStatus(t);break;case dojo.keys.ESCAPE:dojo.publish("/dnd/cancel"),this.stopDrag()}},onKeyUp:function(e){if(this.avatar&&e.keyCode==dojo.keys.CTRL){var t=Boolean(this.source.copyState(!1));this.copy!=t&&this._setCopyStatus(t)}},_setCopyStatus:function(e){this.copy=e,this.source._markDndStatus(this.copy),this.updateAvatar(),dojo.removeClass(dojo.body(),"dojoDnd"+(this.copy?"Move":"Copy")),dojo.addClass(dojo.body(),"dojoDnd"+(this.copy?"Copy":"Move"))}}),dojo.dnd._manager=null,dojo.dnd.manager=function(){return dojo.dnd._manager||(dojo.dnd._manager=new dojo.dnd.Manager),dojo.dnd._manager}),dojo._hasResource["dojo.dnd.Source"]||(dojo._hasResource["dojo.dnd.Source"]=!0,dojo.provide("dojo.dnd.Source"),dojo.declare("dojo.dnd.Source",dojo.dnd.Selector,{isSource:!0,horizontal:!1,copyOnly:!1,skipForm:!1,withHandles:!1,accept:["text"],constructor:function(e,t){t||(t={}),this.isSource="undefined"==typeof t.isSource?!0:t.isSource;var o=t.accept instanceof Array?t.accept:["text"];if(this.accept=null,o.length){this.accept={};for(var n=0;n<o.length;++n)this.accept[o[n]]=1}this.horizontal=t.horizontal,this.copyOnly=t.copyOnly,this.withHandles=t.withHandles,this.isDragging=!1,this.mouseDown=!1,this.targetAnchor=null,this.targetBox=null,this.before=!0,this.sourceState="",this.isSource&&dojo.addClass(this.node,"dojoDndSource"),this.targetState="",this.accept&&dojo.addClass(this.node,"dojoDndTarget"),this.horizontal&&dojo.addClass(this.node,"dojoDndHorizontal"),this.topics=[dojo.subscribe("/dnd/source/over",this,"onDndSourceOver"),dojo.subscribe("/dnd/start",this,"onDndStart"),dojo.subscribe("/dnd/drop",this,"onDndDrop"),dojo.subscribe("/dnd/cancel",this,"onDndCancel")]},checkAcceptance:function(e,t){if(this==e)return!0;for(var o=0;o<t.length;++o){for(var n=e.getItem(t[o].id).type,r=!1,a=0;a<n.length;++a)if(n[a]in this.accept){r=!0;break}if(!r)return!1}return!0},copyState:function(e){return this.copyOnly||e},destroy:function(){dojo.dnd.Source.superclass.destroy.call(this),dojo.forEach(this.topics,dojo.unsubscribe),this.targetAnchor=null},markupFactory:function(e,t){return e._skipStartup=!0,new dojo.dnd.Source(t,e)},onMouseMove:function(e){if(!this.isDragging||"Disabled"!=this.targetState){dojo.dnd.Source.superclass.onMouseMove.call(this,e);var t=dojo.dnd.manager();if(this.isDragging){var o=!1;this.current&&(this.targetBox&&this.targetAnchor==this.current||(this.targetBox={xy:dojo.coords(this.current,!0),w:this.current.offsetWidth,h:this.current.offsetHeight}),o=this.horizontal?e.pageX-this.targetBox.xy.x<this.targetBox.w/2:e.pageY-this.targetBox.xy.y<this.targetBox.h/2),(this.current!=this.targetAnchor||o!=this.before)&&(this._markTargetAnchor(o),t.canDrop(!(this.current&&t.source==this&&this.current.id in this.selection)))}else if(this.mouseDown&&this.isSource){var n=this.getSelectedNodes();n.length&&t.startDrag(this,n,this.copyState(dojo.dnd.getCopyKeyState(e)))}}},onMouseDown:function(e){!this._legalMouseDown(e)||this.skipForm&&dojo.dnd.isFormElement(e)||(this.mouseDown=!0,this.mouseButton=e.button,dojo.dnd.Source.superclass.onMouseDown.call(this,e))},onMouseUp:function(e){this.mouseDown&&(this.mouseDown=!1,dojo.dnd.Source.superclass.onMouseUp.call(this,e))},onDndSourceOver:function(e){if(this!=e)this.mouseDown=!1,this.targetAnchor&&this._unmarkTargetAnchor();else if(this.isDragging){var t=dojo.dnd.manager();t.canDrop(!("Disabled"==this.targetState||this.current&&t.source==this&&this.current.id in this.selection))}},onDndStart:function(e,t,o){this.isSource&&this._changeState("Source",this==e?o?"Copied":"Moved":"");var n=this.accept&&this.checkAcceptance(e,t);this._changeState("Target",n?"":"Disabled"),n&&this==e&&dojo.dnd.manager().overSource(this),this.isDragging=!0},onDndDrop:function(e,t,o){do{if("Over"!=this.containerState)break;var n=this._normalizedCreator;if(this!=e)this._normalizedCreator=this.creator?function(t,o){return n.call(this,e.getItem(t.id).data,o)}:o?function(t){var o=e.getItem(t.id),n=t.cloneNode(!0);return n.id=dojo.dnd.getUniqueId(),{node:n,data:o.data,type:o.type}}:function(t){var o=e.getItem(t.id);return e.delItem(t.id),{node:t,data:o.data,type:o.type}};else{if(this.current&&this.current.id in this.selection)break;if(this.creator)if(o)this._normalizedCreator=function(t,o){return n.call(this,e.getItem(t.id).data,o)};else{if(!this.current)break;this._normalizedCreator=function(t){var o=e.getItem(t.id);return{node:t,data:o.data,type:o.type}}}else if(o)this._normalizedCreator=function(t){var o=e.getItem(t.id),n=t.cloneNode(!0);return n.id=dojo.dnd.getUniqueId(),{node:n,data:o.data,type:o.type}};else{if(!this.current)break;this._normalizedCreator=function(t){var o=e.getItem(t.id);return{node:t,data:o.data,type:o.type}}}}this._removeSelection(),this!=e&&this._removeAnchor(),this==e||o||this.creator||e.selectNone(),this.insertNodes(!0,t,this.before,this.current),this!=e&&!o&&this.creator&&e.deleteSelectedNodes(),this._normalizedCreator=n}while(!1);this.onDndCancel()},onDndCancel:function(){this.targetAnchor&&(this._unmarkTargetAnchor(),this.targetAnchor=null),this.before=!0,this.isDragging=!1,this.mouseDown=!1,delete this.mouseButton,this._changeState("Source",""),this._changeState("Target","")},onOverEvent:function(){dojo.dnd.Source.superclass.onOverEvent.call(this),dojo.dnd.manager().overSource(this)},onOutEvent:function(){dojo.dnd.Source.superclass.onOutEvent.call(this),dojo.dnd.manager().outSource(this)},_markTargetAnchor:function(e){(this.current!=this.targetAnchor||this.before!=e)&&(this.targetAnchor&&this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=this.current,this.targetBox=null,this.before=e,this.targetAnchor&&this._addItemClass(this.targetAnchor,this.before?"Before":"After"))},_unmarkTargetAnchor:function(){this.targetAnchor&&(this._removeItemClass(this.targetAnchor,this.before?"Before":"After"),this.targetAnchor=null,this.targetBox=null,this.before=!0)},_markDndStatus:function(e){this._changeState("Source",e?"Copied":"Moved")},_legalMouseDown:function(e){if(!this.withHandles)return!0;for(var t=e.target;t&&!dojo.hasClass(t,"dojoDndItem");t=t.parentNode)if(dojo.hasClass(t,"dojoDndHandle")){var o=e;o||(o=window.event);var n={x:o.clientX,y:o.clientY},r=!1;return dojo.query("a",t).forEach(function(e){if(!r){var t=e.getBoundingClientRect();r=t.left<=n.x&&n.x<=t.right&&t.top<=n.y&&n.y<=t.bottom}}),r?!1:!0}return!1}}),dojo.declare("dojo.dnd.Target",dojo.dnd.Source,{constructor:function(){this.isSource=!1,dojo.removeClass(this.node,"dojoDndSource")},markupFactory:function(e,t){return e._skipStartup=!0,new dojo.dnd.Target(t,e)}})),dojo._hasResource["dojo.dnd.Mover"]||(dojo._hasResource["dojo.dnd.Mover"]=!0,dojo.provide("dojo.dnd.Mover"),dojo.declare("dojo.dnd.Mover",null,{constructor:function(e,t,o){this.node=dojo.byId(e),this.marginBox={l:t.pageX,t:t.pageY},this.mouseButton=t.button;var n=this.host=o,r=e.ownerDocument,a=dojo.connect(r,"onmousemove",this,"onFirstMove");this.events=[dojo.connect(r,"onmousemove",this,"onMouseMove"),dojo.connect(r,"onmouseup",this,"onMouseUp"),dojo.connect(r,"ondragstart",dojo,"stopEvent"),dojo.connect(r,"onselectstart",dojo,"stopEvent"),a],n&&n.onMoveStart&&n.onMoveStart(this)},onMouseMove:function(e){dojo.dnd.autoScroll(e);var t=this.marginBox;this.host.onMove(this,{l:t.l+e.pageX,t:t.t+e.pageY})},onMouseUp:function(e){this.mouseButton==e.button&&this.destroy()},onFirstMove:function(){this.node.style.position="absolute";var e=dojo.marginBox(this.node);e.l-=this.marginBox.l,e.t-=this.marginBox.t,this.marginBox=e,this.host.onFirstMove(this),dojo.disconnect(this.events.pop())},destroy:function(){dojo.forEach(this.events,dojo.disconnect);var e=this.host;e&&e.onMoveStop&&e.onMoveStop(this),this.events=this.node=null}})),dojo._hasResource["dojo.dnd.Moveable"]||(dojo._hasResource["dojo.dnd.Moveable"]=!0,dojo.provide("dojo.dnd.Moveable"),dojo.declare("dojo.dnd.Moveable",null,{handle:"",delay:0,skip:!1,constructor:function(e,t){this.node=dojo.byId(e),t||(t={}),this.handle=t.handle?dojo.byId(t.handle):null,this.handle||(this.handle=this.node),this.delay=t.delay>0?t.delay:0,this.skip=t.skip,this.mover=t.mover?t.mover:dojo.dnd.Mover,this.events=[dojo.connect(this.handle,"onmousedown",this,"onMouseDown"),dojo.connect(this.handle,"ondragstart",this,"onSelectStart"),dojo.connect(this.handle,"onselectstart",this,"onSelectStart")]},markupFactory:function(e,t){return new dojo.dnd.Moveable(t,e)},destroy:function(){dojo.forEach(this.events,dojo.disconnect),this.events=this.node=this.handle=null},onMouseDown:function(e){this.skip&&dojo.dnd.isFormElement(e)||(this.delay?(this.events.push(dojo.connect(this.handle,"onmousemove",this,"onMouseMove")),this.events.push(dojo.connect(this.handle,"onmouseup",this,"onMouseUp")),this._lastX=e.pageX,this._lastY=e.pageY):new this.mover(this.node,e,this),dojo.stopEvent(e))},onMouseMove:function(e){(Math.abs(e.pageX-this._lastX)>this.delay||Math.abs(e.pageY-this._lastY)>this.delay)&&(this.onMouseUp(e),new this.mover(this.node,e,this)),dojo.stopEvent(e)},onMouseUp:function(){dojo.disconnect(this.events.pop()),dojo.disconnect(this.events.pop())},onSelectStart:function(e){this.skip&&dojo.dnd.isFormElement(e)||dojo.stopEvent(e)},onMoveStart:function(e){dojo.publish("/dnd/move/start",[e]),dojo.addClass(dojo.body(),"dojoMove"),dojo.addClass(this.node,"dojoMoveItem")},onMoveStop:function(e){dojo.publish("/dnd/move/stop",[e]),dojo.removeClass(dojo.body(),"dojoMove"),dojo.removeClass(this.node,"dojoMoveItem")},onFirstMove:function(){},onMove:function(e,t){this.onMoving(e,t),dojo.marginBox(e.node,t),this.onMoved(e,t)},onMoving:function(){},onMoved:function(){}})),dojo._hasResource["dojo.dnd.move"]||(dojo._hasResource["dojo.dnd.move"]=!0,dojo.provide("dojo.dnd.move"),dojo.declare("dojo.dnd.move.constrainedMoveable",dojo.dnd.Moveable,{constraints:function(){},within:!1,markupFactory:function(e,t){return new dojo.dnd.move.constrainedMoveable(t,e)},constructor:function(e,t){t||(t={}),this.constraints=t.constraints,this.within=t.within},onFirstMove:function(e){var t=this.constraintBox=this.constraints.call(this,e),o=e.marginBox;t.r=t.l+t.w-(this.within?o.w:0),t.b=t.t+t.h-(this.within?o.h:0)},onMove:function(e,t){var o=this.constraintBox;t.l=t.l<o.l?o.l:o.r<t.l?o.r:t.l,t.t=t.t<o.t?o.t:o.b<t.t?o.b:t.t,dojo.marginBox(e.node,t)}}),dojo.declare("dojo.dnd.move.boxConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{box:{},markupFactory:function(e,t){return new dojo.dnd.move.boxConstrainedMoveable(t,e)},constructor:function(e,t){var o=t&&t.box;this.constraints=function(){return o}}}),dojo.declare("dojo.dnd.move.parentConstrainedMoveable",dojo.dnd.move.constrainedMoveable,{area:"content",markupFactory:function(e,t){return new dojo.dnd.move.parentConstrainedMoveable(t,e)},constructor:function(e,t){var o=t&&t.area;this.constraints=function(){var e=this.node.parentNode,t=dojo.getComputedStyle(e),n=dojo._getMarginBox(e,t);if("margin"==o)return n;var r=dojo._getMarginExtents(e,t);return n.l+=r.l,n.t+=r.t,n.w-=r.w,n.h-=r.h,"border"==o?n:(r=dojo._getBorderExtents(e,t),n.l+=r.l,n.t+=r.t,n.w-=r.w,n.h-=r.h,"padding"==o?n:(r=dojo._getPadExtents(e,t),n.l+=r.l,n.t+=r.t,n.w-=r.w,n.h-=r.h,n))}}}),dojo.dnd.move.constrainedMover=function(e,t){var o=function(e,t,o){dojo.dnd.Mover.call(this,e,t,o)};return dojo.extend(o,dojo.dnd.Mover.prototype),dojo.extend(o,{onMouseMove:function(e){dojo.dnd.autoScroll(e);var t=this.marginBox,o=this.constraintBox,n=t.l+e.pageX,r=t.t+e.pageY;n=n<o.l?o.l:o.r<n?o.r:n,r=r<o.t?o.t:o.b<r?o.b:r,this.host.onMove(this,{l:n,t:r})},onFirstMove:function(){dojo.dnd.Mover.prototype.onFirstMove.call(this);var o=this.constraintBox=e.call(this),n=this.marginBox;o.r=o.l+o.w-(t?n.w:0),o.b=o.t+o.h-(t?n.h:0)}}),o},dojo.dnd.move.boxConstrainedMover=function(e,t){return dojo.dnd.move.constrainedMover(function(){return e},t)},dojo.dnd.move.parentConstrainedMover=function(e,t){var o=function(){var t=this.node.parentNode,o=dojo.getComputedStyle(t),n=dojo._getMarginBox(t,o);if("margin"==e)return n;var r=dojo._getMarginExtents(t,o);return n.l+=r.l,n.t+=r.t,n.w-=r.w,n.h-=r.h,"border"==e?n:(r=dojo._getBorderExtents(t,o),n.l+=r.l,n.t+=r.t,n.w-=r.w,n.h-=r.h,"padding"==e?n:(r=dojo._getPadExtents(t,o),n.l+=r.l,n.t+=r.t,n.w-=r.w,n.h-=r.h,n))};return dojo.dnd.move.constrainedMover(o,t)},dojo.dnd.constrainedMover=dojo.dnd.move.constrainedMover,dojo.dnd.boxConstrainedMover=dojo.dnd.move.boxConstrainedMover,dojo.dnd.parentConstrainedMover=dojo.dnd.move.parentConstrainedMover),dojo._hasResource["dojo.io.iframe"]||(dojo._hasResource["dojo.io.iframe"]=!0,dojo.provide("dojo.io.iframe"),dojo.io.iframe={create:function(fname,onloadstr,uri){if(window[fname])return window[fname];if(window.frames[fname])return window.frames[fname];var cframe=null,turi=uri;turi||(djConfig.useXDomain&&!djConfig.dojoBlankHtmlUrl&&console.debug("dojo.io.iframe.create: When using cross-domain Dojo builds, please save dojo/resources/blank.html to your domain and set djConfig.dojoBlankHtmlUrl to the path on your domain to blank.html"),turi=djConfig.dojoBlankHtmlUrl||dojo.moduleUrl("dojo","resources/blank.html"));var ifrstr=dojo.isIE?'<iframe name="'+fname+'" src="'+turi+'" onload="'+onloadstr+'">':"iframe";with(cframe=dojo.doc.createElement(ifrstr))name=fname,setAttribute("name",fname),id=fname;with(dojo.body().appendChild(cframe),window[fname]=cframe,cframe.style)dojo.isSafari<3&&(position="absolute"),left=top="1px",height=width="1px",visibility="hidden";return dojo.isIE||(this.setSrc(cframe,turi,!0),cframe.onload=new Function(onloadstr)),cframe},setSrc:function(e,t,o){try{if(o){var n;if(n=dojo.isIE||dojo.isSafari>2?e.contentWindow.document:dojo.isSafari?e.document:e.contentWindow,!n)return e.location=t,void 0;n.location.replace(t)}else dojo.isSafari?e.location=t:frames[e.name].location=t}catch(r){console.debug("dojo.io.iframe.setSrc: ",r)}},doc:function(e){var t=e.contentDocument||e.contentWindow&&e.contentWindow.document||e.name&&document.frames[e.name]&&document.frames[e.name].document||null;return t},send:function(e){this._frame||(this._frame=this.create(this._iframeName,"dojo.io.iframe._iframeOnload();"));var t=dojo._ioSetArgs(e,function(e){e.canceled=!0,e.ioArgs._callNext()},function(e){var t=null;try{var o=e.ioArgs,n=dojo.io.iframe,r=n.doc(n._frame),a=o.handleAs;t=r,"html"!=a&&(t=r.getElementsByTagName("textarea")[0].value,"json"==a?t=dojo.fromJson(t):"javascript"==a&&(t=dojo.eval(t)))}catch(i){t=i}finally{o._callNext()}return t},function(e,t){return t.ioArgs._hasError=!0,t.ioArgs._callNext(),e});return t.ioArgs._callNext=function(){this._calledNext||(this._calledNext=!0,dojo.io.iframe._currentDfd=null,dojo.io.iframe._fireNextRequest())},this._dfdQueue.push(t),this._fireNextRequest(),dojo._ioWatch(t,function(e){return!e.ioArgs._hasError},function(e){return!!e.ioArgs._finished},function(e){e.ioArgs._finished?e.callback(e):e.errback(new Error("Invalid dojo.io.iframe request state"))}),t},_currentDfd:null,_dfdQueue:[],_iframeName:"dojoIoIframe",_fireNextRequest:function(){try{if(this._currentDfd||0==this._dfdQueue.length)return;var e=this._currentDfd=this._dfdQueue.shift(),t=e.ioArgs,o=t.args;t._contentToClean=[];var n=o.form,r=o.content||{};if(n){if(r)for(var a in r)if(n[a])n[a].value=r[a];else{var i;dojo.isIE?i=dojo.doc.createElement("<input type='hidden' name='"+a+"'>"):(i=dojo.doc.createElement("input"),i.type="hidden",i.name=a),i.value=r[a],n.appendChild(i),t._contentToClean.push(a)}var s=n.getAttributeNode("action"),d=n.getAttributeNode("method"),l=n.getAttributeNode("target");o.url&&(t._originalAction=s?s.value:null,s?s.value=o.url:n.setAttribute("action",o.url)),d&&d.value||(d?d.value=o.method?o.method:"post":n.setAttribute("method",o.method?o.method:"post")),t._originalTarget=l?l.value:null,l?l.value=this._iframeName:n.setAttribute("target",this._iframeName),n.target=this._iframeName,n.submit()}else{var c=o.url+(o.url.indexOf("?")>-1?"&":"?")+t.query;this.setSrc(this._frame,c,!0)}}catch(h){e.errback(h)}},_iframeOnload:function(){var e=this._currentDfd;if(!e)return this._fireNextRequest(),void 0;var t=e.ioArgs,o=t.args,n=o.form;if(n){for(var r=t._contentToClean,a=0;a<r.length;a++){var i=r[a];if(dojo.isSafari<3)for(var s=0;s<n.childNodes.length;s++){var d=n.childNodes[s];if(d.name==i){dojo._destroyElement(d);break}}else dojo._destroyElement(n[i]),n[i]=null}t._originalAction&&n.setAttribute("action",t._originalAction),t._originalTarget&&(n.setAttribute("target",t._originalTarget),n.target=t._originalTarget)}t._finished=!0}}),dojo._hasResource["dojo.data.util.filter"]||(dojo._hasResource["dojo.data.util.filter"]=!0,dojo.provide("dojo.data.util.filter"),dojo.data.util.filter.patternToRegExp=function(e,t){for(var o="^",n=null,r=0;r<e.length;r++)switch(n=e.charAt(r)){case"\\":o+=n,r++,o+=e.charAt(r);break;case"*":o+=".*";break;case"?":o+=".";break;case"$":case"^":case"/":case"+":case".":case"|":case"(":case")":case"{":case"}":case"[":case"]":o+="\\";default:o+=n}return o+="$",t?new RegExp(o,"i"):new RegExp(o)}),dojo._hasResource["dojo.data.util.sorter"]||(dojo._hasResource["dojo.data.util.sorter"]=!0,dojo.provide("dojo.data.util.sorter"),dojo.data.util.sorter.basicComparator=function(e,t){var o=0;return e>t||"undefined"==typeof e||null===e?o=1:(t>e||"undefined"==typeof t||null===t)&&(o=-1),o},dojo.data.util.sorter.createSortFunction=function(e,t){function o(e,o){return function(n,r){var a=t.getValue(n,e),i=t.getValue(r,e),s=null;return t.comparatorMap&&("string"!=typeof e&&(e=t.getIdentity(e)),s=t.comparatorMap[e]||dojo.data.util.sorter.basicComparator),s=s||dojo.data.util.sorter.basicComparator,o*s(a,i)}}for(var n=[],r=0;r<e.length;r++)if(sortAttribute=e[r],sortAttribute.attribute){var a=sortAttribute.descending?-1:1;n.push(o(sortAttribute.attribute,a))}return function(e,t){for(var o=0;o<n.length;){var r=n[o++](e,t);if(0!==r)return r}return 0}}),dojo._hasResource["dojo.data.util.simpleFetch"]||(dojo._hasResource["dojo.data.util.simpleFetch"]=!0,dojo.provide("dojo.data.util.simpleFetch"),dojo.data.util.simpleFetch.fetch=function(e){e=e||{},e.store||(e.store=this);var t=this,o=function(e,t){if(t.onError){var o=t.scope||dojo.global;t.onError.call(o,e,t)}},n=function(e,o){var n=o.abort||null,r=!1,a=o.start?o.start:0,i=o.count?a+o.count:e.length;o.abort=function(){r=!0,n&&n.call(o)};var s=o.scope||dojo.global;if(o.store||(o.store=t),o.onBegin&&o.onBegin.call(s,e.length,o),o.sort&&e.sort(dojo.data.util.sorter.createSortFunction(o.sort,t)),o.onItem)for(var d=a;d<e.length&&i>d;++d){var l=e[d];r||o.onItem.call(s,l,o)}if(o.onComplete&&!r){var c=null;o.onItem||(c=e.slice(a,i)),o.onComplete.call(s,c,o)}};return this._fetchItems(e,n,o),e}),dojo._hasResource["dojo.data.ItemFileReadStore"]||(dojo._hasResource["dojo.data.ItemFileReadStore"]=!0,dojo.provide("dojo.data.ItemFileReadStore"),dojo.declare("dojo.data.ItemFileReadStore",null,{constructor:function(e){this._arrayOfAllItems=[],this._arrayOfTopLevelItems=[],this._loadFinished=!1,this._jsonFileUrl=e.url,this._jsonData=e.data,this._datatypeMap=e.typeMap||{},this._datatypeMap.Date||(this._datatypeMap.Date={type:Date,deserialize:function(e){return dojo.date.stamp.fromISOString(e)}}),this._features={"dojo.data.api.Read":!0,"dojo.data.api.Identity":!0},this._itemsByIdentity=null,this._storeRefPropName="_S",this._itemNumPropName="_0",this._rootItemPropName="_RI",this._loadInProgress=!1,this._queuedFetches=[]},url:"",_assertIsItem:function(e){if(!this.isItem(e))throw new Error("dojo.data.ItemFileReadStore: Invalid item argument.")},_assertIsAttribute:function(e){if("string"!=typeof e)throw new Error("dojo.data.ItemFileReadStore: Invalid attribute argument.")},getValue:function(e,t,o){var n=this.getValues(e,t);return n.length>0?n[0]:o},getValues:function(e,t){return this._assertIsItem(e),this._assertIsAttribute(t),e[t]||[]},getAttributes:function(e){this._assertIsItem(e);var t=[];for(var o in e)o!==this._storeRefPropName&&o!==this._itemNumPropName&&o!==this._rootItemPropName&&t.push(o);return t},hasAttribute:function(e,t){return this.getValues(e,t).length>0},containsValue:function(e,t,o){var n=void 0;return"string"==typeof o&&(n=dojo.data.util.filter.patternToRegExp(o,!1)),this._containsValue(e,t,o,n)},_containsValue:function(e,t,o,n){return dojo.some(this.getValues(e,t),function(e){if(null!==e&&!dojo.isObject(e)&&n){if(e.toString().match(n))return!0}else if(o===e)return!0})},isItem:function(e){return e&&e[this._storeRefPropName]===this&&this._arrayOfAllItems[e[this._itemNumPropName]]===e?!0:!1},isItemLoaded:function(e){return this.isItem(e)},loadItem:function(e){this._assertIsItem(e.item)},getFeatures:function(){return this._features},getLabel:function(e){return this._labelAttr&&this.isItem(e)?this.getValue(e,this._labelAttr):void 0},getLabelAttributes:function(){return this._labelAttr?[this._labelAttr]:null},_fetchItems:function(e,t,o){var n=this,r=function(e,o){var r=[];if(e.query){var a=e.queryOptions?e.queryOptions.ignoreCase:!1,i={};for(var s in e.query){var d=e.query[s];"string"==typeof d&&(i[s]=dojo.data.util.filter.patternToRegExp(d,a))}for(var l=0;l<o.length;++l){var c=!0,h=o[l];if(null===h)c=!1;else for(var s in e.query){var d=e.query[s];n._containsValue(h,s,d,i[s])||(c=!1)}c&&r.push(h)}t(r,e)}else{for(var l=0;l<o.length;++l){var u=o[l];null!==u&&r.push(u)}t(r,e)}};if(this._loadFinished)r(e,this._getItemsArray(e.queryOptions));else if(this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:e,filter:r});else{this._loadInProgress=!0;var a={url:n._jsonFileUrl,handleAs:"json-comment-optional"},i=dojo.xhrGet(a);i.addCallback(function(t){try{n._getItemsFromLoadedData(t),n._loadFinished=!0,n._loadInProgress=!1,r(e,n._getItemsArray(e.queryOptions)),n._handleQueuedFetches()}catch(a){n._loadFinished=!0,n._loadInProgress=!1,o(a,e)}}),i.addErrback(function(t){n._loadInProgress=!1,o(t,e)})}else if(this._jsonData)try{this._loadFinished=!0,this._getItemsFromLoadedData(this._jsonData),this._jsonData=null,r(e,this._getItemsArray(e.queryOptions))}catch(s){o(s,e)}else o(new Error("dojo.data.ItemFileReadStore: No JSON source data was provided as either URL or a nested Javascript object."),e)},_handleQueuedFetches:function(){if(this._queuedFetches.length>0){for(var e=0;e<this._queuedFetches.length;e++){var t=this._queuedFetches[e],o=t.args,n=t.filter;n?n(o,this._getItemsArray(o.queryOptions)):this.fetchItemByIdentity(o)}this._queuedFetches=[]}},_getItemsArray:function(e){return e&&e.deep?this._arrayOfAllItems:this._arrayOfTopLevelItems},close:function(){},_getItemsFromLoadedData:function(e){function t(e){var t=null!=e&&"object"==typeof e&&!dojo.isArray(e)&&!dojo.isFunction(e)&&e.constructor==Object&&"undefined"==typeof e._reference&&"undefined"==typeof e._type&&"undefined"==typeof e._value;return t}function o(e){n._arrayOfAllItems.push(e);for(var r in e){var a=e[r];if(a)if(dojo.isArray(a))for(var i=a,s=0;s<i.length;++s){var d=i[s];t(d)&&o(d)}else t(a)&&o(a)}}var n=this;this._labelAttr=e.label;var r,a;for(this._arrayOfAllItems=[],this._arrayOfTopLevelItems=e.items,r=0;r<this._arrayOfTopLevelItems.length;++r)a=this._arrayOfTopLevelItems[r],o(a),a[this._rootItemPropName]=!0;var i,s={};for(r=0;r<this._arrayOfAllItems.length;++r){a=this._arrayOfAllItems[r];for(i in a){if(i!==this._rootItemPropName){var d=a[i];null!==d?dojo.isArray(d)||(a[i]=[d]):a[i]=[null]}s[i]=i}}for(;s[this._storeRefPropName];)this._storeRefPropName+="_";for(;s[this._itemNumPropName];)this._itemNumPropName+="_";var l,c=e.identifier;if(c)for(this._itemsByIdentity={},this._features["dojo.data.api.Identity"]=c,r=0;r<this._arrayOfAllItems.length;++r){a=this._arrayOfAllItems[r],l=a[c];var h=l[0];if(this._itemsByIdentity[h]){if(this._jsonFileUrl)throw new Error("dojo.data.ItemFileReadStore:  The json data as specified by: ["+this._jsonFileUrl+"] is malformed.  Items within the list have identifier: ["+c+"].  Value collided: ["+h+"]");if(this._jsonData)throw new Error("dojo.data.ItemFileReadStore:  The json data provided by the creation arguments is malformed.  Items within the list have identifier: ["+c+"].  Value collided: ["+h+"]")}else this._itemsByIdentity[h]=a}else this._features["dojo.data.api.Identity"]=Number;for(r=0;r<this._arrayOfAllItems.length;++r)a=this._arrayOfAllItems[r],a[this._storeRefPropName]=this,a[this._itemNumPropName]=r;for(r=0;r<this._arrayOfAllItems.length;++r){a=this._arrayOfAllItems[r];for(i in a){l=a[i];for(var u=0;u<l.length;++u)if(d=l[u],null!==d&&"object"==typeof d){if(d._type&&d._value){var f=d._type,m=this._datatypeMap[f];if(!m)throw new Error("dojo.data.ItemFileReadStore: in the typeMap constructor arg, no object class was specified for the datatype '"+f+"'");if(dojo.isFunction(m))l[u]=new m(d._value);else{if(!dojo.isFunction(m.deserialize))throw new Error("dojo.data.ItemFileReadStore: Value provided in typeMap was neither a constructor, nor a an object with a deserialize function");l[u]=m.deserialize(d._value)}}if(d._reference){var j=d._reference;if(dojo.isString(j))l[u]=this._itemsByIdentity[j];else for(var p=0;p<this._arrayOfAllItems.length;++p){var v=this._arrayOfAllItems[p],g=!0;for(var _ in j)v[_]!=j[_]&&(g=!1);g&&(l[u]=v)}}}}}},getIdentity:function(e){var t=this._features["dojo.data.api.Identity"];if(t===Number)return e[this._itemNumPropName];var o=e[t];return o?o[0]:null},fetchItemByIdentity:function(e){if(this._loadFinished){var t=this._getItemByIdentity(e.identity);if(e.onItem){var o=e.scope?e.scope:dojo.global;e.onItem.call(o,t)}}else{var n=this;if(this._jsonFileUrl)if(this._loadInProgress)this._queuedFetches.push({args:e});else{this._loadInProgress=!0;var r={url:n._jsonFileUrl,handleAs:"json-comment-optional"},a=dojo.xhrGet(r);a.addCallback(function(t){var o=e.scope?e.scope:dojo.global;try{n._getItemsFromLoadedData(t),n._loadFinished=!0,n._loadInProgress=!1;var r=n._getItemByIdentity(e.identity);e.onItem&&e.onItem.call(o,r),n._handleQueuedFetches()}catch(a){n._loadInProgress=!1,e.onError&&e.onError.call(o,a)}}),a.addErrback(function(t){if(n._loadInProgress=!1,e.onError){var o=e.scope?e.scope:dojo.global;e.onError.call(o,t)}})}else if(this._jsonData){n._getItemsFromLoadedData(n._jsonData),n._jsonData=null,n._loadFinished=!0;var t=n._getItemByIdentity(e.identity);if(e.onItem){var o=e.scope?e.scope:dojo.global;e.onItem.call(o,t)}}}},_getItemByIdentity:function(e){var t=null;return t=this._itemsByIdentity?this._itemsByIdentity[e]:this._arrayOfAllItems[e],void 0===t&&(t=null),t},getIdentityAttributes:function(){var e=this._features["dojo.data.api.Identity"];return e===Number?null:[e]},_forceLoad:function(){var e=this;if(this._jsonFileUrl){var t={url:e._jsonFileUrl,handleAs:"json-comment-optional",sync:!0},o=dojo.xhrGet(t);o.addCallback(function(t){try{e._loadInProgress===!0||e._loadFinished||(e._getItemsFromLoadedData(t),e._loadFinished=!0)}catch(o){throw console.log(o),o}}),o.addErrback(function(e){throw e})}else this._jsonData&&(e._getItemsFromLoadedData(e._jsonData),e._jsonData=null,e._loadFinished=!0)}}),dojo.extend(dojo.data.ItemFileReadStore,dojo.data.util.simpleFetch)),dojo._hasResource["dojo.data.ItemFileWriteStore"]||(dojo._hasResource["dojo.data.ItemFileWriteStore"]=!0,dojo.provide("dojo.data.ItemFileWriteStore"),dojo.declare("dojo.data.ItemFileWriteStore",dojo.data.ItemFileReadStore,{constructor:function(){this._features["dojo.data.api.Write"]=!0,this._features["dojo.data.api.Notification"]=!0,this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}},this._datatypeMap.Date.serialize||(this._datatypeMap.Date.serialize=function(e){return dojo.date.stamp.toISOString(e,{zulu:!0})}),this._saveInProgress=!1},_assert:function(e){if(!e)throw new Error("assertion failed in ItemFileWriteStore")},_getIdentifierAttribute:function(){var e=this.getFeatures()["dojo.data.api.Identity"];return e},newItem:function(e,t){if(this._assert(!this._saveInProgress),this._loadFinished||this._forceLoad(),"object"!=typeof e&&"undefined"!=typeof e)throw new Error("newItem() was passed something other than an object");var o=null,n=this._getIdentifierAttribute();if(n===Number)o=this._arrayOfAllItems.length;else{if(o=e[n],"undefined"==typeof o)throw new Error("newItem() was not passed an identity for the new item");if(dojo.isArray(o))throw new Error("newItem() was not passed an single-valued identity")}this._itemsByIdentity&&this._assert("undefined"==typeof this._itemsByIdentity[o]),this._assert("undefined"==typeof this._pending._newItems[o]),this._assert("undefined"==typeof this._pending._deletedItems[o]);var r={};r[this._storeRefPropName]=this,r[this._itemNumPropName]=this._arrayOfAllItems.length,this._itemsByIdentity&&(this._itemsByIdentity[o]=r),this._arrayOfAllItems.push(r);var a=null;if(t&&t.parent&&t.attribute){a={item:t.parent,attribute:t.attribute,oldValue:void 0};var i=this.getValues(t.parent,t.attribute);if(i&&i.length>0){var s=i.slice(0,i.length);a.oldValue=1===i.length?i[0]:i.slice(0,i.length),s.push(r),this._setValueOrValues(t.parent,t.attribute,s,!1),a.newValue=this.getValues(t.parent,t.attribute)
}else this._setValueOrValues(t.parent,t.attribute,r,!1),a.newValue=r}else r[this._rootItemPropName]=!0,this._arrayOfTopLevelItems.push(r);this._pending._newItems[o]=r;for(var d in e){if(d===this._storeRefPropName||d===this._itemNumPropName)throw new Error("encountered bug in ItemFileWriteStore.newItem");var l=e[d];dojo.isArray(l)||(l=[l]),r[d]=l}return this.onNew(r,a),r},_removeArrayElement:function(e,t){var o=dojo.indexOf(e,t);return-1!=o?(e.splice(o,1),!0):!1},deleteItem:function(e){this._assert(!this._saveInProgress),this._assertIsItem(e);var t=e[this._itemNumPropName];this._arrayOfAllItems[t]=null;var o=this.getIdentity(e);return e[this._storeRefPropName]=null,this._itemsByIdentity&&delete this._itemsByIdentity[o],this._pending._deletedItems[o]=e,e[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,e),this.onDelete(e),!0},setValue:function(e,t,o){return this._setValueOrValues(e,t,o,!0)},setValues:function(e,t,o){return this._setValueOrValues(e,t,o,!0)},unsetAttribute:function(e,t){return this._setValueOrValues(e,t,[],!0)},_setValueOrValues:function(e,t,o,n){this._assert(!this._saveInProgress),this._assertIsItem(e),this._assert(dojo.isString(t)),this._assert("undefined"!=typeof o);var r=this._getIdentifierAttribute();if(t==r)throw new Error("ItemFileWriteStore does not have support for changing the value of an item's identifier.");var a=this._getValueOrValues(e,t),i=this.getIdentity(e);if(!this._pending._modifiedItems[i]){var s={};for(var d in e)if(d===this._storeRefPropName||d===this._itemNumPropName||d===this._rootItemPropName)s[d]=e[d];else{for(var l=e[d],c=[],h=0;h<l.length;++h)c.push(l[h]);s[d]=c}this._pending._modifiedItems[i]=s}var u=!1;if(dojo.isArray(o)&&0===o.length)u=delete e[t],o=void 0;else{var f=[];if(dojo.isArray(o))for(var m=o,j=0;j<m.length;++j)f.push(m[j]);else{var p=o;f.push(p)}e[t]=f,u=!0}return n&&this.onSet(e,t,a,o),u},_getValueOrValues:function(e,t){var o=void 0;if(this.hasAttribute(e,t)){var n=this.getValues(e,t);o=1==n.length?n[0]:n}return o},_flatten:function(e){if(this.isItem(e)){var t=e,o=this.getIdentity(t),n={_reference:o};return n}if("object"==typeof e)for(type in this._datatypeMap){var r=this._datatypeMap[type];if(dojo.isObject(r)&&!dojo.isFunction(r)){if(e instanceof r.type){if(!r.serialize)throw new Error("ItemFileWriteStore:  No serializer defined for type mapping: ["+type+"]");return{_type:type,_value:r.serialize(e)}}}else if(e instanceof r)return{_type:type,_value:e.toString()}}return e},_getNewFileContentString:function(){var e={},t=this._getIdentifierAttribute();t!==Number&&(e.identifier=t),this._labelAttr&&(e.label=this._labelAttr),e.items=[];for(var o=0;o<this._arrayOfAllItems.length;++o){var n=this._arrayOfAllItems[o];if(null!==n){serializableItem={};for(var r in n)if(r!==this._storeRefPropName&&r!==this._itemNumPropName){var a=r,i=this.getValues(n,a);if(1==i.length)serializableItem[a]=this._flatten(i[0]);else for(var s=[],d=0;d<i.length;++d)s.push(this._flatten(i[d])),serializableItem[a]=s}e.items.push(serializableItem)}}var l=!0;return dojo.toJson(e,l)},save:function(e){this._assert(!this._saveInProgress),this._saveInProgress=!0;var t=this,o=function(){if(t._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}},t._saveInProgress=!1,e&&e.onComplete){var o=e.scope||dojo.global;e.onComplete.call(o)}},n=function(){if(t._saveInProgress=!1,e&&e.onError){var o=e.scope||dojo.global;e.onError.call(o)}};if(this._saveEverything){var r=this._getNewFileContentString();this._saveEverything(o,n,r)}this._saveCustom&&this._saveCustom(o,n),this._saveEverything||this._saveCustom||o()},revert:function(){this._assert(!this._saveInProgress);var e;for(e in this._pending._newItems){var t=this._pending._newItems[e];t[this._storeRefPropName]=null,this._arrayOfAllItems[t[this._itemNumPropName]]=null,t[this._rootItemPropName]&&this._removeArrayElement(this._arrayOfTopLevelItems,t),this._itemsByIdentity&&delete this._itemsByIdentity[e]}for(e in this._pending._modifiedItems){var o=this._pending._modifiedItems[e],n=null;n=this._itemsByIdentity?this._itemsByIdentity[e]:this._arrayOfAllItems[e],o[this._storeRefPropName]=this,n[this._storeRefPropName]=null;var r=n[this._itemNumPropName];this._arrayOfAllItems[r]=o,n[this._rootItemPropName]&&(r=n[this._itemNumPropName],this._arrayOfTopLevelItems[r]=o),this._itemsByIdentity&&(this._itemsByIdentity[e]=o)}for(e in this._pending._deletedItems){var a=this._pending._deletedItems[e];a[this._storeRefPropName]=this;var i=a[this._itemNumPropName];this._arrayOfAllItems[i]=a,this._itemsByIdentity&&(this._itemsByIdentity[e]=a),a[this._rootItemPropName]&&this._arrayOfTopLevelItems.push(a)}return this._pending={_newItems:{},_modifiedItems:{},_deletedItems:{}},!0},isDirty:function(e){if(e){var t=this.getIdentity(e);return new Boolean(this._pending._newItems[t]||this._pending._modifiedItems[t]||this._pending._deletedItems[t])}var o;for(o in this._pending._newItems)return!0;for(o in this._pending._modifiedItems)return!0;for(o in this._pending._deletedItems)return!0;return!1},onSet:function(){},onNew:function(){},onDelete:function(){}}));