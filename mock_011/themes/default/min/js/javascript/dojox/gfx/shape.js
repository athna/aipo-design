dojo._hasResource["dojox.gfx.shape"]||(dojo._hasResource["dojox.gfx.shape"]=!0,dojo.provide("dojox.gfx.shape"),dojo.require("dojox.gfx._base"),dojo.declare("dojox.gfx.Shape",null,{constructor:function(){this.rawNode=null,this.shape=null,this.matrix=null,this.fillStyle=null,this.strokeStyle=null,this.bbox=null,this.parent=null,this.parentMatrix=null},getNode:function(){return this.rawNode},getShape:function(){return this.shape},getTransform:function(){return this.matrix},getFill:function(){return this.fillStyle},getStroke:function(){return this.strokeStyle},getParent:function(){return this.parent},getBoundingBox:function(){return this.bbox},getTransformedBoundingBox:function(){var t=this.getBoundingBox();if(!t)return null;var e=this._getRealMatrix(),o=[],r=dojox.gfx.matrix;return o.push(r.multiplyPoint(e,t.x,t.y)),o.push(r.multiplyPoint(e,t.x+t.width,t.y)),o.push(r.multiplyPoint(e,t.x+t.width,t.y+t.height)),o.push(r.multiplyPoint(e,t.x,t.y+t.height)),o},getEventSource:function(){return this.rawNode},setShape:function(t){return this.shape=dojox.gfx.makeParameters(this.shape,t),this.bbox=null,this},setFill:function(t){if(!t)return this.fillStyle=null,this;var e=null;if("object"==typeof t&&"type"in t)switch(t.type){case"linear":e=dojox.gfx.makeParameters(dojox.gfx.defaultLinearGradient,t);break;case"radial":e=dojox.gfx.makeParameters(dojox.gfx.defaultRadialGradient,t);break;case"pattern":e=dojox.gfx.makeParameters(dojox.gfx.defaultPattern,t)}else e=dojox.gfx.normalizeColor(t);return this.fillStyle=e,this},setStroke:function(t){if(!t)return this.strokeStyle=null,this;"string"==typeof t&&(t={color:t});var e=this.strokeStyle=dojox.gfx.makeParameters(dojox.gfx.defaultStroke,t);return e.color=dojox.gfx.normalizeColor(e.color),this},setTransform:function(t){return this.matrix=dojox.gfx.matrix.clone(t?dojox.gfx.matrix.normalize(t):dojox.gfx.matrix.identity),this._applyTransform()},_applyTransform:function(){return this},moveToFront:function(){var t=this.getParent();return t&&(t._moveChildToFront(this),this._moveToFront()),this},moveToBack:function(){var t=this.getParent();return t&&(t._moveChildToBack(this),this._moveToBack()),this},_moveToFront:function(){},_moveToBack:function(){},applyRightTransform:function(t){return t?this.setTransform([this.matrix,t]):this},applyLeftTransform:function(t){return t?this.setTransform([t,this.matrix]):this},applyTransform:function(t){return t?this.setTransform([this.matrix,t]):this},removeShape:function(t){return this.parent&&this.parent.remove(this,t),this},_setParent:function(t,e){return this.parent=t,this._updateParentMatrix(e)},_updateParentMatrix:function(t){return this.parentMatrix=t?dojox.gfx.matrix.clone(t):null,this._applyTransform()},_getRealMatrix:function(){for(var t=this.matrix,e=this.parent;e;)e.matrix&&(t=dojox.gfx.matrix.multiply(e.matrix,t)),e=e.parent;return t}}),dojox.gfx.shape._eventsProcessing={connect:function(t,e,o){return arguments.length>2?dojo.connect(this.getEventSource(),t,e,o):dojo.connect(this.getEventSource(),t,e)},disconnect:function(t){dojo.disconnect(t)}},dojo.extend(dojox.gfx.Shape,dojox.gfx.shape._eventsProcessing),dojox.gfx.shape.Container={_init:function(){this.children=[]},add:function(t){var e=t.getParent();return e&&e.remove(t,!0),this.children.push(t),t._setParent(this,this._getRealMatrix())},remove:function(t,e){for(var o=0;o<this.children.length;++o)if(this.children[o]==t){e||t._setParent(null,null),this.children.splice(o,1);break}return this},clear:function(){return this.children=[],this},_moveChildToFront:function(t){for(var e=0;e<this.children.length;++e)if(this.children[e]==t){this.children.splice(e,1),this.children.push(t);break}return this},_moveChildToBack:function(t){for(var e=0;e<this.children.length;++e)if(this.children[e]==t){this.children.splice(e,1),this.children.unshift(t);break}return this}},dojo.declare("dojox.gfx.shape.Surface",null,{constructor:function(){this.rawNode=null},getEventSource:function(){return this.rawNode},_getRealMatrix:function(){return null}}),dojo.extend(dojox.gfx.shape.Surface,dojox.gfx.shape._eventsProcessing),dojo.declare("dojox.gfx.Point",null,{}),dojo.declare("dojox.gfx.Rectangle",null,{}),dojo.declare("dojox.gfx.shape.Rect",dojox.gfx.Shape,{constructor:function(t){this.shape=dojo.clone(dojox.gfx.defaultRect),this.rawNode=t},getBoundingBox:function(){return this.shape}}),dojo.declare("dojox.gfx.shape.Ellipse",dojox.gfx.Shape,{constructor:function(t){this.shape=dojo.clone(dojox.gfx.defaultEllipse),this.rawNode=t},getBoundingBox:function(){if(!this.bbox){var t=this.shape;this.bbox={x:t.cx-t.rx,y:t.cy-t.ry,width:2*t.rx,height:2*t.ry}}return this.bbox}}),dojo.declare("dojox.gfx.shape.Circle",dojox.gfx.Shape,{constructor:function(t){this.shape=dojo.clone(dojox.gfx.defaultCircle),this.rawNode=t},getBoundingBox:function(){if(!this.bbox){var t=this.shape;this.bbox={x:t.cx-t.r,y:t.cy-t.r,width:2*t.r,height:2*t.r}}return this.bbox}}),dojo.declare("dojox.gfx.shape.Line",dojox.gfx.Shape,{constructor:function(t){this.shape=dojo.clone(dojox.gfx.defaultLine),this.rawNode=t},getBoundingBox:function(){if(!this.bbox){var t=this.shape;this.bbox={x:Math.min(t.x1,t.x2),y:Math.min(t.y1,t.y2),width:Math.abs(t.x2-t.x1),height:Math.abs(t.y2-t.y1)}}return this.bbox}}),dojo.declare("dojox.gfx.shape.Polyline",dojox.gfx.Shape,{constructor:function(t){this.shape=dojo.clone(dojox.gfx.defaultPolyline),this.rawNode=t},setShape:function(t,e){return t&&t instanceof Array?(dojox.gfx.Shape.prototype.setShape.call(this,{points:t}),e&&this.shape.points.length&&this.shape.points.push(this.shape.points[0])):dojox.gfx.Shape.prototype.setShape.call(this,t),this},getBoundingBox:function(){if(!this.bbox&&this.shape.points.length){for(var t=this.shape.points,e=t.length,o=t[0],r={l:o.x,t:o.y,r:o.x,b:o.y},n=1;e>n;++n)o=t[n],r.l>o.x&&(r.l=o.x),r.r<o.x&&(r.r=o.x),r.t>o.y&&(r.t=o.y),r.b<o.y&&(r.b=o.y);this.bbox={x:r.l,y:r.t,width:r.r-r.l,height:r.b-r.t}}return this.bbox}}),dojo.declare("dojox.gfx.shape.Image",dojox.gfx.Shape,{constructor:function(t){this.shape=dojo.clone(dojox.gfx.defaultImage),this.rawNode=t},getBoundingBox:function(){return this.shape},setStroke:function(){return this},setFill:function(){return this}}),dojo.declare("dojox.gfx.shape.Text",dojox.gfx.Shape,{constructor:function(t){this.fontStyle=null,this.shape=dojo.clone(dojox.gfx.defaultText),this.rawNode=t},setFont:function(t){return this.fontStyle="string"==typeof t?dojox.gfx.splitFontString(t):dojox.gfx.makeParameters(dojox.gfx.defaultFont,t),this._setFont(),this}}),dojox.gfx.shape.Creator={createShape:function(t){switch(t.type){case dojox.gfx.defaultPath.type:return this.createPath(t);case dojox.gfx.defaultRect.type:return this.createRect(t);case dojox.gfx.defaultCircle.type:return this.createCircle(t);case dojox.gfx.defaultEllipse.type:return this.createEllipse(t);case dojox.gfx.defaultLine.type:return this.createLine(t);case dojox.gfx.defaultPolyline.type:return this.createPolyline(t);case dojox.gfx.defaultImage.type:return this.createImage(t);case dojox.gfx.defaultText.type:return this.createText(t);case dojox.gfx.defaultTextPath.type:return this.createTextPath(t)}return null},createGroup:function(){return this.createObject(dojox.gfx.Group)},createRect:function(t){return this.createObject(dojox.gfx.Rect,t)},createEllipse:function(t){return this.createObject(dojox.gfx.Ellipse,t)},createCircle:function(t){return this.createObject(dojox.gfx.Circle,t)},createLine:function(t){return this.createObject(dojox.gfx.Line,t)},createPolyline:function(t){return this.createObject(dojox.gfx.Polyline,t)},createImage:function(t){return this.createObject(dojox.gfx.Image,t)},createText:function(t){return this.createObject(dojox.gfx.Text,t)},createPath:function(t){return this.createObject(dojox.gfx.Path,t)},createTextPath:function(t){return this.createObject(dojox.gfx.TextPath,{}).setText(t)},createObject:function(){return null}});