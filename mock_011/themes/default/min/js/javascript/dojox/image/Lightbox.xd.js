dojo._xdResourceLoaded({depends:[["provide","dojox.image.Lightbox"],["require","dijit.Dialog"],["require","dojox.fx"]],defineResource:function(i){i._hasResource["dojox.image.Lightbox"]||(i._hasResource["dojox.image.Lightbox"]=!0,i.provide("dojox.image.Lightbox"),i.experimental("dojox.image.Lightbox"),i.require("dijit.Dialog"),i.require("dojox.fx"),i.declare("dojox.image.Lightbox",dijit._Widget,{group:"",title:"",href:"",duration:500,_allowPassthru:!1,_attachedDialog:null,startup:function(){this.inherited("startup",arguments);var i=dijit.byId("dojoxLightboxDialog");i?this._attachedDialog=i:(this._attachedDialog=new dojox.image._LightboxDialog({id:"dojoxLightboxDialog"}),this._attachedDialog.startup()),this.store||(this._addSelf(),this.connect(this.domNode,"onclick","_handleClick"))},_addSelf:function(){this._attachedDialog.addImage({href:this.href,title:this.title},this.group||null)},_handleClick:function(i){this._allowPassthru||(i.preventDefault(),this.show())},show:function(){this._attachedDialog.show(this)},disable:function(){this._allowPassthru=!0},enable:function(){this._allowPassthru=!1}}),i.declare("dojox.image._LightboxDialog",dijit.Dialog,{title:"",inGroup:null,imgUrl:"",_groups:{XnoGroupX:[]},_imageReady:!1,templateString:'<div class="dojoxLightbox" dojoAttachPoint="containerNode">\r\n	<div style="position:relative">\r\n		<div dojoAttachPoint="imageContainer" class="dojoxLightboxContainer">\r\n			<img dojoAttachPoint="imgNode" src="${imgUrl}" class="dojoxLightboxImage" alt="${title}">\r\n			<div class="dojoxLightboxFooter" dojoAttachPoint="titleNode">\r\n				<div class="dijitInline LightboxClose" dojoAttachPoint="closeNode"></div>\r\n				<div class="dijitInline LightboxNext" dojoAttachPoint="nextNode"></div>	\r\n				<div class="dijitInline LightboxPrev" dojoAttachPoint="prevNode"></div>\r\n\r\n				<div class="dojoxLightboxText"><span dojoAttachPoint="textNode">${title}</span><span dojoAttachPoint="groupCount" class="dojoxLightboxGroupText"></span></div>\r\n			</div>\r\n		</div>	\r\n		\r\n	</div>\r\n</div>\r\n',startup:function(){this.inherited("startup",arguments),i.connect(document.documentElement,"onkeypress",this,"_handleKey"),this.connect(window,"onresize","_position"),this.connect(this.nextNode,"onclick","_nextImage"),this.connect(this.prevNode,"onclick","_prevImage"),this.connect(this.closeNode,"onclick","hide")},show:function(t){if(i.style(this.imgNode,"opacity","0"),i.style(this.titleNode,"opacity","0"),this.open||this.inherited("show",arguments),this._imageReady=!1,this.imgNode.src=t.href,t.group&&"XnoGroupX"!=t||this.inGroup){if(!this.inGroup){this.inGroup=this._groups[t.group];var o=0;i.forEach(this.inGroup,function(i){i.href==t.href&&(this._positionIndex=o),o++},this)}this._positionIndex||(this._positionIndex=0,this.imgNode.src=this.inGroup[this._positionIndex].href),this.groupCount.innerHTML=" ("+(this._positionIndex+1)+" of "+this.inGroup.length+")",this.prevNode.style.visibility="visible",this.nextNode.style.visibility="visible"}else this.groupCount.innerHTML="",this.prevNode.style.visibility="hidden",this.nextNode.style.visibility="hidden";this.textNode.innerHTML=t.title,this._imageReady&&this.imgNode.complete!==!0?this.resizeTo({w:this.imgNode.width,h:this.imgNode.height,duration:1}):(this._imgConnect=i.connect(this.imgNode,"onload",this,function(){this._imageReady=!0,this.resizeTo({w:this.imgNode.width,h:this.imgNode.height,duration:this.duration}),i.disconnect(this._imgConnect)}),i.isIE&&(this.imgNode.src=this.imgNode.src))},_nextImage:function(){this._positionIndex+1<this.inGroup.length?this._positionIndex++:this._positionIndex=0,this._loadImage()},_prevImage:function(){0==this._positionIndex?this._positionIndex=this.inGroup.length-1:this._positionIndex--,this._loadImage()},_loadImage:function(){var t=i.fx.combine([i.fadeOut({node:this.imgNode,duration:this.duration/2}),i.fadeOut({node:this.titleNode,duration:this.duration/2})]);this.connect(t,"onEnd","_prepNodes"),t.play(10)},_prepNodes:function(){this._imageReady=!1,this.show({href:this.inGroup[this._positionIndex].href,title:this.inGroup[this._positionIndex].title})},resizeTo:function(i){var t=dojox.fx.sizeTo({node:this.containerNode,duration:i.duration||this.duration,width:i.w,height:i.h+30});this.connect(t,"onEnd","_showImage"),t.play(this.duration)},_showImage:function(){i.fadeIn({node:this.imgNode,duration:this.duration,onEnd:i.hitch(this,"_showNav")}).play(75)},_showNav:function(){i.fadeIn({node:this.titleNode,duration:200}).play(25)},hide:function(){i.fadeOut({node:this.titleNode,duration:200}).play(25),this.inherited("hide",arguments),this.inGroup=null,this._positionIndex=null},addImage:function(i,t){var o=t;i.href&&(o?this._groups[o]?this._groups[o].push(i):this._groups[o]=[i]:this._groups.XnoGroupX.push(i))},_handleKey:function(t){if(this.open){var o=t.charCode==i.keys.SPACE?i.keys.SPACE:t.keyCode;switch(o){case i.keys.ESCAPE:this.hide();break;case i.keys.DOWN_ARROW:case i.keys.RIGHT_ARROW:case 78:this._nextImage();break;case i.keys.UP_ARROW:case i.keys.LEFT_ARROW:case 80:this._prevImage()}}}}))}});