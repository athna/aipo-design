if(!dojo._hasResource["aimluck.widget.Dialog"]){dojo._hasResource["aimluck.widget.Dialog"]=!0,dojo.provide("aimluck.widget.Dialog"),dojo.provide("aimluck.widget.DialogSub"),dojo.provide("aimluck.widget.DialogUnderlay"),dojo.provide("aimluck.widget.Timeout"),dojo.require("dijit.Dialog"),dojo.requireLocalization("aipo","locale");var nlsStrings=dojo.i18n.getLocalization("aipo","locale");dojo.declare("aimluck.widget.DialogUnderlay",[dijit.DialogUnderlay],{templateString:"<div class=modalDialogUnderlayWrapper id='${id}_underlay'><div class=modalDialogUnderlay dojoAttachPoint='node'></div></div>",layout:function(){var o="";os="",os.top="",os.left="",o.width="",o.height=""}}),dojo.declare("aimluck.widget.Timeout",[dijit._Widget,dijit._Templated],{templateString:"<div class=modalDialogUnderlayWrapper id='${id}_underlay'><div class=modalDialogUnderlay dojoAttachPoint='node' redirecturl=\"${redirectUrl}\"></div></div>",redirectUrl:"about:blank",postCreate:function(){window.location.href=this.redirectUrl}}),dojo.declare("aimluck.widget.DialogSub",[aimluck.widget.Dialog,dijit.Dialog],{templateString:"<div id='modalDialog' class='modalDialog' dojoattachpoint='wrapper'><span dojoattachpoint='tabStartOuter' dojoonfocus='trapTabs' dojoonblur='clearTrap'tabindex='0'></span><span dojoattachpoint='tabStart' dojoonfocus='trapTabs' dojoonblur='clearTrap' tabindex='0'></span><div dojoattachpoint='containerNode' style='position: relative; z-index: 2;'></div><span dojoattachpoint='tabEnd' dojoonfocus='trapTabs' dojoonblur='clearTrap' tabindex='0'></span><span dojoattachpoint='tabEndOuter' dojoonfocus='trapTabs' dojoonblur='clearTrap' tabindex='0'></span></div>"}),dojo.declare("aimluck.widget.Dialog",[dijit.Dialog],{loadingMessage:"<div class='auiPopup indicatorDialog center'><i class='auiIcon auiIconIndicator'></i> "+nlsStrings.LOADING_STR+"</div>",errorMessage:"<div class='auiPopup indicatorDialog center'>${errorState}</div>",templateString:null,templateString:"<div id='modalDialog' class='modalDialog' dojoattachpoint='wrapper'><span dojoattachpoint='tabStartOuter' dojoonfocus='trapTabs' dojoonblur='clearTrap'tabindex='0'></span><span dojoattachpoint='tabStart' dojoonfocus='trapTabs' dojoonblur='clearTrap' tabindex='0'></span><div dojoattachpoint='containerNode' style='position: relative; z-index: 2;'></div><span dojoattachpoint='tabEnd' dojoonfocus='trapTabs' dojoonblur='clearTrap' tabindex='0'></span><span dojoattachpoint='tabEndOuter' dojoonfocus='trapTabs' dojoonblur='clearTrap' tabindex='0'></span></div>",duration:10,extractContent:!1,parseOnLoad:!0,refreshOnShow:!0,isPositionLock:!1,params:new Array,reloadIds:new Array,_portlet_id:null,_callback:null,eventList:[],_setup:function(){if(this._modalconnects=[],this.titleBar){this._moveable=new dojo.dnd.Moveable(this.domNode,{handle:this.titleBar});var o=this.domNode;dojo.connect(this._moveable,"onMoving",function(t,i){var a=dijit.getViewport(),e=parseInt(dojo.getComputedStyle(o).width),d=parseInt(a.w);i.l<0&&(i.l=0),i.l+e>d&&(i.l=d-e),i.t<0&&(i.t=0)})}this._underlay=new aimluck.widget.DialogUnderlay;var t=this.domNode;this._fadeIn=dojo.fx.combine([dojo.fadeIn({node:t,duration:this.duration}),dojo.fadeIn({node:this._underlay.domNode,duration:this.duration,onBegin:dojo.hitch(this._underlay,"show")})]),this._fadeOut=dojo.fx.combine([dojo.fadeOut({node:t,dialog:this,duration:this.duration,onEnd:function(){t.style.display="none",document.all&&this.dialog.fixTmpScroll()}}),dojo.fadeOut({node:this._underlay.domNode,duration:this.duration,onEnd:dojo.hitch(this._underlay,"hide")})])},fixTmpScroll:function(){var o=dojo.byId("weeklyScrollPane_"+this._portlet_id);o&&(dojo.byId("weeklyScrollPane_"+this._portlet_id).scrollTop="undefined"==typeof aipo.schedule.tmpScroll?ptConfig[this._portlet_id].contentScrollTop:aipo.schedule.tmpScroll)},onLoad:function(){this._position(),dijit.Dialog.superclass.onLoad.call(this),this.isPositionLock=!1;var o=window.navigator.userAgent.toLowerCase();if((o.indexOf("iphone")>-1||o.indexOf("android")>-1)&&(document.documentElement.scrollTop?document.documentElement.scrollTop=0:document.body.scrollTop&&(document.body.scrollTop=0)),aipo.userAgent.isAndroid2()){var t=dojo.byId("wrapper");dojo.style(t,"display","none");var i=dojo.byId("modalDialog");dojo.style(i,"top","0px"),dojo.style(i,"margin","0")}if(aipo.userAgent.isAndroid()){var a=this,e=function(o){return o.preventDefault(),!1},d=dojo.query("input,select,button,a",this.domNode),n=dojo.byId("appsNavigation_v2"),l=dojo.query("input,select,button,a",n),r=dojo.byId("auiWidgetsArea"),s=dojo.query("input,select,button,a",r),c=d;c=c.concat(l),c=c.concat(s),dojo.query("input,select,button,a").forEach(function(o){aipo.arrayContains(c,o)||a.eventList.push(dojo.connect(o,"click",e))}),dojo.query("input,select,button").forEach(function(o){aipo.arrayContains(c,o)||o.disabled||(dojo.addClass(o,"disabled-by-dialog"),o.disabled=!0)})}var u=dojo.byId(this.widgetId);u&&(u.focus(),null!=this._callback&&this._callback.call(this._callback,this._portlet_id)),dojo.query("#modalDialog input, #modalDialog textarea").forEach(function(o){dojo.connect(o,"onfocus",aimluck.io.onTextFieldFocus),dojo.connect(o,"onblur",aimluck.io.onTextFieldBlur)}),dojo.query("#modalDialog form").forEach(function(o){dojo.connect(o,"onsubmit",aimluck.io.onTextFieldBlur)})},setCallback:function(o,t){this._portlet_id=o,this._callback=t},setParam:function(o,t){this.params[o]=t},setReloadIds:function(o){this.reloadIds=o},clearParams:function(){this.params=new Array},clearReloadIds:function(){this.reloadIds=new Array},reload:function(o){this.href=o,this.isPositionLock=!0,this.refresh()},_position:function(){if(!dojo.hasClass(dojo.body(),"dojoMove")){var o=dijit.getViewport(),t=dojo.marginBox(this.domNode),i=this.domNode.style;"imageDialog"==this.id&&(i.marginLeft=0==i.width?"-150px":Math.floor(-i.width.replace("px","")/2)+"px"),i.top=Math.floor(o.t+(o.h-t.h)/2)>0?Math.floor(o.t+(o.h-t.h)/2)+"px":"0px"}},layout:function(){"block"==this.domNode.style.display&&this._underlay.layout()},_downloadExternalContent:function(){this._onUnloadHandler(),this._setContent(this.onDownloadStart.call(this));var o=this,t={preventCache:this.preventCache||this.refreshOnShow,url:this.href,handleAs:"text",content:this.params,headers:{X_REQUESTED_WITH:"XMLHttpRequest"}};dojo.isObject(this.ioArgs)&&dojo.mixin(t,this.ioArgs);var i=this._xhrDfd=(this.ioMethod||dojo.xhrPost)(t);i.addCallback(function(t){o.clearParams(),o.clearReloadIds();try{o.onDownloadEnd.call(o),o._isDownloaded=!0,o.setContent.call(o,t)}catch(i){o._onError.call(o,"Content",i)}return delete o._xhrDfd,t}),i.addErrback(function(t){return i.cancelled||o._onError.call(o,"Download",t),delete o._xhrDfd,t})},hide:function(){var o=document.getElementById("wrapper");if(o&&(o.style.minHeight=""),dijit.Dialog.prototype.hide.apply(this),dojo.query(".mb_dialoghide").removeClass("mb_dialoghide"),dojo.query("#modalDialog").removeClass("mb_dialog"),aipo&&aipo.timeline&&aipo.timeline.activeFileAttachments&&aipo.timeline.activeFileAttachments(this._portlet_id),aipo.userAgent.isAndroid()){for(var t=0;t<this.eventList.length;t++)dojo.disconnect(this.eventList[t]);this.eventList=[],dojo.query("input.disabled-by-dialog,select.disabled-by-dialog,button.disabled-by-dialog").forEach(function(o){dojo.removeClass(o,"disabled-by-dialog"),o.disabled=!1})}if(aipo.userAgent.isAndroid2()){var o=dojo.byId("wrapper");dojo.style(o,"display","")}}})}