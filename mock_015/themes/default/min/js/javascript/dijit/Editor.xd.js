dojo._xdResourceLoaded({depends:[["provide","dijit.Editor"],["require","dijit._editor.RichText"],["require","dijit.Toolbar"],["require","dijit._editor._Plugin"],["require","dijit._Container"],["require","dojo.i18n"],["requireLocalization","dijit._editor","commands",null,"ROOT,cs,de,es,fr,hu,it,ja,ko,pl,pt,ru,zh,zh-tw","ROOT,cs,de,es,fr,hu,it,ja,ko,pl,pt,ru,zh,zh-tw"]],defineResource:function(t){t._hasResource["dijit.Editor"]||(t._hasResource["dijit.Editor"]=!0,t.provide("dijit.Editor"),t.require("dijit._editor.RichText"),t.require("dijit.Toolbar"),t.require("dijit._editor._Plugin"),t.require("dijit._Container"),t.require("dojo.i18n"),t.declare("dijit.Editor",dijit._editor.RichText,{plugins:null,extraPlugins:null,constructor:function(){this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull"],this._plugins=[],this._editInterval=1e3*this.editActionInterval},postCreate:function(){if(this.customUndo&&(t.require("dijit._editor.range"),this._steps=this._steps.slice(0),this._undoedSteps=this._undoedSteps.slice(0)),t.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins)),dijit.Editor.superclass.postCreate.apply(this,arguments),this.commands=t.i18n.getLocalization("dijit._editor","commands",this.lang),!this.toolbar){var i=t.doc.createElement("div");t.place(i,this.editingArea,"before"),this.toolbar=new dijit.Toolbar({},i)}t.forEach(this.plugins,this.addPlugin,this),this.onNormalizedDisplayChanged()},destroy:function(){t.forEach(this._plugins,function(t){t.destroy&&t.destroy()}),this._plugins=[],this.toolbar.destroy(),delete this.toolbar,this.inherited("destroy",arguments)},addPlugin:function(i,e){var s=t.isString(i)?{name:i}:i;if(!s.setEditor){var n={args:s,plugin:null,editor:this};if(t.publish("dijit.Editor.getPlugin",[n]),!n.plugin){var o=t.getObject(s.name);o&&(n.plugin=new o(s))}if(!n.plugin)return console.debug("Cannot find plugin",i),void 0;i=n.plugin}arguments.length>1?this._plugins[e]=i:this._plugins.push(i),i.setEditor(this),t.isFunction(i.setToolbar)&&i.setToolbar(this.toolbar)},customUndo:t.isIE,editActionInterval:3,beginEditing:function(i){this._inEditing||(this._inEditing=!0,this._beginEditing(i)),this.editActionInterval>0&&(this._editTimer&&clearTimeout(this._editTimer),this._editTimer=setTimeout(t.hitch(this,this.endEditing),this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(i){if(this.customUndo&&("undo"==i||"redo"==i))return this[i]();try{this.customUndo&&(this.endEditing(),this._beginEditing());var e=this.inherited("execCommand",arguments);return this.customUndo&&this._endEditing(),e}catch(s){if(t.isMoz&&/copy|cut|paste/.test(i)){var n=t.string.substitute,o={cut:"X",copy:"C",paste:"V"},r=-1!=navigator.userAgent.indexOf("Macintosh");alert(n(this.commands.systemShortcutFF,[this.commands[i],n(this.commands[r?"appleKey":"ctrlKey"],[o[i]])]))}return!1}},queryCommandEnabled:function(t){return!this.customUndo||"undo"!=t&&"redo"!=t?this.inherited("queryCommandEnabled",arguments):"undo"==t?this._steps.length>1:this._undoedSteps.length>0},_changeToStep:function(i,e){this.setValue(e.text);var s=e.bookmark;if(s){if(t.isIE){if(t.isArray(s)){var n=[];t.forEach(s,function(t){n.push(dijit.range.getNode(t,this.editNode))},this),s=n}}else{var o=dijit.range.create();o.setStart(dijit.range.getNode(s.startContainer,this.editNode),s.startOffset),o.setEnd(dijit.range.getNode(s.endContainer,this.editNode),s.endOffset),s=o}t.withGlobal(this.window,"moveToBookmark",dijit,[s])}},undo:function(){this.endEditing(!0);var t=this._steps.pop();return this._steps.length>0?(this.focus(),this._changeToStep(t,this._steps[this._steps.length-1]),this._undoedSteps.push(t),this.onDisplayChanged(),!0):!1},redo:function(){this.endEditing(!0);var t=this._undoedSteps.pop();return t&&this._steps.length>0?(this.focus(),this._changeToStep(this._steps[this._steps.length-1],t),this._steps.push(t),this.onDisplayChanged(),!0):!1},endEditing:function(t){this._editTimer&&clearTimeout(this._editTimer),this._inEditing&&(this._endEditing(t),this._inEditing=!1)},_getBookmark:function(){var i=t.withGlobal(this.window,dijit.getBookmark);if(t.isIE){if(t.isArray(i)){var e=[];t.forEach(i,function(t){e.push(dijit.range.getIndex(t,this.editNode).o)},this),i=e}}else{var e=dijit.range.getIndex(i.startContainer,this.editNode).o;i={startContainer:e,startOffset:i.startOffset,endContainer:i.endContainer===i.startContainer?e:dijit.range.getIndex(i.endContainer,this.editNode).o,endOffset:i.endOffset}}return i},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:this.savedContent,bookmark:this._getBookmark()})},_endEditing:function(){var t=this.getValue(!0);this._undoedSteps=[],this._steps.push({text:t,bookmark:this._getBookmark()})},onKeyDown:function(i){if(!this.customUndo)return this.inherited("onKeyDown",arguments),void 0;var e=i.keyCode,s=t.keys;if(i.ctrlKey){if(90===e||122===e)return t.stopEvent(i),this.undo(),void 0;if(89===e||121===e)return t.stopEvent(i),this.redo(),void 0}switch(this.inherited("onKeyDown",arguments),e){case s.ENTER:this.beginEditing();break;case s.BACKSPACE:case s.DELETE:this.beginEditing();break;case 88:case 86:if(i.ctrlKey&&!i.altKey&&!i.metaKey){this.endEditing(),88==i.keyCode?(this.beginEditing("cut"),setTimeout(t.hitch(this,this.endEditing),1)):(this.beginEditing("paste"),setTimeout(t.hitch(this,this.endEditing),1));break}default:if(!i.ctrlKey&&!i.altKey&&!i.metaKey&&(i.keyCode<t.keys.F1||i.keyCode>t.keys.F15)){this.beginEditing();break}case s.ALT:this.endEditing();break;case s.UP_ARROW:case s.DOWN_ARROW:case s.LEFT_ARROW:case s.RIGHT_ARROW:case s.HOME:case s.END:case s.PAGE_UP:case s.PAGE_DOWN:this.endEditing(!0);break;case s.CTRL:case s.SHIFT:case s.TAB:}},_onBlur:function(){this.inherited("_onBlur",arguments),this.endEditing(!0)},onClick:function(){this.endEditing(!0),this.inherited("onClick",arguments)}}),t.subscribe("dijit.Editor.getPlugin",null,function(t){if(!t.plugin){var i,e=t.args,s=dijit._editor._Plugin,n=e.name;switch(n){case"undo":case"redo":case"cut":case"copy":case"paste":case"insertOrderedList":case"insertUnorderedList":case"indent":case"outdent":case"justifyCenter":case"justifyFull":case"justifyLeft":case"justifyRight":case"delete":case"selectAll":case"removeFormat":i=new s({command:n});break;case"bold":case"italic":case"underline":case"strikethrough":case"subscript":case"superscript":i=new s({buttonClass:dijit.form.ToggleButton,command:n});break;case"|":i=new s({button:new dijit.ToolbarSeparator});break;case"createLink":i=new dijit._editor.plugins.LinkDialog({command:n});break;case"foreColor":case"hiliteColor":i=new dijit._editor.plugins.TextColor({command:n});break;case"fontName":case"fontSize":case"formatBlock":i=new dijit._editor.plugins.FontChoice({command:n})}t.plugin=i}}))}});